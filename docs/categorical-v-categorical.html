<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Applied Statistics</title>
  <meta name="description" content="Course notes for Applied Statistics courses at CSU Chico">
  <meta name="generator" content="bookdown 0.5.4 and GitBook 2.6.7">

  <meta property="og:title" content="Applied Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for Applied Statistics courses at CSU Chico" />
  <meta name="github-repo" content="norcalbiostat/AppliedStatistics_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Applied Statistics" />
  
  <meta name="twitter:description" content="Course notes for Applied Statistics courses at CSU Chico" />
  

<meta name="author" content="Robin A. Donatello and Edward A. Roualdes">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="normal-qq-plots.html">
<link rel="next" href="continuous-v-continuous.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Statistics course notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>1</b> Preparing Data for Analysis</a><ul>
<li class="chapter" data-level="1.0.1" data-path="data-prep.html"><a href="data-prep.html#reproducible-workflows"><i class="fa fa-check"></i><b>1.0.1</b> Reproducible Workflows</a></li>
<li class="chapter" data-level="1.0.2" data-path="data-prep.html"><a href="data-prep.html#data-management"><i class="fa fa-check"></i><b>1.0.2</b> Data Management</a></li>
<li class="chapter" data-level="1.1" data-path="import-data.html"><a href="import-data.html"><i class="fa fa-check"></i><b>1.1</b> Import data</a><ul>
<li class="chapter" data-level="1.1.1" data-path="import-data.html"><a href="import-data.html#renaming-varible-names-for-sanity-sake"><i class="fa fa-check"></i><b>1.1.1</b> Renaming varible names for sanity sake</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>1.2</b> Missing data</a></li>
<li class="chapter" data-level="1.3" data-path="identifying-variable-types.html"><a href="identifying-variable-types.html"><i class="fa fa-check"></i><b>1.3</b> Identifying Variable Types</a></li>
<li class="chapter" data-level="1.4" data-path="outliers.html"><a href="outliers.html"><i class="fa fa-check"></i><b>1.4</b> Outliers</a></li>
<li class="chapter" data-level="1.5" data-path="creating-secondary-variables.html"><a href="creating-secondary-variables.html"><i class="fa fa-check"></i><b>1.5</b> Creating secondary variables</a><ul>
<li class="chapter" data-level="1.5.1" data-path="creating-secondary-variables.html"><a href="creating-secondary-variables.html#collapsing-variables-into-fewer-categories"><i class="fa fa-check"></i><b>1.5.1</b> Collapsing variables into fewer categories</a></li>
<li class="chapter" data-level="1.5.2" data-path="creating-secondary-variables.html"><a href="creating-secondary-variables.html#binning-a-continuous-variable-into-categorical-ranges."><i class="fa fa-check"></i><b>1.5.2</b> Binning a continuous variable into categorical ranges.</a></li>
<li class="chapter" data-level="1.5.3" data-path="creating-secondary-variables.html"><a href="creating-secondary-variables.html#dichotomizing"><i class="fa fa-check"></i><b>1.5.3</b> Dichotomizing</a></li>
<li class="chapter" data-level="1.5.4" data-path="creating-secondary-variables.html"><a href="creating-secondary-variables.html#sum-or-average-values-across-multiple-variables"><i class="fa fa-check"></i><b>1.5.4</b> Sum or Average values across multiple variables</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="transformations-for-normality.html"><a href="transformations-for-normality.html"><i class="fa fa-check"></i><b>1.6</b> Transformations for Normality</a></li>
<li class="chapter" data-level="1.7" data-path="saving-your-changes.html"><a href="saving-your-changes.html"><i class="fa fa-check"></i><b>1.7</b> Saving your changes</a></li>
<li class="chapter" data-level="1.8" data-path="wide-vs-long-data.html"><a href="wide-vs-long-data.html"><i class="fa fa-check"></i><b>1.8</b> Wide vs. Long data</a></li>
<li class="chapter" data-level="1.9" data-path="dealing-with-missing-data-post-analysis.html"><a href="dealing-with-missing-data-post-analysis.html"><i class="fa fa-check"></i><b>1.9</b> Dealing with missing data post-analysis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-viz.html"><a href="data-viz.html"><i class="fa fa-check"></i><b>2</b> Visualizing Data</a><ul>
<li class="chapter" data-level="2.1" data-path="the-syntax-of-ggplot.html"><a href="the-syntax-of-ggplot.html"><i class="fa fa-check"></i><b>2.1</b> The syntax of <code>ggplot</code></a><ul>
<li class="chapter" data-level="2.1.1" data-path="the-syntax-of-ggplot.html"><a href="the-syntax-of-ggplot.html#required-arguments"><i class="fa fa-check"></i><b>2.1.1</b> Required arguments</a></li>
<li class="chapter" data-level="2.1.2" data-path="the-syntax-of-ggplot.html"><a href="the-syntax-of-ggplot.html#optional-but-helpful-arguments"><i class="fa fa-check"></i><b>2.1.2</b> Optional but helpful arguments</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="the-data.html"><a href="the-data.html"><i class="fa fa-check"></i><b>2.2</b> The Data</a></li>
<li class="chapter" data-level="2.3" data-path="univariate-categorical-variables.html"><a href="univariate-categorical-variables.html"><i class="fa fa-check"></i><b>2.3</b> Univariate Categorical variables</a><ul>
<li class="chapter" data-level="2.3.1" data-path="univariate-categorical-variables.html"><a href="univariate-categorical-variables.html#tables"><i class="fa fa-check"></i><b>2.3.1</b> Tables</a></li>
<li class="chapter" data-level="2.3.2" data-path="univariate-categorical-variables.html"><a href="univariate-categorical-variables.html#barcharts-barplots"><i class="fa fa-check"></i><b>2.3.2</b> Barcharts / Barplots</a></li>
<li class="chapter" data-level="2.3.3" data-path="univariate-categorical-variables.html"><a href="univariate-categorical-variables.html#cleveland-dot-plots"><i class="fa fa-check"></i><b>2.3.3</b> Cleveland Dot Plots</a></li>
<li class="chapter" data-level="2.3.4" data-path="univariate-categorical-variables.html"><a href="univariate-categorical-variables.html#pie-chart"><i class="fa fa-check"></i><b>2.3.4</b> Pie Chart</a></li>
<li class="chapter" data-level="2.3.5" data-path="univariate-categorical-variables.html"><a href="univariate-categorical-variables.html#waffle-chart"><i class="fa fa-check"></i><b>2.3.5</b> Waffle Chart</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="univariate-continuous-variable.html"><a href="univariate-continuous-variable.html"><i class="fa fa-check"></i><b>2.4</b> Univariate Continuous variable</a><ul>
<li class="chapter" data-level="2.4.1" data-path="univariate-continuous-variable.html"><a href="univariate-continuous-variable.html#dotplot"><i class="fa fa-check"></i><b>2.4.1</b> Dotplot</a></li>
<li class="chapter" data-level="2.4.2" data-path="univariate-continuous-variable.html"><a href="univariate-continuous-variable.html#histograms"><i class="fa fa-check"></i><b>2.4.2</b> Histograms</a></li>
<li class="chapter" data-level="2.4.3" data-path="univariate-continuous-variable.html"><a href="univariate-continuous-variable.html#density-plots"><i class="fa fa-check"></i><b>2.4.3</b> Density plots</a></li>
<li class="chapter" data-level="2.4.4" data-path="univariate-continuous-variable.html"><a href="univariate-continuous-variable.html#histograms-density"><i class="fa fa-check"></i><b>2.4.4</b> Histograms + density</a></li>
<li class="chapter" data-level="2.4.5" data-path="univariate-continuous-variable.html"><a href="univariate-continuous-variable.html#boxplots"><i class="fa fa-check"></i><b>2.4.5</b> Boxplots</a></li>
<li class="chapter" data-level="2.4.6" data-path="univariate-continuous-variable.html"><a href="univariate-continuous-variable.html#violin-plots"><i class="fa fa-check"></i><b>2.4.6</b> Violin plots</a></li>
<li class="chapter" data-level="2.4.7" data-path="univariate-continuous-variable.html"><a href="univariate-continuous-variable.html#boxplot-violin-plots"><i class="fa fa-check"></i><b>2.4.7</b> Boxplot + Violin plots</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="normal-qq-plots.html"><a href="normal-qq-plots.html"><i class="fa fa-check"></i><b>2.5</b> Normal QQ plots</a></li>
<li class="chapter" data-level="2.6" data-path="categorical-v-categorical.html"><a href="categorical-v-categorical.html"><i class="fa fa-check"></i><b>2.6</b> Categorical v. Categorical</a><ul>
<li class="chapter" data-level="2.6.1" data-path="categorical-v-categorical.html"><a href="categorical-v-categorical.html#two-way-tables"><i class="fa fa-check"></i><b>2.6.1</b> Two-way Tables</a></li>
<li class="chapter" data-level="2.6.2" data-path="categorical-v-categorical.html"><a href="categorical-v-categorical.html#grouped-bar-charts"><i class="fa fa-check"></i><b>2.6.2</b> Grouped bar charts</a></li>
<li class="chapter" data-level="2.6.3" data-path="categorical-v-categorical.html"><a href="categorical-v-categorical.html#grouped-bar-charts-with-percentages"><i class="fa fa-check"></i><b>2.6.3</b> Grouped bar charts with percentages</a></li>
<li class="chapter" data-level="2.6.4" data-path="categorical-v-categorical.html"><a href="categorical-v-categorical.html#mosaic-plots"><i class="fa fa-check"></i><b>2.6.4</b> Mosaic plots</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="continuous-v-continuous.html"><a href="continuous-v-continuous.html"><i class="fa fa-check"></i><b>2.7</b> Continuous v. Continuous</a><ul>
<li class="chapter" data-level="2.7.1" data-path="continuous-v-continuous.html"><a href="continuous-v-continuous.html#scatterplot"><i class="fa fa-check"></i><b>2.7.1</b> Scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="scatterplot-matrix.html"><a href="scatterplot-matrix.html"><i class="fa fa-check"></i><b>2.8</b> Scatterplot matrix</a><ul>
<li class="chapter" data-level="2.8.1" data-path="scatterplot-matrix.html"><a href="scatterplot-matrix.html#adding-lines-to-the-scatterplots"><i class="fa fa-check"></i><b>2.8.1</b> Adding lines to the scatterplots</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="line-plots.html"><a href="line-plots.html"><i class="fa fa-check"></i><b>2.9</b> Line plots</a><ul>
<li class="chapter" data-level="2.9.1" data-path="line-plots.html"><a href="line-plots.html#base-9"><i class="fa fa-check"></i><b>2.9.1</b> base</a></li>
<li class="chapter" data-level="2.9.2" data-path="line-plots.html"><a href="line-plots.html#ggplot-9"><i class="fa fa-check"></i><b>2.9.2</b> ggplot</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="continuous-v-categorical.html"><a href="continuous-v-categorical.html"><i class="fa fa-check"></i><b>2.10</b> Continuous v. Categorical</a><ul>
<li class="chapter" data-level="2.10.1" data-path="continuous-v-categorical.html"><a href="continuous-v-categorical.html#dotplotstrip-chart"><i class="fa fa-check"></i><b>2.10.1</b> Dotplot/strip chart</a></li>
<li class="chapter" data-level="2.10.2" data-path="continuous-v-categorical.html"><a href="continuous-v-categorical.html#grouped-boxplots"><i class="fa fa-check"></i><b>2.10.2</b> Grouped boxplots</a></li>
<li class="chapter" data-level="2.10.3" data-path="continuous-v-categorical.html"><a href="continuous-v-categorical.html#grouped-histograms"><i class="fa fa-check"></i><b>2.10.3</b> Grouped histograms</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="joy-plots-in-progress.html"><a href="joy-plots-in-progress.html"><i class="fa fa-check"></i><b>2.11</b> Joy plots (in progress)</a></li>
<li class="chapter" data-level="2.12" data-path="faceting-paneling.html"><a href="faceting-paneling.html"><i class="fa fa-check"></i><b>2.12</b> Faceting / paneling</a></li>
<li class="chapter" data-level="2.13" data-path="other-ways-to-get-multiple-plots-per-window.html"><a href="other-ways-to-get-multiple-plots-per-window.html"><i class="fa fa-check"></i><b>2.13</b> Other ways to get multiple plots per window</a><ul>
<li class="chapter" data-level="2.13.1" data-path="other-ways-to-get-multiple-plots-per-window.html"><a href="other-ways-to-get-multiple-plots-per-window.html#base-14"><i class="fa fa-check"></i><b>2.13.1</b> base</a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="multivariate-2-variables.html"><a href="multivariate-2-variables.html"><i class="fa fa-check"></i><b>2.14</b> Multivariate (2+ variables)</a></li>
<li class="chapter" data-level="2.15" data-path="three-continuous.html"><a href="three-continuous.html"><i class="fa fa-check"></i><b>2.15</b> Three continuous</a></li>
<li class="chapter" data-level="2.16" data-path="two-categorical-and-one-continuous.html"><a href="two-categorical-and-one-continuous.html"><i class="fa fa-check"></i><b>2.16</b> Two categorical and one continuous</a></li>
<li class="chapter" data-level="2.17" data-path="two-continuous-and-one-categorical.html"><a href="two-continuous-and-one-categorical.html"><i class="fa fa-check"></i><b>2.17</b> Two continuous and one categorical</a></li>
<li class="chapter" data-level="2.18" data-path="paneling-on-two-variables.html"><a href="paneling-on-two-variables.html"><i class="fa fa-check"></i><b>2.18</b> Paneling on two variables</a></li>
<li class="chapter" data-level="2.19" data-path="troubleshooting.html"><a href="troubleshooting.html"><i class="fa fa-check"></i><b>2.19</b> Troubleshooting</a></li>
<li class="chapter" data-level="2.20" data-path="but-what-about.html"><a href="but-what-about.html"><i class="fa fa-check"></i><b>2.20</b> But what about…</a><ul>
<li class="chapter" data-level="2.20.1" data-path="but-what-about.html"><a href="but-what-about.html#other-plots-not-mentioned"><i class="fa fa-check"></i><b>2.20.1</b> Other plots not mentioned</a></li>
</ul></li>
<li class="chapter" data-level="2.21" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>2.21</b> Additional Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="select-analysis.html"><a href="select-analysis.html"><i class="fa fa-check"></i><b>3</b> Selecting Appropriate Analyses</a></li>
<li class="part"><span><b>I Regression Modeling</b></span></li>
<li class="chapter" data-level="4" data-path="reg-intro.html"><a href="reg-intro.html"><i class="fa fa-check"></i><b>4</b> Introduction</a></li>
<li class="chapter" data-level="5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>5</b> Simple Linear Regression</a><ul>
<li class="chapter" data-level="5.1" data-path="mathmatical-model.html"><a href="mathmatical-model.html"><i class="fa fa-check"></i><b>5.1</b> Mathmatical Model</a></li>
<li class="chapter" data-level="5.2" data-path="parameter-estimates.html"><a href="parameter-estimates.html"><i class="fa fa-check"></i><b>5.2</b> Parameter Estimates</a></li>
<li class="chapter" data-level="5.3" data-path="interval-estimation.html"><a href="interval-estimation.html"><i class="fa fa-check"></i><b>5.3</b> Interval estimation</a></li>
<li class="chapter" data-level="5.4" data-path="corelation-coefficient.html"><a href="corelation-coefficient.html"><i class="fa fa-check"></i><b>5.4</b> Corelation Coefficient</a></li>
<li class="chapter" data-level="5.5" data-path="assumptions.html"><a href="assumptions.html"><i class="fa fa-check"></i><b>5.5</b> Assumptions</a></li>
<li class="chapter" data-level="5.6" data-path="example.html"><a href="example.html"><i class="fa fa-check"></i><b>5.6</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>6</b> Multiple Linear Regression</a><ul>
<li class="chapter" data-level="6.1" data-path="types-of-x-variables.html"><a href="types-of-x-variables.html"><i class="fa fa-check"></i><b>6.1</b> Types of X variables</a></li>
<li class="chapter" data-level="6.2" data-path="mathematical-model.html"><a href="mathematical-model.html"><i class="fa fa-check"></i><b>6.2</b> Mathematical Model</a></li>
<li class="chapter" data-level="6.3" data-path="parameter-estimation.html"><a href="parameter-estimation.html"><i class="fa fa-check"></i><b>6.3</b> Parameter Estimation</a></li>
<li class="chapter" data-level="6.4" data-path="example-1.html"><a href="example-1.html"><i class="fa fa-check"></i><b>6.4</b> Example</a></li>
<li class="chapter" data-level="6.5" data-path="model-diagnostics.html"><a href="model-diagnostics.html"><i class="fa fa-check"></i><b>6.5</b> Model Diagnostics</a></li>
<li class="chapter" data-level="6.6" data-path="multicollinearity.html"><a href="multicollinearity.html"><i class="fa fa-check"></i><b>6.6</b> Multicollinearity</a></li>
<li class="chapter" data-level="6.7" data-path="what-to-watch-out-for.html"><a href="what-to-watch-out-for.html"><i class="fa fa-check"></i><b>6.7</b> What to watch out for</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="model-building.html"><a href="model-building.html"><i class="fa fa-check"></i><b>7</b> Model Building</a><ul>
<li class="chapter" data-level="7.1" data-path="categorical-predictors.html"><a href="categorical-predictors.html"><i class="fa fa-check"></i><b>7.1</b> Categorical Predictors</a><ul>
<li class="chapter" data-level="7.1.1" data-path="categorical-predictors.html"><a href="categorical-predictors.html#factor-variable-coding"><i class="fa fa-check"></i><b>7.1.1</b> Factor variable coding</a></li>
<li class="chapter" data-level="7.1.2" data-path="categorical-predictors.html"><a href="categorical-predictors.html#wald-test"><i class="fa fa-check"></i><b>7.1.2</b> Wald test</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="stratification.html"><a href="stratification.html"><i class="fa fa-check"></i><b>7.2</b> Stratification</a></li>
<li class="chapter" data-level="7.3" data-path="moderation.html"><a href="moderation.html"><i class="fa fa-check"></i><b>7.3</b> Moderation</a><ul>
<li class="chapter" data-level="7.3.1" data-path="moderation.html"><a href="moderation.html#example-1-sepal-vs-petal-length"><i class="fa fa-check"></i><b>7.3.1</b> Example 1: Sepal vs Petal Length</a></li>
<li class="chapter" data-level="7.3.2" data-path="moderation.html"><a href="moderation.html#example-2-simpsons-paradox"><i class="fa fa-check"></i><b>7.3.2</b> Example 2: Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>7.4</b> Interactions</a><ul>
<li class="chapter" data-level="7.4.1" data-path="interactions.html"><a href="interactions.html#example-2"><i class="fa fa-check"></i><b>7.4.1</b> Example</a></li>
<li class="chapter" data-level="7.4.2" data-path="interactions.html"><a href="interactions.html#example-3"><i class="fa fa-check"></i><b>7.4.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="confounding.html"><a href="confounding.html"><i class="fa fa-check"></i><b>7.5</b> Confounding</a></li>
<li class="chapter" data-level="7.6" data-path="variable-selection-process.html"><a href="variable-selection-process.html"><i class="fa fa-check"></i><b>7.6</b> Variable Selection Process</a><ul>
<li class="chapter" data-level="7.6.1" data-path="variable-selection-process.html"><a href="variable-selection-process.html#automated-selection-procedures"><i class="fa fa-check"></i><b>7.6.1</b> Automated selection procedures</a></li>
<li class="chapter" data-level="7.6.2" data-path="variable-selection-process.html"><a href="variable-selection-process.html#the-lesser-of-three-evils-best-subsets-pma5-section-8.7"><i class="fa fa-check"></i><b>7.6.2</b> The lesser of three evils: Best Subsets (PMA5 Section 8.7)</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="comparing-between-models.html"><a href="comparing-between-models.html"><i class="fa fa-check"></i><b>7.7</b> Comparing between models</a></li>
<li class="chapter" data-level="7.8" data-path="what-to-watch-out-for-1.html"><a href="what-to-watch-out-for-1.html"><i class="fa fa-check"></i><b>7.8</b> What to watch out for</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>8</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="8.1" data-path="fitting-glms-in-r.html"><a href="fitting-glms-in-r.html"><i class="fa fa-check"></i><b>8.1</b> Fitting GLMs in R</a></li>
<li class="chapter" data-level="8.2" data-path="binary-data.html"><a href="binary-data.html"><i class="fa fa-check"></i><b>8.2</b> Binary Data</a><ul>
<li class="chapter" data-level="8.2.1" data-path="binary-data.html"><a href="binary-data.html#example-the-effect-of-gender-on-depression"><i class="fa fa-check"></i><b>8.2.1</b> Example: The effect of gender on Depression</a></li>
<li class="chapter" data-level="8.2.2" data-path="binary-data.html"><a href="binary-data.html#multiple-logistic-regression"><i class="fa fa-check"></i><b>8.2.2</b> Multiple Logistic Regression</a></li>
<li class="chapter" data-level="8.2.3" data-path="binary-data.html"><a href="binary-data.html#interpretation"><i class="fa fa-check"></i><b>8.2.3</b> Interpretation</a></li>
<li class="chapter" data-level="8.2.4" data-path="binary-data.html"><a href="binary-data.html#goodness-of-fit"><i class="fa fa-check"></i><b>8.2.4</b> Goodness of Fit</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="classification-of-binary-outcomes.html"><a href="classification-of-binary-outcomes.html"><i class="fa fa-check"></i><b>8.3</b> Classification of Binary outcomes</a><ul>
<li class="chapter" data-level="8.3.1" data-path="classification-of-binary-outcomes.html"><a href="classification-of-binary-outcomes.html#calculating-predictions"><i class="fa fa-check"></i><b>8.3.1</b> Calculating predictions</a></li>
<li class="chapter" data-level="8.3.2" data-path="classification-of-binary-outcomes.html"><a href="classification-of-binary-outcomes.html#roc-curves"><i class="fa fa-check"></i><b>8.3.2</b> ROC Curves</a></li>
<li class="chapter" data-level="8.3.3" data-path="classification-of-binary-outcomes.html"><a href="classification-of-binary-outcomes.html#model-performance"><i class="fa fa-check"></i><b>8.3.3</b> Model Performance</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="categorical-data.html"><a href="categorical-data.html"><i class="fa fa-check"></i><b>8.4</b> Categorical Data</a></li>
<li class="chapter" data-level="8.5" data-path="count-data.html"><a href="count-data.html"><i class="fa fa-check"></i><b>8.5</b> Count Data</a></li>
</ul></li>
<li class="part"><span><b>II Multivariate Analysis</b></span></li>
<li class="chapter" data-level="9" data-path="mv-intro.html"><a href="mv-intro.html"><i class="fa fa-check"></i><b>9</b> Introduction</a></li>
<li class="chapter" data-level="10" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>10</b> Principal Component Analysis</a><ul>
<li class="chapter" data-level="10.1" data-path="basic-idea.html"><a href="basic-idea.html"><i class="fa fa-check"></i><b>10.1</b> Basic Idea</a></li>
<li class="chapter" data-level="10.2" data-path="more-generally.html"><a href="more-generally.html"><i class="fa fa-check"></i><b>10.2</b> More Generally</a></li>
<li class="chapter" data-level="10.3" data-path="generating-pcs-using-r.html"><a href="generating-pcs-using-r.html"><i class="fa fa-check"></i><b>10.3</b> Generating PC’s using R</a></li>
<li class="chapter" data-level="10.4" data-path="using-the-correlation-matrix.html"><a href="using-the-correlation-matrix.html"><i class="fa fa-check"></i><b>10.4</b> Using the correlation matrix</a></li>
<li class="chapter" data-level="10.5" data-path="data-reduction.html"><a href="data-reduction.html"><i class="fa fa-check"></i><b>10.5</b> Data Reduction</a></li>
<li class="chapter" data-level="10.6" data-path="example-analysis-of-depression.html"><a href="example-analysis-of-depression.html"><i class="fa fa-check"></i><b>10.6</b> Example Analysis of depression</a></li>
<li class="chapter" data-level="10.7" data-path="use-in-multiple-regression.html"><a href="use-in-multiple-regression.html"><i class="fa fa-check"></i><b>10.7</b> Use in Multiple Regression</a></li>
<li class="chapter" data-level="10.8" data-path="things-to-watch-out-for.html"><a href="things-to-watch-out-for.html"><i class="fa fa-check"></i><b>10.8</b> Things to watch out for</a></li>
<li class="chapter" data-level="10.9" data-path="additional-references.html"><a href="additional-references.html"><i class="fa fa-check"></i><b>10.9</b> Additional References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="fa.html"><a href="fa.html"><i class="fa fa-check"></i><b>11</b> Factor Analysis</a><ul>
<li class="chapter" data-level="11.1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>11.1</b> Introduction</a><ul>
<li class="chapter" data-level="11.1.1" data-path="introduction.html"><a href="introduction.html#latent-constructs"><i class="fa fa-check"></i><b>11.1.1</b> Latent Constructs</a></li>
<li class="chapter" data-level="11.1.2" data-path="introduction.html"><a href="introduction.html#efa-vs-cfa"><i class="fa fa-check"></i><b>11.1.2</b> EFA vs CFA</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="factor-model.html"><a href="factor-model.html"><i class="fa fa-check"></i><b>11.2</b> Factor Model</a><ul>
<li class="chapter" data-level="11.2.1" data-path="factor-model.html"><a href="factor-model.html#comparison-with-pca"><i class="fa fa-check"></i><b>11.2.1</b> Comparison with PCA</a></li>
<li class="chapter" data-level="11.2.2" data-path="factor-model.html"><a href="factor-model.html#implications"><i class="fa fa-check"></i><b>11.2.2</b> Implications</a></li>
<li class="chapter" data-level="11.2.3" data-path="factor-model.html"><a href="factor-model.html#two-big-steps"><i class="fa fa-check"></i><b>11.2.3</b> Two big steps</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="fa-example.html"><a href="fa-example.html"><i class="fa fa-check"></i><b>11.3</b> Example setup</a></li>
<li class="chapter" data-level="11.4" data-path="fa-extract.html"><a href="fa-extract.html"><i class="fa fa-check"></i><b>11.4</b> Factor Extraction</a><ul>
<li class="chapter" data-level="11.4.1" data-path="fa-extract.html"><a href="fa-extract.html#pc-factor-model"><i class="fa fa-check"></i><b>11.4.1</b> PC Factor Model</a></li>
<li class="chapter" data-level="11.4.2" data-path="fa-extract.html"><a href="fa-extract.html#iterated-pc-factor-model"><i class="fa fa-check"></i><b>11.4.2</b> Iterated PC Factor Model</a></li>
<li class="chapter" data-level="11.4.3" data-path="fa-extract.html"><a href="fa-extract.html#maximum-likelihood"><i class="fa fa-check"></i><b>11.4.3</b> Maximum Likelihood</a></li>
<li class="chapter" data-level="11.4.4" data-path="fa-extract.html"><a href="fa-extract.html#example-4"><i class="fa fa-check"></i><b>11.4.4</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="rotating-factors.html"><a href="rotating-factors.html"><i class="fa fa-check"></i><b>11.5</b> Rotating Factors</a><ul>
<li class="chapter" data-level="11.5.1" data-path="rotating-factors.html"><a href="rotating-factors.html#varimax-rotation"><i class="fa fa-check"></i><b>11.5.1</b> Varimax Rotation</a></li>
<li class="chapter" data-level="11.5.2" data-path="rotating-factors.html"><a href="rotating-factors.html#oblique-rotation"><i class="fa fa-check"></i><b>11.5.2</b> Oblique rotation</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="factor-scores.html"><a href="factor-scores.html"><i class="fa fa-check"></i><b>11.6</b> Factor Scores</a></li>
<li class="chapter" data-level="11.7" data-path="what-to-watch-out-for-2.html"><a href="what-to-watch-out-for-2.html"><i class="fa fa-check"></i><b>11.7</b> What to watch out for</a></li>
<li class="chapter" data-level="11.8" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>11.8</b> Additional Resources</a></li>
</ul></li>
<li class="part"><span><b>III Other Topics</b></span></li>
<li class="chapter" data-level="12" data-path="mda.html"><a href="mda.html"><i class="fa fa-check"></i><b>12</b> Missing Data</a><ul>
<li class="chapter" data-level="12.1" data-path="identifying-missing-data.html"><a href="identifying-missing-data.html"><i class="fa fa-check"></i><b>12.1</b> Identifying missing data</a><ul>
<li class="chapter" data-level="12.1.1" data-path="identifying-missing-data.html"><a href="identifying-missing-data.html#visualize-missing-patterns"><i class="fa fa-check"></i><b>12.1.1</b> Visualize missing patterns</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="effects-of-nonresponse.html"><a href="effects-of-nonresponse.html"><i class="fa fa-check"></i><b>12.2</b> Effects of Nonresponse</a></li>
<li class="chapter" data-level="12.3" data-path="missing-data-mechanisms.html"><a href="missing-data-mechanisms.html"><i class="fa fa-check"></i><b>12.3</b> Missing Data Mechanisms</a><ul>
<li class="chapter" data-level="12.3.1" data-path="missing-data-mechanisms.html"><a href="missing-data-mechanisms.html#demonstration-via-simulation"><i class="fa fa-check"></i><b>12.3.1</b> Demonstration via Simulation</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="general-strategies.html"><a href="general-strategies.html"><i class="fa fa-check"></i><b>12.4</b> General strategies</a><ul>
<li class="chapter" data-level="12.4.1" data-path="general-strategies.html"><a href="general-strategies.html#complete-cases-analysis"><i class="fa fa-check"></i><b>12.4.1</b> Complete cases analysis</a></li>
<li class="chapter" data-level="12.4.2" data-path="general-strategies.html"><a href="general-strategies.html#available-case-analysis"><i class="fa fa-check"></i><b>12.4.2</b> Available-case analysis</a></li>
<li class="chapter" data-level="12.4.3" data-path="general-strategies.html"><a href="general-strategies.html#imputation"><i class="fa fa-check"></i><b>12.4.3</b> Imputation</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="imputation-methods.html"><a href="imputation-methods.html"><i class="fa fa-check"></i><b>12.5</b> Imputation Methods</a></li>
<li class="chapter" data-level="12.6" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html"><i class="fa fa-check"></i><b>12.6</b> Multiple Imputation (MI)</a><ul>
<li class="chapter" data-level="12.6.1" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#goals"><i class="fa fa-check"></i><b>12.6.1</b> Goals</a></li>
<li class="chapter" data-level="12.6.2" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#technique"><i class="fa fa-check"></i><b>12.6.2</b> Technique</a></li>
<li class="chapter" data-level="12.6.3" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#mi-as-a-paradigm"><i class="fa fa-check"></i><b>12.6.3</b> MI as a paradigm</a></li>
<li class="chapter" data-level="12.6.4" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#inference-on-mi"><i class="fa fa-check"></i><b>12.6.4</b> Inference on MI</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html"><i class="fa fa-check"></i><b>12.7</b> Multiple Imputation using Chained Equations (MICE)</a><ul>
<li class="chapter" data-level="12.7.1" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#overview"><i class="fa fa-check"></i><b>12.7.1</b> Overview</a></li>
<li class="chapter" data-level="12.7.2" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#process-algorithm"><i class="fa fa-check"></i><b>12.7.2</b> Process / Algorithm</a></li>
<li class="chapter" data-level="12.7.3" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#convergence"><i class="fa fa-check"></i><b>12.7.3</b> Convergence</a></li>
<li class="chapter" data-level="12.7.4" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#imputation-methods-1"><i class="fa fa-check"></i><b>12.7.4</b> Imputation Methods</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="example-prescribed-amount-of-missing-.html"><a href="example-prescribed-amount-of-missing-.html"><i class="fa fa-check"></i><b>12.8</b> Example: Prescribed amount of missing.</a><ul>
<li class="chapter" data-level="12.8.1" data-path="example-prescribed-amount-of-missing-.html"><a href="example-prescribed-amount-of-missing-.html#multiply-impute-the-missing-data-using-mice"><i class="fa fa-check"></i><b>12.8.1</b> Multiply impute the missing data using <code>mice()</code></a></li>
<li class="chapter" data-level="12.8.2" data-path="example-prescribed-amount-of-missing-.html"><a href="example-prescribed-amount-of-missing-.html#check-the-imputation-method-used-on-each-variable."><i class="fa fa-check"></i><b>12.8.2</b> Check the imputation method used on each variable.</a></li>
<li class="chapter" data-level="12.8.3" data-path="example-prescribed-amount-of-missing-.html"><a href="example-prescribed-amount-of-missing-.html#check-convergence"><i class="fa fa-check"></i><b>12.8.3</b> Check Convergence</a></li>
<li class="chapter" data-level="12.8.4" data-path="example-prescribed-amount-of-missing-.html"><a href="example-prescribed-amount-of-missing-.html#look-at-the-values-generated-for-imputation"><i class="fa fa-check"></i><b>12.8.4</b> Look at the values generated for imputation</a></li>
<li class="chapter" data-level="12.8.5" data-path="example-prescribed-amount-of-missing-.html"><a href="example-prescribed-amount-of-missing-.html#create-a-complete-data-set-by-filling-in-the-missing-data-using-the-imputations"><i class="fa fa-check"></i><b>12.8.5</b> Create a complete data set by filling in the missing data using the imputations</a></li>
<li class="chapter" data-level="12.8.6" data-path="example-prescribed-amount-of-missing-.html"><a href="example-prescribed-amount-of-missing-.html#visualize-imputations"><i class="fa fa-check"></i><b>12.8.6</b> Visualize Imputations</a></li>
<li class="chapter" data-level="12.8.7" data-path="example-prescribed-amount-of-missing-.html"><a href="example-prescribed-amount-of-missing-.html#calculating-bias"><i class="fa fa-check"></i><b>12.8.7</b> Calculating bias</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="final-thoughts.html"><a href="final-thoughts.html"><i class="fa fa-check"></i><b>12.9</b> Final thoughts</a></li>
<li class="chapter" data-level="12.10" data-path="additional-references-1.html"><a href="additional-references-1.html"><i class="fa fa-check"></i><b>12.10</b> Additional References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/norcalbiostat/AppliedStatistics_notes" target="blank">View source on Github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="categorical-v.-categorical" class="section level2">
<h2><span class="header-section-number">2.6</span> Categorical v. Categorical</h2>
<div id="two-way-tables" class="section level3">
<h3><span class="header-section-number">2.6.1</span> Two-way Tables</h3>
<p>Cross-tabs, cross-tabulations and two-way tables (all the same thing, different names) can be created by using the <code>table()</code> function.</p>
<div id="frequency-table" class="section level4">
<h4><span class="header-section-number">2.6.1.1</span> Frequency table</h4>
<p>The frequency table is constructed using the <code>table()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(dsmall<span class="op">$</span>cut, dsmall<span class="op">$</span>color)
##            
##              D  E  F  G  H  I  J
##   Fair       4  5  4  3 10  1  0
##   Good      13  6 19 16 10 13  6
##   Very Good 30 60 37 50 26 18  5
##   Premium   39 42 40 55 46 40 15
##   Ideal     63 69 52 77 65 40 21</code></pre></div>
<p>There are 4 Fair diamonds with color D, and 21 Ideal quality diamonds with color J.</p>
</div>
<div id="cell-proportions" class="section level4">
<h4><span class="header-section-number">2.6.1.2</span> Cell proportions</h4>
<p>Wrapping <code>prop.table()</code> around a table gives you the <strong>cell</strong> proportions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.table</span>(<span class="kw">table</span>(dsmall<span class="op">$</span>cut, dsmall<span class="op">$</span>color))
##            
##                 D     E     F     G     H     I     J
##   Fair      0.004 0.005 0.004 0.003 0.010 0.001 0.000
##   Good      0.013 0.006 0.019 0.016 0.010 0.013 0.006
##   Very Good 0.030 0.060 0.037 0.050 0.026 0.018 0.005
##   Premium   0.039 0.042 0.040 0.055 0.046 0.040 0.015
##   Ideal     0.063 0.069 0.052 0.077 0.065 0.040 0.021</code></pre></div>
<p>0.4% of all diamonds are D color and Fair cut, 2.1% are J color and Ideal cut.</p>
</div>
<div id="row-proportions" class="section level4">
<h4><span class="header-section-number">2.6.1.3</span> Row proportions</h4>
<p>To get the <strong>row</strong> proportions, you specify <code>margin=1</code>. The percentages now add up to 1 across the rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(dsmall<span class="op">$</span>cut, dsmall<span class="op">$</span>color), <span class="dt">margin=</span><span class="dv">1</span>),<span class="dv">3</span>)
##            
##                 D     E     F     G     H     I     J
##   Fair      0.148 0.185 0.148 0.111 0.370 0.037 0.000
##   Good      0.157 0.072 0.229 0.193 0.120 0.157 0.072
##   Very Good 0.133 0.265 0.164 0.221 0.115 0.080 0.022
##   Premium   0.141 0.152 0.144 0.199 0.166 0.144 0.054
##   Ideal     0.163 0.178 0.134 0.199 0.168 0.103 0.054</code></pre></div>
<p>14.8% of all Fair quality diamonds are color D. 5.4% of all Ideal quality diamonds have color J.</p>
</div>
<div id="column-proportions" class="section level4">
<h4><span class="header-section-number">2.6.1.4</span> Column proportions</h4>
<p>To get the <strong>column</strong> proportions, you specify <code>margin=2</code>. The percentages now add up to 1 down the columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(dsmall<span class="op">$</span>cut, dsmall<span class="op">$</span>color), <span class="dt">margin=</span><span class="dv">2</span>),<span class="dv">3</span>)
##            
##                 D     E     F     G     H     I     J
##   Fair      0.027 0.027 0.026 0.015 0.064 0.009 0.000
##   Good      0.087 0.033 0.125 0.080 0.064 0.116 0.128
##   Very Good 0.201 0.330 0.243 0.249 0.166 0.161 0.106
##   Premium   0.262 0.231 0.263 0.274 0.293 0.357 0.319
##   Ideal     0.423 0.379 0.342 0.383 0.414 0.357 0.447</code></pre></div>
<p>2.7% of all D color diamonds are of Fair quality. 44.7% of all J color diamonds are of Ideal quality.</p>
</div>
</div>
<div id="grouped-bar-charts" class="section level3">
<h3><span class="header-section-number">2.6.2</span> Grouped bar charts</h3>
<p>To compare proportions of one categorical variable within the same level of another, is to use grouped barcharts.</p>
<div id="base-6" class="section level4">
<h4><span class="header-section-number">2.6.2.1</span> base</h4>
<p>As before, the object to be plotted needs to be the result of a table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cc &lt;-<span class="st"> </span><span class="kw">table</span>(dsmall<span class="op">$</span>cut, dsmall<span class="op">$</span>color)
<span class="kw">barplot</span>(cc)</code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>Stacked bars can be difficult to interpret, and very difficult to compare values between groups. A side by side barchart is preferable. The <code>beside=TRUE</code> is what controls the placement of the bars.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(cc, <span class="dt">main=</span><span class="st">&quot;quick side by side barchart using base graphics&quot;</span>, <span class="dt">beside=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>Great, but what do the colors represent? We need to add a legend. And i’m going to customize the colors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(cc, <span class="dt">main=</span><span class="st">&quot;quick side by side barchart using base graphics&quot;</span>, <span class="dt">beside=</span><span class="ot">TRUE</span>, 
        <span class="dt">col=</span><span class="kw">rainbow</span>(<span class="dv">5</span>), <span class="dt">legend=</span><span class="kw">rownames</span>(cc))</code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>For more than 2 colors I do not recommend choosing the colors yourself. I know little about color theory so I use the built-in color palettes. Here is a <a href="https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/colorPaletteCheatsheet.pdf">great cheatsheet</a> about using color palettes.</p>
</div>
<div id="ggplot-6" class="section level4">
<h4><span class="header-section-number">2.6.2.2</span> ggplot</h4>
<p>Again plot the cut on the x axis, but then <code>fill</code> using the second categorical variable. This has the effect of visualizing the <strong>row</strong> percents from the table above. The percent of color, within each type of cut.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(dsmall, <span class="kw">aes</span>(<span class="dt">x=</span>cut, <span class="dt">fill=</span>color)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>Again the default is a stacked barchart. So we just specify <code>position=dodge</code> to put the bars side by side.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(dsmall, <span class="kw">aes</span>(<span class="dt">x=</span>cut, <span class="dt">fill=</span>color)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>And look, an automatic legend. What if I wanted to better compare cut within color group? This is the <strong>column</strong> percentages. Just switch which variable is the x axis and which one is used to fill the colors!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(dsmall, <span class="kw">aes</span>(<span class="dt">x=</span>color, <span class="dt">fill=</span>cut)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>And this easy change is why we love <code>ggplot2</code>.</p>
</div>
</div>
<div id="grouped-bar-charts-with-percentages" class="section level3">
<h3><span class="header-section-number">2.6.3</span> Grouped bar charts with percentages</h3>
<p>Not as easy as one would hope, but the solution is to calculate the desired percentages first and then plot the summary data using either <code>geom_bar(stat='identity')</code> or <code>geom_col()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">calc.props &lt;-<span class="st"> </span>diamonds <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(color, cut) <span class="op">%&gt;%</span>
<span class="st">              </span><span class="kw">summarise</span>(<span class="dt">count=</span><span class="kw">n</span>()) <span class="op">%&gt;%</span>
<span class="st">              </span><span class="kw">mutate</span>(<span class="dt">pct=</span><span class="kw">round</span>(count<span class="op">/</span><span class="kw">sum</span>(count),<span class="dv">3</span>))
calc.props
## # A tibble: 35 x 4
## # Groups:   color [7]
##    color cut       count   pct
##    &lt;ord&gt; &lt;ord&gt;     &lt;int&gt; &lt;dbl&gt;
##  1 D     Fair        163 0.024
##  2 D     Good        662 0.098
##  3 D     Very Good  1513 0.223
##  4 D     Premium    1603 0.237
##  5 D     Ideal      2834 0.418
##  6 E     Fair        224 0.023
##  7 E     Good        933 0.095
##  8 E     Very Good  2400 0.245
##  9 E     Premium    2337 0.239
## 10 E     Ideal      3903 0.398
## # ... with 25 more rows</code></pre></div>
<p>Since we’re plotting summary data, the height of the bars is specified using <code>y=pct</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(calc.props, <span class="kw">aes</span>(<span class="dt">x=</span>color, <span class="dt">fill=</span>cut, <span class="dt">y=</span>pct)) <span class="op">+</span>
<span class="st">                  </span><span class="kw">geom_col</span>(<span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() </code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>Now set some options to the y axis using <code>scale_y_continuous()</code> to make the graph more accurate and readable. The <code>labels=percent</code> comes from the <code>scales</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(scales)
<span class="kw">ggplot</span>(calc.props, <span class="kw">aes</span>(<span class="dt">x=</span>color, <span class="dt">fill=</span>cut, <span class="dt">y=</span>pct)) <span class="op">+</span>
<span class="st">                  </span><span class="kw">geom_col</span>(<span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">                  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">labels=</span>percent)</code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
<div id="mosaic-plots" class="section level3">
<h3><span class="header-section-number">2.6.4</span> Mosaic plots</h3>
<p>But what if you want to know how two categorical variables are related and you don’t want to look at two different barplots? Mosaic plots are a way to visualize the proportions in a table. So here’s the two-way table we’ll be plotting.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(dsmall<span class="op">$</span>cut, dsmall<span class="op">$</span>color)
##            
##              D  E  F  G  H  I  J
##   Fair       4  5  4  3 10  1  0
##   Good      13  6 19 16 10 13  6
##   Very Good 30 60 37 50 26 18  5
##   Premium   39 42 40 55 46 40 15
##   Ideal     63 69 52 77 65 40 21</code></pre></div>
<p>The syntax for a mosaic plot uses <em>model notation</em>, which is basically y ~ x where the ~ is read as “twiddle” or “tilde”. It’s to the left of your <strong>1</strong> key.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mosaicplot</span>(cut<span class="op">~</span>color, <span class="dt">data=</span>dsmall)</code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>Helpful, ish. Here are two very useful options. In reverse obviousness, <code>color</code> applies shades of gray to one of the factor levels, and <code>shade</code> applies a color gradient scale to the cells in order of what is less than expected (red) to what is more than expected (blue) if these two factors were completely independent.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="co"># display the plots in 1 row and 2 columns</span>
<span class="kw">mosaicplot</span>(cut<span class="op">~</span>color, <span class="dt">data=</span>dsmall, <span class="dt">color=</span><span class="ot">TRUE</span>)
<span class="kw">mosaicplot</span>(cut<span class="op">~</span>color, <span class="dt">data=</span>dsmall, <span class="dt">shade=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-48-1.png" width="960" /></p>
<p>For example, there are fewer ‘Very Good’ cut diamonds that are color ‘G’, and fewer ‘Premium’ cut diamonds that are color ‘H’. As you can see, knowing what your data means when trying to interpret what the plots are telling you is essential.</p>
<p>That’s about all the ways you can plot categorical variables. If you are wondering why there was no 3D barcharts demonstrated see<br />
<a href="http://faculty.atu.edu/mfinan/2043/section31.pdf">here</a>, <a href="http://www.bbc.co.uk/schools/gcsebitesize/maths/statistics/representingdata2rev5.shtml">here</a>, and <a href="https://en.wikipedia.org/wiki/Misleading_graph">here</a> for other ways you can really screw up your visualization.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="normal-qq-plots.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="continuous-v-continuous.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

<!-- </html> -->
