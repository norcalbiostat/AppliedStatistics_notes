<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.4 Bivariate Visualizations | Applied Statistics</title>
  <meta name="description" content="Course notes for Applied Statistics courses at CSU Chico" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="2.4 Bivariate Visualizations | Applied Statistics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course notes for Applied Statistics courses at CSU Chico" />
  <meta name="github-repo" content="norcalbiostat/AppliedStatistics_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.4 Bivariate Visualizations | Applied Statistics" />
  
  <meta name="twitter:description" content="Course notes for Applied Statistics courses at CSU Chico" />
  

<meta name="author" content="Robin Donatello, Edward Roualdes" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="univariate-visualizations.html"/>
<link rel="next" href="faceting-paneling.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Statistics course notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Preparing Data for Analysis</b></span></li>
<li class="chapter" data-level="1" data-path="data_prep.html"><a href="data_prep.html"><i class="fa fa-check"></i><b>1</b> Workflow and Data Cleaning</a>
<ul>
<li class="chapter" data-level="1.1" data-path="generating-a-reproducible-workflows.html"><a href="generating-a-reproducible-workflows.html"><i class="fa fa-check"></i><b>1.1</b> Generating a reproducible workflows</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="generating-a-reproducible-workflows.html"><a href="generating-a-reproducible-workflows.html#literate-programming"><i class="fa fa-check"></i><b>1.1.1</b> Literate programming</a></li>
<li class="chapter" data-level="1.1.2" data-path="generating-a-reproducible-workflows.html"><a href="generating-a-reproducible-workflows.html#reproducible-research-literate-programming"><i class="fa fa-check"></i><b>1.1.2</b> Reproducible Research + Literate Programming</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="import-data.html"><a href="import-data.html"><i class="fa fa-check"></i><b>1.2</b> Import data</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="import-data.html"><a href="import-data.html#renaming-variable-names-for-sanity-sake"><i class="fa fa-check"></i><b>1.2.1</b> Renaming variable names for sanity sake</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="data-management.html"><a href="data-management.html"><i class="fa fa-check"></i><b>1.3</b> Data Management</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="data-management.html"><a href="data-management.html#missing-data"><i class="fa fa-check"></i><b>1.3.1</b> Missing data</a></li>
<li class="chapter" data-level="1.3.2" data-path="data-management.html"><a href="data-management.html#identifying-variable-types"><i class="fa fa-check"></i><b>1.3.2</b> Identifying Variable Types</a></li>
<li class="chapter" data-level="1.3.3" data-path="data-management.html"><a href="data-management.html#outliers"><i class="fa fa-check"></i><b>1.3.3</b> Outliers</a></li>
<li class="chapter" data-level="1.3.4" data-path="data-management.html"><a href="data-management.html#creating-secondary-variables"><i class="fa fa-check"></i><b>1.3.4</b> Creating secondary variables</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="saving-your-changes.html"><a href="saving-your-changes.html"><i class="fa fa-check"></i><b>1.4</b> Saving your changes</a></li>
<li class="chapter" data-level="1.5" data-path="wide-long.html"><a href="wide-long.html"><i class="fa fa-check"></i><b>1.5</b> Wide vs. Long data</a></li>
<li class="chapter" data-level="1.6" data-path="dealing-with-missing-data-post-analysis.html"><a href="dealing-with-missing-data-post-analysis.html"><i class="fa fa-check"></i><b>1.6</b> Dealing with missing data post-analysis</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="dealing-with-missing-data-post-analysis.html"><a href="dealing-with-missing-data-post-analysis.html#regression"><i class="fa fa-check"></i><b>1.6.1</b> Regression</a></li>
<li class="chapter" data-level="1.6.2" data-path="dealing-with-missing-data-post-analysis.html"><a href="dealing-with-missing-data-post-analysis.html#factor-analysis-and-principle-components"><i class="fa fa-check"></i><b>1.6.2</b> Factor Analysis and Principle Components</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data_viz.html"><a href="data_viz.html"><i class="fa fa-check"></i><b>2</b> Visualizing Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-syntax-of-ggplot.html"><a href="the-syntax-of-ggplot.html"><i class="fa fa-check"></i><b>2.1</b> The syntax of <code>ggplot</code></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="the-syntax-of-ggplot.html"><a href="the-syntax-of-ggplot.html#required-arguments"><i class="fa fa-check"></i><b>2.1.1</b> Required arguments</a></li>
<li class="chapter" data-level="2.1.2" data-path="the-syntax-of-ggplot.html"><a href="the-syntax-of-ggplot.html#optional-but-helpful-arguments"><i class="fa fa-check"></i><b>2.1.2</b> Optional but helpful arguments</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="the-data.html"><a href="the-data.html"><i class="fa fa-check"></i><b>2.2</b> The Data</a></li>
<li class="chapter" data-level="2.3" data-path="univariate-visualizations.html"><a href="univariate-visualizations.html"><i class="fa fa-check"></i><b>2.3</b> Univariate Visualizations</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="univariate-visualizations.html"><a href="univariate-visualizations.html#categorical-variables"><i class="fa fa-check"></i><b>2.3.1</b> Categorical variables</a></li>
<li class="chapter" data-level="2.3.2" data-path="univariate-visualizations.html"><a href="univariate-visualizations.html#continuous-measures"><i class="fa fa-check"></i><b>2.3.2</b> Continuous Measures</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html"><i class="fa fa-check"></i><b>2.4</b> Bivariate Visualizations</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#categorical-v.-categorical"><i class="fa fa-check"></i><b>2.4.1</b> Categorical v. Categorical</a></li>
<li class="chapter" data-level="2.4.2" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#grouped-bar-charts-with-percentages"><i class="fa fa-check"></i><b>2.4.2</b> Grouped bar charts with percentages</a></li>
<li class="chapter" data-level="2.4.3" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#continuous-v.-continuous"><i class="fa fa-check"></i><b>2.4.3</b> Continuous v. Continuous</a></li>
<li class="chapter" data-level="2.4.4" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#continuous-v.-categorical"><i class="fa fa-check"></i><b>2.4.4</b> Continuous v. Categorical</a></li>
<li class="chapter" data-level="2.4.5" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#joy-plots-ridgelines"><i class="fa fa-check"></i><b>2.4.5</b> Joy plots / Ridgelines</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="faceting-paneling.html"><a href="faceting-paneling.html"><i class="fa fa-check"></i><b>2.5</b> Faceting / paneling</a></li>
<li class="chapter" data-level="2.6" data-path="multiple-plots-per-window.html"><a href="multiple-plots-per-window.html"><i class="fa fa-check"></i><b>2.6</b> Multiple plots per window</a></li>
<li class="chapter" data-level="2.7" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html"><i class="fa fa-check"></i><b>2.7</b> Multivariate (3+ variables)</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html#three-continuous"><i class="fa fa-check"></i><b>2.7.1</b> Three continuous</a></li>
<li class="chapter" data-level="2.7.2" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html#scatterplot-matrix"><i class="fa fa-check"></i><b>2.7.2</b> Scatterplot matrix</a></li>
<li class="chapter" data-level="2.7.3" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html#two-categorical-and-one-continuous"><i class="fa fa-check"></i><b>2.7.3</b> Two categorical and one continuous</a></li>
<li class="chapter" data-level="2.7.4" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html#two-continuous-and-one-categorical"><i class="fa fa-check"></i><b>2.7.4</b> Two continuous and one categorical</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="paneling-on-two-variables.html"><a href="paneling-on-two-variables.html"><i class="fa fa-check"></i><b>2.8</b> Paneling on two variables</a></li>
<li class="chapter" data-level="2.9" data-path="troubleshooting.html"><a href="troubleshooting.html"><i class="fa fa-check"></i><b>2.9</b> Troubleshooting</a></li>
<li class="chapter" data-level="2.10" data-path="but-what-about.html"><a href="but-what-about.html"><i class="fa fa-check"></i><b>2.10</b> But what about…</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="but-what-about.html"><a href="but-what-about.html#other-plots-not-mentioned"><i class="fa fa-check"></i><b>2.10.1</b> Other plots not mentioned</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>2.11</b> Additional Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="select_analysis.html"><a href="select_analysis.html"><i class="fa fa-check"></i><b>3</b> Selecting Appropriate Analyses</a></li>
<li class="part"><span><b>II Statistical Inference</b></span></li>
<li class="chapter" data-level="4" data-path="bv-intro.html"><a href="bv-intro.html"><i class="fa fa-check"></i><b>4</b> Foundations for Inference</a></li>
<li class="chapter" data-level="5" data-path="bivariate-analysis.html"><a href="bivariate-analysis.html"><i class="fa fa-check"></i><b>5</b> Bivariate Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="assumption-of-independent-observations.html"><a href="assumption-of-independent-observations.html"><i class="fa fa-check"></i><b>5.1</b> Assumption of Independent Observations</a></li>
<li class="chapter" data-level="5.2" data-path="choosing-appropriate-bivariate-analysis.html"><a href="choosing-appropriate-bivariate-analysis.html"><i class="fa fa-check"></i><b>5.2</b> Choosing appropriate bivariate analysis</a></li>
<li class="chapter" data-level="5.3" data-path="bv-ttest.html"><a href="bv-ttest.html"><i class="fa fa-check"></i><b>5.3</b> (Q~B) Two means: T-Test</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bv-ttest.html"><a href="bv-ttest.html#assumptions"><i class="fa fa-check"></i><b>5.3.1</b> Assumptions</a></li>
<li class="chapter" data-level="5.3.2" data-path="bv-ttest.html"><a href="bv-ttest.html#sampling-distribution-for-the-difference"><i class="fa fa-check"></i><b>5.3.2</b> Sampling Distribution for the difference</a></li>
<li class="chapter" data-level="5.3.3" data-path="bv-ttest.html"><a href="bv-ttest.html#example-smoking-and-bmi"><i class="fa fa-check"></i><b>5.3.3</b> Example: Smoking and BMI</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bv-anova.html"><a href="bv-anova.html"><i class="fa fa-check"></i><b>5.4</b> (Q~C) Multiple means: ANOVA</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="bv-anova.html"><a href="bv-anova.html#formulation-of-the-one-way-anova-model"><i class="fa fa-check"></i><b>5.4.1</b> Formulation of the One-way ANOVA model</a></li>
<li class="chapter" data-level="5.4.2" data-path="bv-anova.html"><a href="bv-anova.html#analysis-of-variance-table"><i class="fa fa-check"></i><b>5.4.2</b> Analysis of Variance Table*:</a></li>
<li class="chapter" data-level="5.4.3" data-path="bv-anova.html"><a href="bv-anova.html#the-f-distribution"><i class="fa fa-check"></i><b>5.4.3</b> The F-distribution</a></li>
<li class="chapter" data-level="5.4.4" data-path="bv-anova.html"><a href="bv-anova.html#assumptions-1"><i class="fa fa-check"></i><b>5.4.4</b> Assumptions</a></li>
<li class="chapter" data-level="5.4.5" data-path="bv-anova.html"><a href="bv-anova.html#example-a-comparison-of-plant-species-under-low-water-conditions"><i class="fa fa-check"></i><b>5.4.5</b> Example: A comparison of plant species under low water conditions</a></li>
<li class="chapter" data-level="5.4.6" data-path="bv-anova.html"><a href="bv-anova.html#coefficient-of-determination-r2"><i class="fa fa-check"></i><b>5.4.6</b> Coefficient of determination <span class="math inline">\(R^{2}\)</span></a></li>
<li class="chapter" data-level="5.4.7" data-path="bv-anova.html"><a href="bv-anova.html#multiple-comparisons"><i class="fa fa-check"></i><b>5.4.7</b> Multiple Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="bv-chisq.html"><a href="bv-chisq.html"><i class="fa fa-check"></i><b>5.5</b> (C~C) Multiple Proportions: <span class="math inline">\(\chi^{2}\)</span></a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="bv-chisq.html"><a href="bv-chisq.html#conditions-for-the-sampling-distribution-to-be-normal."><i class="fa fa-check"></i><b>5.5.1</b> Conditions for the sampling distribution to be normal.</a></li>
<li class="chapter" data-level="5.5.2" data-path="bv-chisq.html"><a href="bv-chisq.html#example-are-mammograms-effective"><i class="fa fa-check"></i><b>5.5.2</b> Example: Are Mammograms effective?</a></li>
<li class="chapter" data-level="5.5.3" data-path="bv-chisq.html"><a href="bv-chisq.html#example-smoking-and-general-health"><i class="fa fa-check"></i><b>5.5.3</b> Example: Smoking and General Health</a></li>
<li class="chapter" data-level="5.5.4" data-path="bv-chisq.html"><a href="bv-chisq.html#multiple-comparisons-1"><i class="fa fa-check"></i><b>5.5.4</b> Multiple Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="bv-corr.html"><a href="bv-corr.html"><i class="fa fa-check"></i><b>5.6</b> (Q~Q) Correlation</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="bv-corr.html"><a href="bv-corr.html#strength-of-the-correlation"><i class="fa fa-check"></i><b>5.6.1</b> Strength of the correlation</a></li>
<li class="chapter" data-level="5.6.2" data-path="bv-corr.html"><a href="bv-corr.html#example-federal-spending-per-capita-and-poverty-rate"><i class="fa fa-check"></i><b>5.6.2</b> Example: Federal spending per capita and poverty rate</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Regression Modeling</b></span></li>
<li class="chapter" data-level="6" data-path="reg-intro.html"><a href="reg-intro.html"><i class="fa fa-check"></i><b>6</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1" data-path="opening-remarks.html"><a href="opening-remarks.html"><i class="fa fa-check"></i><b>6.1</b> Opening Remarks</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="slr.html"><a href="slr.html"><i class="fa fa-check"></i><b>7</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="example.html"><a href="example.html"><i class="fa fa-check"></i><b>7.1</b> Example</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="example.html"><a href="example.html#caution-on-out-of-range-predictions"><i class="fa fa-check"></i><b>7.1.1</b> Caution on out of range predictions</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="mathematical-model.html"><a href="mathematical-model.html"><i class="fa fa-check"></i><b>7.2</b> Mathematical Model</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="mathematical-model.html"><a href="mathematical-model.html#unifying-model-framework"><i class="fa fa-check"></i><b>7.2.1</b> Unifying model framework</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="parameter-estimates.html"><a href="parameter-estimates.html"><i class="fa fa-check"></i><b>7.3</b> Parameter Estimates</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="parameter-estimates.html"><a href="parameter-estimates.html#sum-of-squares"><i class="fa fa-check"></i><b>7.3.1</b> Sum of Squares</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="assumptions-2.html"><a href="assumptions-2.html"><i class="fa fa-check"></i><b>7.4</b> Assumptions</a></li>
<li class="chapter" data-level="7.5" data-path="slr-fev.html"><a href="slr-fev.html"><i class="fa fa-check"></i><b>7.5</b> Example</a></li>
<li class="chapter" data-level="7.6" data-path="model-diagnostics.html"><a href="model-diagnostics.html"><i class="fa fa-check"></i><b>7.6</b> Model Diagnostics</a></li>
<li class="chapter" data-level="7.7" data-path="prediction.html"><a href="prediction.html"><i class="fa fa-check"></i><b>7.7</b> Prediction</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="prediction.html"><a href="prediction.html#predict-the-average-value-of-y-haty-based-on-the-model"><i class="fa fa-check"></i><b>7.7.1</b> Predict the <em>average</em> value of Y (<span class="math inline">\(\hat{y}\)</span>) based on the model</a></li>
<li class="chapter" data-level="7.7.2" data-path="prediction.html"><a href="prediction.html#confidence-intervals-for-the-predicted-mean"><i class="fa fa-check"></i><b>7.7.2</b> Confidence intervals for the predicted mean</a></li>
<li class="chapter" data-level="7.7.3" data-path="prediction.html"><a href="prediction.html#predict-the-average-value-of-y-haty_i-for-a-certain-value-of-x"><i class="fa fa-check"></i><b>7.7.3</b> Predict the <em>average</em> value of Y <span class="math inline">\((\hat{y_{i}})\)</span> for a certain value of <span class="math inline">\(x^{*}\)</span></a></li>
<li class="chapter" data-level="7.7.4" data-path="prediction.html"><a href="prediction.html#predict-a-new-value-of-y-haty_i-for-a-certain-value-of-x"><i class="fa fa-check"></i><b>7.7.4</b> Predict a <em>new</em> value of Y <span class="math inline">\(\hat{y_{i}}\)</span> for a certain value of <span class="math inline">\(x^{*}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="anova-for-regression.html"><a href="anova-for-regression.html"><i class="fa fa-check"></i><b>7.8</b> ANOVA for regression</a></li>
<li class="chapter" data-level="7.9" data-path="correlation-coefficient.html"><a href="correlation-coefficient.html"><i class="fa fa-check"></i><b>7.9</b> Correlation Coefficient</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mod-strat.html"><a href="mod-strat.html"><i class="fa fa-check"></i><b>8</b> Moderation and Stratification</a>
<ul>
<li class="chapter" data-level="8.1" data-path="moderation.html"><a href="moderation.html"><i class="fa fa-check"></i><b>8.1</b> Moderation</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="moderation.html"><a href="moderation.html#example-1-simpsons-paradox"><i class="fa fa-check"></i><b>8.1.1</b> Example 1: Simpson’s Paradox</a></li>
<li class="chapter" data-level="8.1.2" data-path="moderation.html"><a href="moderation.html#example-2-sepal-vs-petal-length-in-iris-flowers"><i class="fa fa-check"></i><b>8.1.2</b> Example 2: Sepal vs Petal Length in Iris flowers</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="stratification.html"><a href="stratification.html"><i class="fa fa-check"></i><b>8.2</b> Stratification</a></li>
<li class="chapter" data-level="8.3" data-path="identifying-a-moderator.html"><a href="identifying-a-moderator.html"><i class="fa fa-check"></i><b>8.3</b> Identifying a moderator</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="identifying-a-moderator.html"><a href="identifying-a-moderator.html#what-to-look-for-in-each-type-of-analysis"><i class="fa fa-check"></i><b>8.3.1</b> What to look for in each type of analysis</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="example-2-cont.-correlation-regression.html"><a href="example-2-cont.-correlation-regression.html"><i class="fa fa-check"></i><b>8.4</b> Example 2 (cont.) Correlation &amp; Regression</a></li>
<li class="chapter" data-level="8.5" data-path="example-3-anova.html"><a href="example-3-anova.html"><i class="fa fa-check"></i><b>8.5</b> Example 3: ANOVA</a></li>
<li class="chapter" data-level="8.6" data-path="example-4-chi-squared.html"><a href="example-4-chi-squared.html"><i class="fa fa-check"></i><b>8.6</b> Example 4: Chi-Squared</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mlr.html"><a href="mlr.html"><i class="fa fa-check"></i><b>9</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mathematical-model-1.html"><a href="mathematical-model-1.html"><i class="fa fa-check"></i><b>9.1</b> Mathematical Model</a></li>
<li class="chapter" data-level="9.2" data-path="parameter-estimation.html"><a href="parameter-estimation.html"><i class="fa fa-check"></i><b>9.2</b> Parameter Estimation</a></li>
<li class="chapter" data-level="9.3" data-path="fitting-the-model.html"><a href="fitting-the-model.html"><i class="fa fa-check"></i><b>9.3</b> Fitting the model</a></li>
<li class="chapter" data-level="9.4" data-path="interpreting-coefficients.html"><a href="interpreting-coefficients.html"><i class="fa fa-check"></i><b>9.4</b> Interpreting Coefficients</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="interpreting-coefficients.html"><a href="interpreting-coefficients.html#continuous-predictors"><i class="fa fa-check"></i><b>9.4.1</b> Continuous predictors</a></li>
<li class="chapter" data-level="9.4.2" data-path="interpreting-coefficients.html"><a href="interpreting-coefficients.html#binary-predictors"><i class="fa fa-check"></i><b>9.4.2</b> Binary predictors</a></li>
<li class="chapter" data-level="9.4.3" data-path="interpreting-coefficients.html"><a href="interpreting-coefficients.html#cat-predictors"><i class="fa fa-check"></i><b>9.4.3</b> Categorical Predictors</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="presenting-results.html"><a href="presenting-results.html"><i class="fa fa-check"></i><b>9.5</b> Presenting results</a></li>
<li class="chapter" data-level="9.6" data-path="confounding.html"><a href="confounding.html"><i class="fa fa-check"></i><b>9.6</b> Confounding</a></li>
<li class="chapter" data-level="9.7" data-path="what-to-watch-out-for.html"><a href="what-to-watch-out-for.html"><i class="fa fa-check"></i><b>9.7</b> What to watch out for</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-building.html"><a href="model-building.html"><i class="fa fa-check"></i><b>10</b> Model Building</a>
<ul>
<li class="chapter" data-level="10.1" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>10.1</b> Interactions</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="interactions.html"><a href="interactions.html#fitting-interaction-models-interpreting-coefficients"><i class="fa fa-check"></i><b>10.1.1</b> Fitting interaction models &amp; interpreting coefficients</a></li>
<li class="chapter" data-level="10.1.2" data-path="interactions.html"><a href="interactions.html#interactions-catvars"><i class="fa fa-check"></i><b>10.1.2</b> Categorical Interaction variables</a></li>
<li class="chapter" data-level="10.1.3" data-path="interactions.html"><a href="interactions.html#example-2"><i class="fa fa-check"></i><b>10.1.3</b> Example 2</a></li>
<li class="chapter" data-level="10.1.4" data-path="interactions.html"><a href="interactions.html#example-3"><i class="fa fa-check"></i><b>10.1.4</b> Example 3:</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="wald-test.html"><a href="wald-test.html"><i class="fa fa-check"></i><b>10.2</b> Wald test</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="wald-test.html"><a href="wald-test.html#example-modeling-depression-score"><i class="fa fa-check"></i><b>10.2.1</b> Example: Modeling depression score</a></li>
<li class="chapter" data-level="10.2.2" data-path="wald-test.html"><a href="wald-test.html#testing-for-a-moderation-effect-in-a-multiple-regression-model."><i class="fa fa-check"></i><b>10.2.2</b> Testing for a moderation effect in a multiple regression model.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="multicollinearity.html"><a href="multicollinearity.html"><i class="fa fa-check"></i><b>10.3</b> Multicollinearity</a></li>
<li class="chapter" data-level="10.4" data-path="variable-selection-process.html"><a href="variable-selection-process.html"><i class="fa fa-check"></i><b>10.4</b> Variable Selection Process</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="variable-selection-process.html"><a href="variable-selection-process.html#automated-selection-procedures"><i class="fa fa-check"></i><b>10.4.1</b> Automated selection procedures</a></li>
<li class="chapter" data-level="10.4.2" data-path="variable-selection-process.html"><a href="variable-selection-process.html#lasso-regression-pma6-9.7"><i class="fa fa-check"></i><b>10.4.2</b> LASSO Regression (PMA6 9.7)</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html"><i class="fa fa-check"></i><b>10.5</b> Comparing between models</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#rss-residual-sum-of-squares"><i class="fa fa-check"></i><b>10.5.1</b> RSS: Residual Sum of Squares</a></li>
<li class="chapter" data-level="10.5.2" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#general-F"><i class="fa fa-check"></i><b>10.5.2</b> General F Test</a></li>
<li class="chapter" data-level="10.5.3" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#likelihood-function"><i class="fa fa-check"></i><b>10.5.3</b> Likelihood function</a></li>
<li class="chapter" data-level="10.5.4" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#multiple-r2"><i class="fa fa-check"></i><b>10.5.4</b> Multiple <span class="math inline">\(R^{2}\)</span></a></li>
<li class="chapter" data-level="10.5.5" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#adjusted-r2"><i class="fa fa-check"></i><b>10.5.5</b> Adjusted <span class="math inline">\(R^{2}\)</span></a></li>
<li class="chapter" data-level="10.5.6" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#mallows-c_p"><i class="fa fa-check"></i><b>10.5.6</b> Mallows <span class="math inline">\(C_{p}\)</span></a></li>
<li class="chapter" data-level="10.5.7" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#akaike-information-criterion-aic"><i class="fa fa-check"></i><b>10.5.7</b> Akaike Information Criterion (AIC)</a></li>
<li class="chapter" data-level="10.5.8" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#bayesian-information-criterion-bic"><i class="fa fa-check"></i><b>10.5.8</b> Bayesian Information Criterion (BIC)</a></li>
<li class="chapter" data-level="10.5.9" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#aic-vs-bic"><i class="fa fa-check"></i><b>10.5.9</b> AIC vs BIC</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html"><i class="fa fa-check"></i><b>10.6</b> Model Diagnostics</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html#linearity"><i class="fa fa-check"></i><b>10.6.1</b> Linearity</a></li>
<li class="chapter" data-level="10.6.2" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html#normality-of-residuals."><i class="fa fa-check"></i><b>10.6.2</b> Normality of residuals.</a></li>
<li class="chapter" data-level="10.6.3" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html#homogeneity-of-variance"><i class="fa fa-check"></i><b>10.6.3</b> Homogeneity of variance</a></li>
<li class="chapter" data-level="10.6.4" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html#posterior-predictions"><i class="fa fa-check"></i><b>10.6.4</b> Posterior Predictions</a></li>
<li class="chapter" data-level="10.6.5" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html#all-at-once"><i class="fa fa-check"></i><b>10.6.5</b> All at once</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="general-advice-pma6-9.html"><a href="general-advice-pma6-9.html"><i class="fa fa-check"></i><b>10.7</b> General Advice (PMA6 9.9)</a></li>
<li class="chapter" data-level="10.8" data-path="what-to-watch-out-for-pma6-9.html"><a href="what-to-watch-out-for-pma6-9.html"><i class="fa fa-check"></i><b>10.8</b> What to watch out for (PMA6 9.10)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>11</b> Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="fitting-glms.html"><a href="fitting-glms.html"><i class="fa fa-check"></i><b>11.1</b> Fitting GLMs</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="fitting-glms.html"><a href="fitting-glms.html#r"><i class="fa fa-check"></i><b>11.1.1</b> R</a></li>
<li class="chapter" data-level="11.1.2" data-path="fitting-glms.html"><a href="fitting-glms.html#spss"><i class="fa fa-check"></i><b>11.1.2</b> SPSS</a></li>
<li class="chapter" data-level="11.1.3" data-path="fitting-glms.html"><a href="fitting-glms.html#stata"><i class="fa fa-check"></i><b>11.1.3</b> Stata</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="binary-outcome-data.html"><a href="binary-outcome-data.html"><i class="fa fa-check"></i><b>11.2</b> Binary outcome data</a></li>
<li class="chapter" data-level="11.3" data-path="logreg.html"><a href="logreg.html"><i class="fa fa-check"></i><b>11.3</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="logreg.html"><a href="logreg.html#interpreting-odds-ratios"><i class="fa fa-check"></i><b>11.3.1</b> Interpreting Odds Ratios</a></li>
<li class="chapter" data-level="11.3.2" data-path="logreg.html"><a href="logreg.html#or-ci"><i class="fa fa-check"></i><b>11.3.2</b> Confidence Intervals</a></li>
<li class="chapter" data-level="11.3.3" data-path="logreg.html"><a href="logreg.html#logreg-dep-ex"><i class="fa fa-check"></i><b>11.3.3</b> Example: The effect of gender on Depression</a></li>
<li class="chapter" data-level="11.3.4" data-path="logreg.html"><a href="logreg.html#mlogreg"><i class="fa fa-check"></i><b>11.3.4</b> Multiple Logistic Regression</a></li>
<li class="chapter" data-level="11.3.5" data-path="logreg.html"><a href="logreg.html#effect-of-a-k-unit-change"><i class="fa fa-check"></i><b>11.3.5</b> Effect of a k unit change</a></li>
<li class="chapter" data-level="11.3.6" data-path="logreg.html"><a href="logreg.html#example-predictors-of-smoking-status"><i class="fa fa-check"></i><b>11.3.6</b> Example: Predictors of smoking status</a></li>
<li class="chapter" data-level="11.3.7" data-path="logreg.html"><a href="logreg.html#model-fit"><i class="fa fa-check"></i><b>11.3.7</b> Model Fit</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="log-linear.html"><a href="log-linear.html"><i class="fa fa-check"></i><b>11.4</b> Log-linear models</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="log-linear.html"><a href="log-linear.html#example-4"><i class="fa fa-check"></i><b>11.4.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="poisson-reg.html"><a href="poisson-reg.html"><i class="fa fa-check"></i><b>11.5</b> Count outcome data</a></li>
<li class="chapter" data-level="11.6" data-path="multinomial-reg.html"><a href="multinomial-reg.html"><i class="fa fa-check"></i><b>11.6</b> Categorical outcome data</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="binary-classification.html"><a href="binary-classification.html"><i class="fa fa-check"></i><b>12</b> Classification of Binary outcomes</a>
<ul>
<li class="chapter" data-level="12.1" data-path="predicted-probabilities.html"><a href="predicted-probabilities.html"><i class="fa fa-check"></i><b>12.1</b> Predicted Probabilities</a></li>
<li class="chapter" data-level="12.2" data-path="distribution-of-predicted-probabilities.html"><a href="distribution-of-predicted-probabilities.html"><i class="fa fa-check"></i><b>12.2</b> Distribution of Predicted probabilities</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="distribution-of-predicted-probabilities.html"><a href="distribution-of-predicted-probabilities.html#plotting-predictions-against-covariates"><i class="fa fa-check"></i><b>12.2.1</b> Plotting predictions against covariates</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="predicted-class-outcome.html"><a href="predicted-class-outcome.html"><i class="fa fa-check"></i><b>12.3</b> Predicted Class (outcome)</a></li>
<li class="chapter" data-level="12.4" data-path="confusion-matrix.html"><a href="confusion-matrix.html"><i class="fa fa-check"></i><b>12.4</b> Confusion Matrix</a></li>
<li class="chapter" data-level="12.5" data-path="vocabulary-terms.html"><a href="vocabulary-terms.html"><i class="fa fa-check"></i><b>12.5</b> Vocabulary terms</a></li>
<li class="chapter" data-level="12.6" data-path="roc-curves.html"><a href="roc-curves.html"><i class="fa fa-check"></i><b>12.6</b> ROC Curves</a></li>
<li class="chapter" data-level="12.7" data-path="model-performance.html"><a href="model-performance.html"><i class="fa fa-check"></i><b>12.7</b> Model Performance</a></li>
</ul></li>
<li class="part"><span><b>IV Multivariate Analysis</b></span></li>
<li class="chapter" data-level="13" data-path="mv-intro.html"><a href="mv-intro.html"><i class="fa fa-check"></i><b>13</b> Introduction</a></li>
<li class="chapter" data-level="14" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>14</b> Principal Component Analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="when-is-principal-components-analysis-pca-used.html"><a href="when-is-principal-components-analysis-pca-used.html"><i class="fa fa-check"></i><b>14.1</b> When is Principal Components Analysis (PCA) used?</a></li>
<li class="chapter" data-level="14.2" data-path="basic-idea.html"><a href="basic-idea.html"><i class="fa fa-check"></i><b>14.2</b> Basic Idea - change of coordinates</a></li>
<li class="chapter" data-level="14.3" data-path="more-generally.html"><a href="more-generally.html"><i class="fa fa-check"></i><b>14.3</b> More Generally</a></li>
<li class="chapter" data-level="14.4" data-path="r-commands.html"><a href="r-commands.html"><i class="fa fa-check"></i><b>14.4</b> R commands</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="r-commands.html"><a href="r-commands.html#generating-pcs"><i class="fa fa-check"></i><b>14.4.1</b> Generating PC’s</a></li>
<li class="chapter" data-level="14.4.2" data-path="r-commands.html"><a href="r-commands.html#viewing-the-amount-of-variance-contained-by-each-pc"><i class="fa fa-check"></i><b>14.4.2</b> Viewing the amount of variance contained by each PC</a></li>
<li class="chapter" data-level="14.4.3" data-path="r-commands.html"><a href="r-commands.html#vizualize-loadings"><i class="fa fa-check"></i><b>14.4.3</b> Vizualize Loadings</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="data-reduction.html"><a href="data-reduction.html"><i class="fa fa-check"></i><b>14.5</b> Data Reduction</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="data-reduction.html"><a href="data-reduction.html#choosing-m"><i class="fa fa-check"></i><b>14.5.1</b> Choosing <span class="math inline">\(m\)</span></a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="standardizing.html"><a href="standardizing.html"><i class="fa fa-check"></i><b>14.6</b> Standardizing</a></li>
<li class="chapter" data-level="14.7" data-path="example-5.html"><a href="example-5.html"><i class="fa fa-check"></i><b>14.7</b> Example</a></li>
<li class="chapter" data-level="14.8" data-path="use-in-multiple-regression.html"><a href="use-in-multiple-regression.html"><i class="fa fa-check"></i><b>14.8</b> Use in Multiple Regression</a>
<ul>
<li class="chapter" data-level="14.8.1" data-path="use-in-multiple-regression.html"><a href="use-in-multiple-regression.html#example-modeling-acute-illness"><i class="fa fa-check"></i><b>14.8.1</b> Example: Modeling acute illness</a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="things-to-watch-out-for.html"><a href="things-to-watch-out-for.html"><i class="fa fa-check"></i><b>14.9</b> Things to watch out for</a></li>
<li class="chapter" data-level="14.10" data-path="additional-references.html"><a href="additional-references.html"><i class="fa fa-check"></i><b>14.10</b> Additional References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="fa.html"><a href="fa.html"><i class="fa fa-check"></i><b>15</b> Factor Analysis</a>
<ul>
<li class="chapter" data-level="15.1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>15.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="introduction.html"><a href="introduction.html#latent-constructs"><i class="fa fa-check"></i><b>15.1.1</b> Latent Constructs</a></li>
<li class="chapter" data-level="15.1.2" data-path="introduction.html"><a href="introduction.html#comparison-with-pca"><i class="fa fa-check"></i><b>15.1.2</b> Comparison with PCA</a></li>
<li class="chapter" data-level="15.1.3" data-path="introduction.html"><a href="introduction.html#efa-vs-cfa"><i class="fa fa-check"></i><b>15.1.3</b> EFA vs CFA</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="factor-model.html"><a href="factor-model.html"><i class="fa fa-check"></i><b>15.2</b> Factor Model</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="factor-model.html"><a href="factor-model.html#components-of-variance"><i class="fa fa-check"></i><b>15.2.1</b> Components of Variance</a></li>
<li class="chapter" data-level="15.2.2" data-path="factor-model.html"><a href="factor-model.html#two-big-steps"><i class="fa fa-check"></i><b>15.2.2</b> Two big steps</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="fa-example.html"><a href="fa-example.html"><i class="fa fa-check"></i><b>15.3</b> Example data setup</a></li>
<li class="chapter" data-level="15.4" data-path="fa-extract.html"><a href="fa-extract.html"><i class="fa fa-check"></i><b>15.4</b> Factor Extraction Methods</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="fa-extract.html"><a href="fa-extract.html#principal-components-pc-factor-model"><i class="fa fa-check"></i><b>15.4.1</b> Principal components (PC Factor model)</a></li>
<li class="chapter" data-level="15.4.2" data-path="fa-extract.html"><a href="fa-extract.html#iterated-components"><i class="fa fa-check"></i><b>15.4.2</b> Iterated components</a></li>
<li class="chapter" data-level="15.4.3" data-path="fa-extract.html"><a href="fa-extract.html#maximum-likelihood"><i class="fa fa-check"></i><b>15.4.3</b> Maximum Likelihood</a></li>
<li class="chapter" data-level="15.4.4" data-path="fa-extract.html"><a href="fa-extract.html#uniqueness"><i class="fa fa-check"></i><b>15.4.4</b> Uniqueness</a></li>
<li class="chapter" data-level="15.4.5" data-path="fa-extract.html"><a href="fa-extract.html#resulting-factors"><i class="fa fa-check"></i><b>15.4.5</b> Resulting factors</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="rotating-factors.html"><a href="rotating-factors.html"><i class="fa fa-check"></i><b>15.5</b> Rotating Factors</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="rotating-factors.html"><a href="rotating-factors.html#varimax-rotation"><i class="fa fa-check"></i><b>15.5.1</b> Varimax Rotation</a></li>
<li class="chapter" data-level="15.5.2" data-path="rotating-factors.html"><a href="rotating-factors.html#oblique-rotation"><i class="fa fa-check"></i><b>15.5.2</b> Oblique rotation</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="factor-scores.html"><a href="factor-scores.html"><i class="fa fa-check"></i><b>15.6</b> Factor Scores</a></li>
<li class="chapter" data-level="15.7" data-path="what-to-watch-out-for-1.html"><a href="what-to-watch-out-for-1.html"><i class="fa fa-check"></i><b>15.7</b> What to watch out for</a></li>
<li class="chapter" data-level="15.8" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>15.8</b> Additional Resources</a></li>
</ul></li>
<li class="part"><span><b>V Multi-level Modeling</b></span></li>
<li class="chapter" data-level="16" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>16</b> Introduction</a>
<ul>
<li class="chapter" data-level="16.1" data-path="example-school-data.html"><a href="example-school-data.html"><i class="fa fa-check"></i><b>16.1</b> Example School Data</a></li>
<li class="chapter" data-level="16.2" data-path="multi-level-models.html"><a href="multi-level-models.html"><i class="fa fa-check"></i><b>16.2</b> Multi-level models</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="RI.html"><a href="RI.html"><i class="fa fa-check"></i><b>17</b> Random Intercept Models</a>
<ul>
<li class="chapter" data-level="17.1" data-path="pooling.html"><a href="pooling.html"><i class="fa fa-check"></i><b>17.1</b> Pooling</a></li>
<li class="chapter" data-level="17.2" data-path="mathri.html"><a href="mathri.html"><i class="fa fa-check"></i><b>17.2</b> Mathematical Models</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="mathri.html"><a href="mathri.html#complete-pooling"><i class="fa fa-check"></i><b>17.2.1</b> Complete Pooling</a></li>
<li class="chapter" data-level="17.2.2" data-path="mathri.html"><a href="mathri.html#no-pooling"><i class="fa fa-check"></i><b>17.2.2</b> No Pooling</a></li>
<li class="chapter" data-level="17.2.3" data-path="mathri.html"><a href="mathri.html#partial-pooling-ri"><i class="fa fa-check"></i><b>17.2.3</b> Partial Pooling (RI)</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="components-of-variance-1.html"><a href="components-of-variance-1.html"><i class="fa fa-check"></i><b>17.3</b> Components of Variance</a></li>
<li class="chapter" data-level="17.4" data-path="fitri.html"><a href="fitri.html"><i class="fa fa-check"></i><b>17.4</b> Fitting models in R</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="fitri.html"><a href="fitri.html#comparison-of-estimates"><i class="fa fa-check"></i><b>17.4.1</b> Comparison of estimates</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="estimation-methods.html"><a href="estimation-methods.html"><i class="fa fa-check"></i><b>17.5</b> Estimation Methods</a></li>
<li class="chapter" data-level="17.6" data-path="including-covariates.html"><a href="including-covariates.html"><i class="fa fa-check"></i><b>17.6</b> Including Covariates</a></li>
<li class="chapter" data-level="17.7" data-path="more-random-effects.html"><a href="more-random-effects.html"><i class="fa fa-check"></i><b>17.7</b> More Random Effects</a></li>
<li class="chapter" data-level="17.8" data-path="centering-terms.html"><a href="centering-terms.html"><i class="fa fa-check"></i><b>17.8</b> Centering terms</a>
<ul>
<li class="chapter" data-level="17.8.1" data-path="centering-terms.html"><a href="centering-terms.html#a-generic-dplyr-approach-to-centering."><i class="fa fa-check"></i><b>17.8.1</b> A generic <code>dplyr</code> approach to centering.</a></li>
</ul></li>
<li class="chapter" data-level="17.9" data-path="specifying-correlation-structures.html"><a href="specifying-correlation-structures.html"><i class="fa fa-check"></i><b>17.9</b> Specifying Correlation Structures</a>
<ul>
<li class="chapter" data-level="17.9.1" data-path="specifying-correlation-structures.html"><a href="specifying-correlation-structures.html#changing-covariance-structures-in-r"><i class="fa fa-check"></i><b>17.9.1</b> Changing covariance structures in R</a></li>
</ul></li>
<li class="chapter" data-level="17.10" data-path="additional-references-1.html"><a href="additional-references-1.html"><i class="fa fa-check"></i><b>17.10</b> Additional References</a>
<ul>
<li class="chapter" data-level="17.10.1" data-path="additional-references-1.html"><a href="additional-references-1.html#lecture-notes-from-other-classes-found-on-the-interwebs"><i class="fa fa-check"></i><b>17.10.1</b> Lecture notes from other classes found on the interwebs</a></li>
<li class="chapter" data-level="17.10.2" data-path="additional-references-1.html"><a href="additional-references-1.html#package-vignettes"><i class="fa fa-check"></i><b>17.10.2</b> Package Vignettes</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VI Other Topics</b></span></li>
<li class="chapter" data-level="18" data-path="mda.html"><a href="mda.html"><i class="fa fa-check"></i><b>18</b> Missing Data</a>
<ul>
<li class="chapter" data-level="18.1" data-path="identifying-missing-data.html"><a href="identifying-missing-data.html"><i class="fa fa-check"></i><b>18.1</b> Identifying missing data</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="identifying-missing-data.html"><a href="identifying-missing-data.html#visualize-missing-patterns"><i class="fa fa-check"></i><b>18.1.1</b> Visualize missing patterns</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="effects-of-nonresponse.html"><a href="effects-of-nonresponse.html"><i class="fa fa-check"></i><b>18.2</b> Effects of Nonresponse</a></li>
<li class="chapter" data-level="18.3" data-path="missing-data-mechanisms.html"><a href="missing-data-mechanisms.html"><i class="fa fa-check"></i><b>18.3</b> Missing Data Mechanisms</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="missing-data-mechanisms.html"><a href="missing-data-mechanisms.html#demonstration-via-simulation"><i class="fa fa-check"></i><b>18.3.1</b> Demonstration via Simulation</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="general-strategies.html"><a href="general-strategies.html"><i class="fa fa-check"></i><b>18.4</b> General strategies</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="general-strategies.html"><a href="general-strategies.html#complete-cases-analysis"><i class="fa fa-check"></i><b>18.4.1</b> Complete cases analysis</a></li>
<li class="chapter" data-level="18.4.2" data-path="general-strategies.html"><a href="general-strategies.html#available-case-analysis"><i class="fa fa-check"></i><b>18.4.2</b> Available-case analysis</a></li>
<li class="chapter" data-level="18.4.3" data-path="general-strategies.html"><a href="general-strategies.html#imputation"><i class="fa fa-check"></i><b>18.4.3</b> Imputation</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="imputation-methods.html"><a href="imputation-methods.html"><i class="fa fa-check"></i><b>18.5</b> Imputation Methods</a></li>
<li class="chapter" data-level="18.6" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html"><i class="fa fa-check"></i><b>18.6</b> Multiple Imputation (MI)</a>
<ul>
<li class="chapter" data-level="18.6.1" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#goals"><i class="fa fa-check"></i><b>18.6.1</b> Goals</a></li>
<li class="chapter" data-level="18.6.2" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#technique"><i class="fa fa-check"></i><b>18.6.2</b> Technique</a></li>
<li class="chapter" data-level="18.6.3" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#mi-as-a-paradigm"><i class="fa fa-check"></i><b>18.6.3</b> MI as a paradigm</a></li>
<li class="chapter" data-level="18.6.4" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#inference-on-mi"><i class="fa fa-check"></i><b>18.6.4</b> Inference on MI</a></li>
</ul></li>
<li class="chapter" data-level="18.7" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html"><i class="fa fa-check"></i><b>18.7</b> Multiple Imputation using Chained Equations (MICE)</a>
<ul>
<li class="chapter" data-level="18.7.1" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#overview"><i class="fa fa-check"></i><b>18.7.1</b> Overview</a></li>
<li class="chapter" data-level="18.7.2" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#process-algorithm"><i class="fa fa-check"></i><b>18.7.2</b> Process / Algorithm</a></li>
<li class="chapter" data-level="18.7.3" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#convergence"><i class="fa fa-check"></i><b>18.7.3</b> Convergence</a></li>
<li class="chapter" data-level="18.7.4" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#imputation-methods-1"><i class="fa fa-check"></i><b>18.7.4</b> Imputation Methods</a></li>
</ul></li>
<li class="chapter" data-level="18.8" data-path="diagnostics.html"><a href="diagnostics.html"><i class="fa fa-check"></i><b>18.8</b> Diagnostics</a></li>
<li class="chapter" data-level="18.9" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html"><i class="fa fa-check"></i><b>18.9</b> Example: Prescribed amount of missing.</a>
<ul>
<li class="chapter" data-level="18.9.1" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#multiply-impute-the-missing-data-using-mice"><i class="fa fa-check"></i><b>18.9.1</b> Multiply impute the missing data using <code>mice()</code></a></li>
<li class="chapter" data-level="18.9.2" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#check-the-imputation-method-used-on-each-variable."><i class="fa fa-check"></i><b>18.9.2</b> Check the imputation method used on each variable.</a></li>
<li class="chapter" data-level="18.9.3" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#check-convergence"><i class="fa fa-check"></i><b>18.9.3</b> Check Convergence</a></li>
<li class="chapter" data-level="18.9.4" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#look-at-the-values-generated-for-imputation"><i class="fa fa-check"></i><b>18.9.4</b> Look at the values generated for imputation</a></li>
<li class="chapter" data-level="18.9.5" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#create-a-complete-data-set-by-filling-in-the-missing-data-using-the-imputations"><i class="fa fa-check"></i><b>18.9.5</b> Create a complete data set by filling in the missing data using the imputations</a></li>
<li class="chapter" data-level="18.9.6" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#visualize-imputations"><i class="fa fa-check"></i><b>18.9.6</b> Visualize Imputations</a></li>
<li class="chapter" data-level="18.9.7" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#calculating-bias"><i class="fa fa-check"></i><b>18.9.7</b> Calculating bias</a></li>
</ul></li>
<li class="chapter" data-level="18.10" data-path="post-mice-data-management.html"><a href="post-mice-data-management.html"><i class="fa fa-check"></i><b>18.10</b> Post MICE data management</a></li>
<li class="chapter" data-level="18.11" data-path="final-thoughts.html"><a href="final-thoughts.html"><i class="fa fa-check"></i><b>18.11</b> Final thoughts</a></li>
<li class="chapter" data-level="18.12" data-path="additional-references-2.html"><a href="additional-references-2.html"><i class="fa fa-check"></i><b>18.12</b> Additional References</a></li>
</ul></li>
<li class="part"><span><b>VII APPENDIX</b></span></li>
<li class="chapter" data-level="19" data-path="setup_intro.html"><a href="setup_intro.html"><i class="fa fa-check"></i><b>19</b> Setup R &amp; RStudio</a>
<ul>
<li class="chapter" data-level="19.1" data-path="before-you-begin.html"><a href="before-you-begin.html"><i class="fa fa-check"></i><b>19.1</b> ⚠️ Before you begin</a></li>
<li class="chapter" data-level="19.2" data-path="download-and-install-r.html"><a href="download-and-install-r.html"><i class="fa fa-check"></i><b>19.2</b> Download and install R</a>
<ul>
<li class="chapter" data-level="" data-path="download-and-install-r.html"><a href="download-and-install-r.html#download_r"><i class="fa fa-check"></i>🔽 Download R v 4.1+</a></li>
<li class="chapter" data-level="" data-path="download-and-install-r.html"><a href="download-and-install-r.html#install_r"><i class="fa fa-check"></i>✏️ Install</a></li>
<li class="chapter" data-level="" data-path="download-and-install-r.html"><a href="download-and-install-r.html#install_vid"><i class="fa fa-check"></i>🎦 Video Tutorials for both R and R Studio.</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="download-and-install-r-studio.html"><a href="download-and-install-r-studio.html"><i class="fa fa-check"></i><b>19.3</b> Download and install R Studio</a></li>
<li class="chapter" data-level="19.4" data-path="nav-rstudio.html"><a href="nav-rstudio.html"><i class="fa fa-check"></i><b>19.4</b> Navigating RStudio</a></li>
<li class="chapter" data-level="19.5" data-path="setting-preferences.html"><a href="setting-preferences.html"><i class="fa fa-check"></i><b>19.5</b> Setting preferences</a></li>
<li class="chapter" data-level="19.6" data-path="installing-packages.html"><a href="installing-packages.html"><i class="fa fa-check"></i><b>19.6</b> Installing packages</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="installing-packages.html"><a href="installing-packages.html#common-packages-used-in-this-notebook"><i class="fa fa-check"></i><b>19.6.1</b> Common packages used in this notebook</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="organization-using-r-projects.html"><a href="organization-using-r-projects.html"><i class="fa fa-check"></i><b>19.7</b> Organization using R Projects</a></li>
<li class="chapter" data-level="19.8" data-path="literate-programming-with-quarto.html"><a href="literate-programming-with-quarto.html"><i class="fa fa-check"></i><b>19.8</b> Literate programming with Quarto</a>
<ul>
<li class="chapter" data-level="19.8.1" data-path="literate-programming-with-quarto.html"><a href="literate-programming-with-quarto.html#creating-pdfs"><i class="fa fa-check"></i><b>19.8.1</b> Creating PDF’s</a></li>
</ul></li>
<li class="chapter" data-level="19.9" data-path="seeking-help.html"><a href="seeking-help.html"><i class="fa fa-check"></i><b>19.9</b> Seeking Help</a>
<ul>
<li class="chapter" data-level="19.9.1" data-path="seeking-help.html"><a href="seeking-help.html#advice-on-asking-for-help"><i class="fa fa-check"></i><b>19.9.1</b> Advice on asking for help</a></li>
<li class="chapter" data-level="19.9.2" data-path="seeking-help.html"><a href="seeking-help.html#help-from-inside-r-studio"><i class="fa fa-check"></i><b>19.9.2</b> Help from inside R Studio</a></li>
<li class="chapter" data-level="19.9.3" data-path="seeking-help.html"><a href="seeking-help.html#other-online"><i class="fa fa-check"></i><b>19.9.3</b> Other Online</a></li>
<li class="chapter" data-level="19.9.4" data-path="seeking-help.html"><a href="seeking-help.html#written"><i class="fa fa-check"></i><b>19.9.4</b> Written</a></li>
</ul></li>
<li class="chapter" data-level="19.10" data-path="saving-and-closing-your-work..html"><a href="saving-and-closing-your-work..html"><i class="fa fa-check"></i><b>19.10</b> Saving and closing your work.</a>
<ul>
<li class="chapter" data-level="19.10.1" data-path="saving-and-closing-your-work..html"><a href="saving-and-closing-your-work..html#restart-r"><i class="fa fa-check"></i><b>19.10.1</b> Restart R</a></li>
</ul></li>
<li class="chapter" data-level="19.11" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i><b>19.11</b> Acknowledgements</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/norcalbiostat/AppliedStatistics_notes" target="blank">View source on Github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bivariate-visualizations" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Bivariate Visualizations<a href="bivariate-visualizations.html#bivariate-visualizations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="categorical-v.-categorical" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Categorical v. Categorical<a href="bivariate-visualizations.html#categorical-v.-categorical" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="two-way-frequency-tables" class="section level4 hasAnchor" number="2.4.1.1">
<h4><span class="header-section-number">2.4.1.1</span> Two-way Frequency tables<a href="bivariate-visualizations.html#two-way-frequency-tables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Cross-tabs, cross-tabulations and two-way tables (all the same thing, different names) can be created by using the <code>table()</code> function.</p>
<p>The frequency table is constructed using the <code>table()</code> function.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="bivariate-visualizations.html#cb73-1" tabindex="-1"></a><span class="fu">table</span>(dsmall<span class="sc">$</span>cut, dsmall<span class="sc">$</span>color)</span>
<span id="cb73-2"><a href="bivariate-visualizations.html#cb73-2" tabindex="-1"></a><span class="do">##            </span></span>
<span id="cb73-3"><a href="bivariate-visualizations.html#cb73-3" tabindex="-1"></a><span class="do">##              D  E  F  G  H  I  J</span></span>
<span id="cb73-4"><a href="bivariate-visualizations.html#cb73-4" tabindex="-1"></a><span class="do">##   Fair       5  6  7  4  5  4  3</span></span>
<span id="cb73-5"><a href="bivariate-visualizations.html#cb73-5" tabindex="-1"></a><span class="do">##   Good      18 23 11 16 17  7  7</span></span>
<span id="cb73-6"><a href="bivariate-visualizations.html#cb73-6" tabindex="-1"></a><span class="do">##   Very Good 26 37 46 40 33 25 13</span></span>
<span id="cb73-7"><a href="bivariate-visualizations.html#cb73-7" tabindex="-1"></a><span class="do">##   Premium   34 53 43 49 41 24 13</span></span>
<span id="cb73-8"><a href="bivariate-visualizations.html#cb73-8" tabindex="-1"></a><span class="do">##   Ideal     54 63 79 92 53 34 15</span></span></code></pre></div>
<p>There are 4 Fair diamonds with color D, and 21 Ideal quality diamonds with color J.</p>
</div>
<div id="two-way-proprtion-tables" class="section level4 hasAnchor" number="2.4.1.2">
<h4><span class="header-section-number">2.4.1.2</span> Two-way Proprtion tables<a href="bivariate-visualizations.html#two-way-proprtion-tables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Choose your percentages depending on your research question. What are you wanting to compare?</p>
<p>Best practices:</p>
<ul>
<li>Explanatory variable on the rows</li>
<li>Response variable on the columns</li>
<li>Calculate row %’s as the % of the response for each explanatory group.</li>
</ul>
<p>Here are demonstrations of how the interpretation of the percents change depending on what the denominator is.</p>
<p><strong>Cell proportions</strong></p>
<p>Wrapping <code>prop.table()</code> around a table gives you the <strong>cell</strong> proportions.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="bivariate-visualizations.html#cb74-1" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(dsmall<span class="sc">$</span>cut, dsmall<span class="sc">$</span>color))</span>
<span id="cb74-2"><a href="bivariate-visualizations.html#cb74-2" tabindex="-1"></a><span class="do">##            </span></span>
<span id="cb74-3"><a href="bivariate-visualizations.html#cb74-3" tabindex="-1"></a><span class="do">##                 D     E     F     G     H     I     J</span></span>
<span id="cb74-4"><a href="bivariate-visualizations.html#cb74-4" tabindex="-1"></a><span class="do">##   Fair      0.005 0.006 0.007 0.004 0.005 0.004 0.003</span></span>
<span id="cb74-5"><a href="bivariate-visualizations.html#cb74-5" tabindex="-1"></a><span class="do">##   Good      0.018 0.023 0.011 0.016 0.017 0.007 0.007</span></span>
<span id="cb74-6"><a href="bivariate-visualizations.html#cb74-6" tabindex="-1"></a><span class="do">##   Very Good 0.026 0.037 0.046 0.040 0.033 0.025 0.013</span></span>
<span id="cb74-7"><a href="bivariate-visualizations.html#cb74-7" tabindex="-1"></a><span class="do">##   Premium   0.034 0.053 0.043 0.049 0.041 0.024 0.013</span></span>
<span id="cb74-8"><a href="bivariate-visualizations.html#cb74-8" tabindex="-1"></a><span class="do">##   Ideal     0.054 0.063 0.079 0.092 0.053 0.034 0.015</span></span></code></pre></div>
<p>0.4% of all diamonds are D color and Fair cut, 2.1% are J color and Ideal cut.</p>
<p><strong>Row proportions</strong></p>
<p>To get the <strong>row</strong> proportions, you specify <code>margin=1</code>. The percentages now add up to 1 across the rows.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="bivariate-visualizations.html#cb75-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(dsmall<span class="sc">$</span>cut, dsmall<span class="sc">$</span>color), <span class="at">margin=</span><span class="dv">1</span>),<span class="dv">3</span>)</span>
<span id="cb75-2"><a href="bivariate-visualizations.html#cb75-2" tabindex="-1"></a><span class="do">##            </span></span>
<span id="cb75-3"><a href="bivariate-visualizations.html#cb75-3" tabindex="-1"></a><span class="do">##                 D     E     F     G     H     I     J</span></span>
<span id="cb75-4"><a href="bivariate-visualizations.html#cb75-4" tabindex="-1"></a><span class="do">##   Fair      0.147 0.176 0.206 0.118 0.147 0.118 0.088</span></span>
<span id="cb75-5"><a href="bivariate-visualizations.html#cb75-5" tabindex="-1"></a><span class="do">##   Good      0.182 0.232 0.111 0.162 0.172 0.071 0.071</span></span>
<span id="cb75-6"><a href="bivariate-visualizations.html#cb75-6" tabindex="-1"></a><span class="do">##   Very Good 0.118 0.168 0.209 0.182 0.150 0.114 0.059</span></span>
<span id="cb75-7"><a href="bivariate-visualizations.html#cb75-7" tabindex="-1"></a><span class="do">##   Premium   0.132 0.206 0.167 0.191 0.160 0.093 0.051</span></span>
<span id="cb75-8"><a href="bivariate-visualizations.html#cb75-8" tabindex="-1"></a><span class="do">##   Ideal     0.138 0.162 0.203 0.236 0.136 0.087 0.038</span></span></code></pre></div>
<p>14.8% of all Fair quality diamonds are color D. 5.4% of all Ideal quality diamonds have color J.</p>
<p><strong>Column proportions</strong></p>
<p>To get the <strong>column</strong> proportions, you specify <code>margin=2</code>. The percentages now add up to 1 down the columns.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="bivariate-visualizations.html#cb76-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(dsmall<span class="sc">$</span>cut, dsmall<span class="sc">$</span>color), <span class="at">margin=</span><span class="dv">2</span>),<span class="dv">3</span>)</span>
<span id="cb76-2"><a href="bivariate-visualizations.html#cb76-2" tabindex="-1"></a><span class="do">##            </span></span>
<span id="cb76-3"><a href="bivariate-visualizations.html#cb76-3" tabindex="-1"></a><span class="do">##                 D     E     F     G     H     I     J</span></span>
<span id="cb76-4"><a href="bivariate-visualizations.html#cb76-4" tabindex="-1"></a><span class="do">##   Fair      0.036 0.033 0.038 0.020 0.034 0.043 0.059</span></span>
<span id="cb76-5"><a href="bivariate-visualizations.html#cb76-5" tabindex="-1"></a><span class="do">##   Good      0.131 0.126 0.059 0.080 0.114 0.074 0.137</span></span>
<span id="cb76-6"><a href="bivariate-visualizations.html#cb76-6" tabindex="-1"></a><span class="do">##   Very Good 0.190 0.203 0.247 0.199 0.221 0.266 0.255</span></span>
<span id="cb76-7"><a href="bivariate-visualizations.html#cb76-7" tabindex="-1"></a><span class="do">##   Premium   0.248 0.291 0.231 0.244 0.275 0.255 0.255</span></span>
<span id="cb76-8"><a href="bivariate-visualizations.html#cb76-8" tabindex="-1"></a><span class="do">##   Ideal     0.394 0.346 0.425 0.458 0.356 0.362 0.294</span></span></code></pre></div>
<p>2.7% of all D color diamonds are of Fair quality. 44.7% of all J color diamonds are of Ideal quality.</p>
</div>
<div id="grouped-bar-charts" class="section level4 hasAnchor" number="2.4.1.3">
<h4><span class="header-section-number">2.4.1.3</span> Grouped bar charts<a href="bivariate-visualizations.html#grouped-bar-charts" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To compare proportions of one categorical variable within the same level of another, is to use grouped barcharts.</p>
<p><strong>base</strong>
As before, the object to be plotted needs to be the result of a table.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="bivariate-visualizations.html#cb77-1" tabindex="-1"></a>cc <span class="ot">&lt;-</span> <span class="fu">table</span>(dsmall<span class="sc">$</span>cut, dsmall<span class="sc">$</span>color)</span>
<span id="cb77-2"><a href="bivariate-visualizations.html#cb77-2" tabindex="-1"></a><span class="fu">barplot</span>(cc)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>Stacked bars can be difficult to interpret, and very difficult to compare values between groups. A side by side barchart is preferable.
The <code>beside=TRUE</code> is what controls the placement of the bars.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="bivariate-visualizations.html#cb78-1" tabindex="-1"></a><span class="fu">barplot</span>(cc, <span class="at">main=</span><span class="st">&quot;quick side by side barchart using base graphics&quot;</span>, <span class="at">beside=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p><strong>ggplot</strong>
Again plot the cut on the x axis, but then <code>fill</code> using the second categorical variable. This has the effect of visualizing the <strong>row</strong> percents from the table above. The percent of color, within each type of cut.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="bivariate-visualizations.html#cb79-1" tabindex="-1"></a><span class="fu">ggplot</span>(dsmall, <span class="fu">aes</span>(<span class="at">x=</span>cut, <span class="at">fill=</span>color)) <span class="sc">+</span> <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>Again the default is a stacked barchart. So we just specify <code>position=dodge</code> to put the bars side by side.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="bivariate-visualizations.html#cb80-1" tabindex="-1"></a><span class="fu">ggplot</span>(dsmall, <span class="fu">aes</span>(<span class="at">x=</span>cut, <span class="at">fill=</span>color)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>And look, an automatic legend. What if I wanted to better compare cut within color group? This is the <strong>column</strong> percentages. Just switch which variable is the x axis and which one is used to fill the colors!</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="bivariate-visualizations.html#cb81-1" tabindex="-1"></a><span class="fu">ggplot</span>(dsmall, <span class="fu">aes</span>(<span class="at">x=</span>color, <span class="at">fill=</span>cut)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>For more than 2 colors I do not recommend choosing the colors yourself. I know little about color theory so I use the built-in color palettes. Here is a <a href="https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/colorPaletteCheatsheet.pdf">great cheatsheet</a> about using color palettes.</p>
<p>And this easy change is why we love <code>ggplot2</code>.</p>
</div>
</div>
<div id="grouped-bar-charts-with-percentages" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Grouped bar charts with percentages<a href="bivariate-visualizations.html#grouped-bar-charts-with-percentages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Not as easy as one would hope, but the solution is to calculate the desired percentages first and then plot the summary data using either <code>geom_bar(stat='identity')</code> or <code>geom_col()</code>.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="bivariate-visualizations.html#cb82-1" tabindex="-1"></a>calc.props <span class="ot">&lt;-</span> diamonds <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(color, cut) <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="bivariate-visualizations.html#cb82-2" tabindex="-1"></a>              <span class="fu">summarise</span>(<span class="at">count=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="bivariate-visualizations.html#cb82-3" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">pct=</span><span class="fu">round</span>(count<span class="sc">/</span><span class="fu">sum</span>(count),<span class="dv">3</span>))</span>
<span id="cb82-4"><a href="bivariate-visualizations.html#cb82-4" tabindex="-1"></a>calc.props</span>
<span id="cb82-5"><a href="bivariate-visualizations.html#cb82-5" tabindex="-1"></a><span class="do">## # A tibble: 35 × 4</span></span>
<span id="cb82-6"><a href="bivariate-visualizations.html#cb82-6" tabindex="-1"></a><span class="do">## # Groups:   color [7]</span></span>
<span id="cb82-7"><a href="bivariate-visualizations.html#cb82-7" tabindex="-1"></a><span class="do">##    color cut       count   pct</span></span>
<span id="cb82-8"><a href="bivariate-visualizations.html#cb82-8" tabindex="-1"></a><span class="do">##    &lt;ord&gt; &lt;ord&gt;     &lt;int&gt; &lt;dbl&gt;</span></span>
<span id="cb82-9"><a href="bivariate-visualizations.html#cb82-9" tabindex="-1"></a><span class="do">##  1 D     Fair        163 0.024</span></span>
<span id="cb82-10"><a href="bivariate-visualizations.html#cb82-10" tabindex="-1"></a><span class="do">##  2 D     Good        662 0.098</span></span>
<span id="cb82-11"><a href="bivariate-visualizations.html#cb82-11" tabindex="-1"></a><span class="do">##  3 D     Very Good  1513 0.223</span></span>
<span id="cb82-12"><a href="bivariate-visualizations.html#cb82-12" tabindex="-1"></a><span class="do">##  4 D     Premium    1603 0.237</span></span>
<span id="cb82-13"><a href="bivariate-visualizations.html#cb82-13" tabindex="-1"></a><span class="do">##  5 D     Ideal      2834 0.418</span></span>
<span id="cb82-14"><a href="bivariate-visualizations.html#cb82-14" tabindex="-1"></a><span class="do">##  6 E     Fair        224 0.023</span></span>
<span id="cb82-15"><a href="bivariate-visualizations.html#cb82-15" tabindex="-1"></a><span class="do">##  7 E     Good        933 0.095</span></span>
<span id="cb82-16"><a href="bivariate-visualizations.html#cb82-16" tabindex="-1"></a><span class="do">##  8 E     Very Good  2400 0.245</span></span>
<span id="cb82-17"><a href="bivariate-visualizations.html#cb82-17" tabindex="-1"></a><span class="do">##  9 E     Premium    2337 0.239</span></span>
<span id="cb82-18"><a href="bivariate-visualizations.html#cb82-18" tabindex="-1"></a><span class="do">## 10 E     Ideal      3903 0.398</span></span>
<span id="cb82-19"><a href="bivariate-visualizations.html#cb82-19" tabindex="-1"></a><span class="do">## # … with 25 more rows</span></span></code></pre></div>
<p>Since we’re plotting summary data, the height of the bars is specified using <code>y=pct</code>.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="bivariate-visualizations.html#cb83-1" tabindex="-1"></a><span class="fu">ggplot</span>(calc.props, <span class="fu">aes</span>(<span class="at">x=</span>color, <span class="at">fill=</span>cut, <span class="at">y=</span>pct)) <span class="sc">+</span></span>
<span id="cb83-2"><a href="bivariate-visualizations.html#cb83-2" tabindex="-1"></a>                  <span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>Now set some options to the y axis using <code>scale_y_continuous()</code> to make the graph more accurate and readable. The <code>labels=percent</code> comes from the <code>scales</code> package.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="bivariate-visualizations.html#cb84-1" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb84-2"><a href="bivariate-visualizations.html#cb84-2" tabindex="-1"></a><span class="fu">ggplot</span>(calc.props, <span class="fu">aes</span>(<span class="at">x=</span>color, <span class="at">fill=</span>cut, <span class="at">y=</span>pct)) <span class="sc">+</span></span>
<span id="cb84-3"><a href="bivariate-visualizations.html#cb84-3" tabindex="-1"></a>                  <span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb84-4"><a href="bivariate-visualizations.html#cb84-4" tabindex="-1"></a>                  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels=</span>percent)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<div id="sjplot" class="section level4 hasAnchor" number="2.4.2.1">
<h4><span class="header-section-number">2.4.2.1</span> <code>sjPlot</code><a href="bivariate-visualizations.html#sjplot" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>sjPlot does a very nice job of being able to cleanly show not only n’s but percents.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="bivariate-visualizations.html#cb85-1" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb85-2"><a href="bivariate-visualizations.html#cb85-2" tabindex="-1"></a><span class="fu">plot_xtab</span>(dsmall<span class="sc">$</span>color, dsmall<span class="sc">$</span>cut, <span class="at">margin=</span><span class="st">&quot;row&quot;</span>, <span class="at">coord.flip =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
</div>
<div id="mosaic-plots" class="section level4 hasAnchor" number="2.4.2.2">
<h4><span class="header-section-number">2.4.2.2</span> Mosaic plots<a href="bivariate-visualizations.html#mosaic-plots" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>But what if you want to know how two categorical variables are related and you don’t want to look at two different barplots? Mosaic plots are a way to visualize the proportions in a table. So here’s the two-way table we’ll be plotting.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="bivariate-visualizations.html#cb86-1" tabindex="-1"></a><span class="fu">table</span>(dsmall<span class="sc">$</span>cut, dsmall<span class="sc">$</span>color)</span>
<span id="cb86-2"><a href="bivariate-visualizations.html#cb86-2" tabindex="-1"></a><span class="do">##            </span></span>
<span id="cb86-3"><a href="bivariate-visualizations.html#cb86-3" tabindex="-1"></a><span class="do">##              D  E  F  G  H  I  J</span></span>
<span id="cb86-4"><a href="bivariate-visualizations.html#cb86-4" tabindex="-1"></a><span class="do">##   Fair       5  6  7  4  5  4  3</span></span>
<span id="cb86-5"><a href="bivariate-visualizations.html#cb86-5" tabindex="-1"></a><span class="do">##   Good      18 23 11 16 17  7  7</span></span>
<span id="cb86-6"><a href="bivariate-visualizations.html#cb86-6" tabindex="-1"></a><span class="do">##   Very Good 26 37 46 40 33 25 13</span></span>
<span id="cb86-7"><a href="bivariate-visualizations.html#cb86-7" tabindex="-1"></a><span class="do">##   Premium   34 53 43 49 41 24 13</span></span>
<span id="cb86-8"><a href="bivariate-visualizations.html#cb86-8" tabindex="-1"></a><span class="do">##   Ideal     54 63 79 92 53 34 15</span></span></code></pre></div>
<p>The syntax for a mosaic plot uses <em>model notation</em>, which is basically y ~ x where the ~ is read as “twiddle” or “tilde”. It’s to the left of your <strong>1</strong> key.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="bivariate-visualizations.html#cb87-1" tabindex="-1"></a><span class="fu">mosaicplot</span>(cut<span class="sc">~</span>color, <span class="at">data=</span>dsmall)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>Helpful, ish. Here are two very useful options. In reverse obviousness, <code>color</code> applies shades of gray to one of the factor levels, and <code>shade</code> applies a color gradient scale to the cells in order of what is less than expected (red) to what is more than expected (blue) if these two factors were completely independent.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="bivariate-visualizations.html#cb88-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="co"># display the plots in 1 row and 2 columns</span></span>
<span id="cb88-2"><a href="bivariate-visualizations.html#cb88-2" tabindex="-1"></a><span class="fu">mosaicplot</span>(cut<span class="sc">~</span>color, <span class="at">data=</span>dsmall, <span class="at">color=</span><span class="cn">TRUE</span>)</span>
<span id="cb88-3"><a href="bivariate-visualizations.html#cb88-3" tabindex="-1"></a><span class="fu">mosaicplot</span>(cut<span class="sc">~</span>color, <span class="at">data=</span>dsmall, <span class="at">shade=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-47-1.png" width="960" /></p>
<p>For example, there are fewer ‘Very Good’ cut diamonds that are color ‘G’, and fewer ‘Premium’ cut diamonds that are color ‘H’. As you can see, knowing what your data means when trying to interpret what the plots are telling you is essential.</p>
<p>That’s about all the ways you can plot categorical variables.
If you are wondering why there was no 3D barcharts demonstrated see<br />
<a href="http://faculty.atu.edu/mfinan/2043/section31.pdf">here</a>,
<a href="http://www.bbc.co.uk/schools/gcsebitesize/maths/statistics/representingdata2rev5.shtml">here</a>, and
<a href="https://en.wikipedia.org/wiki/Misleading_graph">here</a> for other ways you can really screw up your visualization.</p>
</div>
</div>
<div id="continuous-v.-continuous" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Continuous v. Continuous<a href="bivariate-visualizations.html#continuous-v.-continuous" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="scatterplot" class="section level4 hasAnchor" number="2.4.3.1">
<h4><span class="header-section-number">2.4.3.1</span> Scatterplot<a href="bivariate-visualizations.html#scatterplot" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The most common method of visualizing the relationship between two continuous variables is by using a scatterplot.</p>
<p><strong>base</strong>
Back to the <code>plot()</code> command. Here we use model notation again, so it’s <span class="math inline">\(y~x\)</span>.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="bivariate-visualizations.html#cb89-1" tabindex="-1"></a><span class="fu">plot</span>(price<span class="sc">~</span>carat, <span class="at">data=</span>dsmall)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>Looks like for the most part as the carat value increases so does price. That makes sense.</p>
<p><strong>ggplot</strong>
With ggplot we specify both the x and y variables, and add a point.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="bivariate-visualizations.html#cb90-1" tabindex="-1"></a><span class="fu">ggplot</span>(dsmall, <span class="fu">aes</span>(<span class="at">x=</span>carat, <span class="at">y=</span>price)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<p><strong>Other Resources</strong></p>
<ul>
<li><a href="http://www.statmethods.net/graphs/scatterplot.html" class="uri">http://www.statmethods.net/graphs/scatterplot.html</a><br />
</li>
<li><a href="https://www.r-bloggers.com/scatterplot-matrices/" class="uri">https://www.r-bloggers.com/scatterplot-matrices/</a></li>
</ul>
</div>
<div id="adding-lines-to-the-scatterplots" class="section level4 hasAnchor" number="2.4.3.2">
<h4><span class="header-section-number">2.4.3.2</span> Adding lines to the scatterplots<a href="bivariate-visualizations.html#adding-lines-to-the-scatterplots" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Two most common trend lines added to a scatterplots are the “best fit” straight line and the “lowess” smoother line.</p>
<p><strong>base</strong>
The best fit line (in blue) gets added by using the <code>abline()</code> function wrapped around the linear model function <code>lm()</code>. Note it uses the same model notation syntax and the <code>data=</code> statement as the <code>plot()</code> function does. The lowess line is added using the <code>lines()</code> function, but the <code>lowess()</code> function itself doesn’t allow for the <code>data=</code> statement so we have to use <code>$</code> sign notation.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="bivariate-visualizations.html#cb91-1" tabindex="-1"></a><span class="fu">plot</span>(price<span class="sc">~</span>carat, <span class="at">data=</span>dsmall)</span>
<span id="cb91-2"><a href="bivariate-visualizations.html#cb91-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(price<span class="sc">~</span>carat, <span class="at">data=</span>dsmall), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb91-3"><a href="bivariate-visualizations.html#cb91-3" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(dsmall<span class="sc">$</span>price<span class="sc">~</span>dsmall<span class="sc">$</span>carat), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p><strong>ggplot</strong>
With ggplot, we just add a <code>geom_smooth()</code> layer.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="bivariate-visualizations.html#cb92-1" tabindex="-1"></a><span class="fu">ggplot</span>(dsmall, <span class="fu">aes</span>(<span class="at">x=</span>carat, <span class="at">y=</span>price)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>() </span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>Here the point-wise confidence interval for this lowess line is shown in grey. If you want to turn the confidence interval off, use <code>se=FALSE</code>. Also notice that the smoothing geom uses a different function or window than the <code>lowess</code> function used in base graphics.</p>
<p>Here it is again using the <code>ggplot</code> plotting function and adding another <code>geom_smooth()</code> layer for the <code>lm</code> (linear model) line in blue, and the lowess line (by not specifying a method) in red.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="bivariate-visualizations.html#cb93-1" tabindex="-1"></a><span class="fu">ggplot</span>(dsmall, <span class="fu">aes</span>(<span class="at">x=</span>carat, <span class="at">y=</span>price)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb93-2"><a href="bivariate-visualizations.html#cb93-2" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb93-3"><a href="bivariate-visualizations.html#cb93-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
</div>
<div id="line-plots" class="section level4 hasAnchor" number="2.4.3.3">
<h4><span class="header-section-number">2.4.3.3</span> Line plots<a href="bivariate-visualizations.html#line-plots" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Line plots connect each dot with a straight line. This is most often done when measuring trends of the response as the value of x increases (such as a time series)</p>
<p>We saw earlier that <code>carat</code> and <code>price</code> seemed possibly linear. Let see how the average price changes with carat.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="bivariate-visualizations.html#cb94-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb94-2"><a href="bivariate-visualizations.html#cb94-2" tabindex="-1"></a>price.per.carat <span class="ot">&lt;-</span> dsmall <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(carat) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(price))</span></code></pre></div>
<p><strong>base</strong>
For base graphics, type=‘b’ means both points and lines, ‘l’ gives you just lines and ‘p’ gives you only points. You can find more plotting character options under <code>?pch</code>.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="bivariate-visualizations.html#cb95-1" tabindex="-1"></a><span class="fu">plot</span>(mean<span class="sc">~</span>carat, <span class="at">data=</span>price.per.carat, <span class="at">type=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<p><strong>ggplot</strong>
With ggplot we specify that we want a line geometry only.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="bivariate-visualizations.html#cb96-1" tabindex="-1"></a><span class="fu">ggplot</span>(price.per.carat, <span class="fu">aes</span>(<span class="at">x=</span>carat, <span class="at">y=</span>mean)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<p>How does this relationship change with cut of the diamond? First lets
get the average price per combination of carat and cut.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="bivariate-visualizations.html#cb97-1" tabindex="-1"></a>ppc2 <span class="ot">&lt;-</span> dsmall <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cut, carat) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(price))</span></code></pre></div>
<p><strong>base</strong>
This plot can be created in base graphics, but it takes an advanced
knowledge of the graphics system to do so. So I do not show it here.</p>
<p><strong>ggplot</strong>
This is where ggplot starts to excel in it’s ease of creating more
complex plots. All we have to do is specify that we want the lines
colored by the cut variable.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="bivariate-visualizations.html#cb98-1" tabindex="-1"></a><span class="fu">ggplot</span>(ppc2, <span class="fu">aes</span>(<span class="at">x=</span>carat, <span class="at">y=</span>mean, <span class="at">col=</span>cut)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<p>And we get one line per cut.</p>
</div>
</div>
<div id="continuous-v.-categorical" class="section level3 hasAnchor" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> Continuous v. Categorical<a href="bivariate-visualizations.html#continuous-v.-categorical" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Create an appropriate plot for a continuous variable, and plot it for each
level of the categorical variable.</p>
<div id="dotplotstrip-chart" class="section level4 hasAnchor" number="2.4.4.1">
<h4><span class="header-section-number">2.4.4.1</span> Dotplot/strip chart<a href="bivariate-visualizations.html#dotplotstrip-chart" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Dotplots can be very useful when plotting dots against several categories. They can also be called stripcharts.</p>
<p><strong>base</strong></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="bivariate-visualizations.html#cb99-1" tabindex="-1"></a><span class="fu">stripchart</span>(carat <span class="sc">~</span> cut, <span class="at">data=</span>dsmall)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>Doesn’t look to pretty, but kinda gets the point across. Few fair quality diamonds in the data set, pretty spread out across the carat range except one high end outlier.</p>
<p><strong>ggplot</strong>
We can reproduce the same thing by plotting one continuous variable against one categorical variable, and adding a layer of points. I’d argue that horizontal looks better due to the axis-labels.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="bivariate-visualizations.html#cb100-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dsmall, <span class="fu">aes</span>(<span class="at">y=</span>carat, <span class="at">x=</span>cut)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb100-2"><a href="bivariate-visualizations.html#cb100-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dsmall, <span class="fu">aes</span>(<span class="at">y=</span>cut, <span class="at">x=</span>carat)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb100-3"><a href="bivariate-visualizations.html#cb100-3" tabindex="-1"></a><span class="fu">grid.arrange</span>(a, b, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
</div>
<div id="grouped-boxplots" class="section level4 hasAnchor" number="2.4.4.2">
<h4><span class="header-section-number">2.4.4.2</span> Grouped boxplots<a href="bivariate-visualizations.html#grouped-boxplots" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>base</strong>
Base graphics plots grouped boxplots with also just the addition of a twiddle (tilde) <code>~</code>.
Another example of where model notation works.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="bivariate-visualizations.html#cb101-1" tabindex="-1"></a><span class="fu">boxplot</span>(carat<span class="sc">~</span>color, <span class="at">data=</span>dsmall)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<p><strong>ggplot</strong>
A simple addition, just define your x and y accordingly.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="bivariate-visualizations.html#cb102-1" tabindex="-1"></a><span class="fu">ggplot</span>(dsmall, <span class="fu">aes</span>(<span class="at">x=</span>color, <span class="at">y=</span>carat, <span class="at">fill=</span>color)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<p><strong>Adding violins</strong>
Violin plots can be overlaid here as well.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="bivariate-visualizations.html#cb103-1" tabindex="-1"></a><span class="fu">ggplot</span>(dsmall, <span class="fu">aes</span>(<span class="at">x=</span>color, <span class="at">y=</span>carat, <span class="at">fill=</span>color)) <span class="sc">+</span></span>
<span id="cb103-2"><a href="bivariate-visualizations.html#cb103-2" tabindex="-1"></a>        <span class="fu">geom_violin</span>(<span class="at">alpha=</span>.<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb103-3"><a href="bivariate-visualizations.html#cb103-3" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span>.<span class="dv">5</span>, <span class="at">width=</span>.<span class="dv">2</span>)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
</div>
<div id="grouped-histograms" class="section level4 hasAnchor" number="2.4.4.3">
<h4><span class="header-section-number">2.4.4.3</span> Grouped histograms<a href="bivariate-visualizations.html#grouped-histograms" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>base</strong>
There is no easy way to create grouped histograms in base graphics we will skip it.</p>
<p><strong>ggplot</strong>
By default ggplot wants to overlay all plots on the same grid. This doesn’t look to good with histograms. Instead you can overlay density plots</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="bivariate-visualizations.html#cb104-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dsmall, <span class="fu">aes</span>(<span class="at">x=</span>carat, <span class="at">fill=</span>color)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span>
<span id="cb104-2"><a href="bivariate-visualizations.html#cb104-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dsmall, <span class="fu">aes</span>(<span class="at">x=</span>carat, <span class="at">fill=</span>color)) <span class="sc">+</span> <span class="fu">geom_density</span>() </span>
<span id="cb104-3"><a href="bivariate-visualizations.html#cb104-3" tabindex="-1"></a><span class="fu">grid.arrange</span>(a,b, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-63-1.png" width="960" /></p>
<p>The solid fills are still difficult to read, so we can either turn down the alpha (turn up the transparency) or only color the lines and not the fill.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="bivariate-visualizations.html#cb105-1" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dsmall, <span class="fu">aes</span>(<span class="at">x=</span>carat, <span class="at">fill=</span>color)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">alpha=</span>.<span class="dv">2</span>)</span>
<span id="cb105-2"><a href="bivariate-visualizations.html#cb105-2" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dsmall, <span class="fu">aes</span>(<span class="at">x=</span>carat, <span class="at">col=</span>color)) <span class="sc">+</span> <span class="fu">geom_density</span>() </span>
<span id="cb105-3"><a href="bivariate-visualizations.html#cb105-3" tabindex="-1"></a><span class="fu">grid.arrange</span>(c,d, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-64-1.png" width="960" /></p>
</div>
</div>
<div id="joy-plots-ridgelines" class="section level3 hasAnchor" number="2.4.5">
<h3><span class="header-section-number">2.4.5</span> Joy plots / Ridgelines<a href="bivariate-visualizations.html#joy-plots-ridgelines" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Somewhat new (2017), joylines have not been added to the base distribution of <code>ggplot2</code> yet. For now it’s available in the <code>ggjoy</code> package. Really good way to visualize density plots without the overlapping issue.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="bivariate-visualizations.html#cb106-1" tabindex="-1"></a><span class="fu">library</span>(ggjoy)</span>
<span id="cb106-2"><a href="bivariate-visualizations.html#cb106-2" tabindex="-1"></a><span class="fu">ggplot</span>(dsmall, <span class="fu">aes</span>(<span class="at">x=</span>carat, <span class="at">y=</span>color)) <span class="sc">+</span> <span class="fu">geom_joy</span>()</span></code></pre></div>
<p><img src="data_viz_files/figure-html/unnamed-chunk-65-1.png" width="960" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="univariate-visualizations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="faceting-paneling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
