<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10.1 Interactions (PMA6 8.8) | Applied Statistics</title>
  <meta name="description" content="Course notes for Applied Statistics courses at CSU Chico" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="10.1 Interactions (PMA6 8.8) | Applied Statistics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course notes for Applied Statistics courses at CSU Chico" />
  <meta name="github-repo" content="norcalbiostat/AppliedStatistics_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10.1 Interactions (PMA6 8.8) | Applied Statistics" />
  
  <meta name="twitter:description" content="Course notes for Applied Statistics courses at CSU Chico" />
  

<meta name="author" content="Robin Donatello, Edward Roualdes" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="model-building.html"/>
<link rel="next" href="general-F.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Statistics course notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Preparing Data for Analysis</b></span></li>
<li class="chapter" data-level="1" data-path="data_prep.html"><a href="data_prep.html"><i class="fa fa-check"></i><b>1</b> Workflow and Data Cleaning</a>
<ul>
<li class="chapter" data-level="1.1" data-path="reproducible-workflows.html"><a href="reproducible-workflows.html"><i class="fa fa-check"></i><b>1.1</b> Reproducible workflows</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="reproducible-workflows.html"><a href="reproducible-workflows.html#literate-programming"><i class="fa fa-check"></i><b>1.1.1</b> Literate programming</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="import-data.html"><a href="import-data.html"><i class="fa fa-check"></i><b>1.2</b> Import data</a></li>
<li class="chapter" data-level="1.3" data-path="data-management.html"><a href="data-management.html"><i class="fa fa-check"></i><b>1.3</b> Data Management</a></li>
<li class="chapter" data-level="1.4" data-path="renaming-variable-names-for-sanity-sake.html"><a href="renaming-variable-names-for-sanity-sake.html"><i class="fa fa-check"></i><b>1.4</b> Renaming variable names for sanity sake</a></li>
<li class="chapter" data-level="1.5" data-path="identifying-variable-types.html"><a href="identifying-variable-types.html"><i class="fa fa-check"></i><b>1.5</b> Identifying Variable Types</a></li>
<li class="chapter" data-level="1.6" data-path="convert-number-to-factor.html"><a href="convert-number-to-factor.html"><i class="fa fa-check"></i><b>1.6</b> Convert number to factor</a></li>
<li class="chapter" data-level="1.7" data-path="identifying-outliers.html"><a href="identifying-outliers.html"><i class="fa fa-check"></i><b>1.7</b> Identifying Outliers</a></li>
<li class="chapter" data-level="1.8" data-path="changing-numeric-values.html"><a href="changing-numeric-values.html"><i class="fa fa-check"></i><b>1.8</b> Changing numeric values</a></li>
<li class="chapter" data-level="1.9" data-path="creating-secondary-variables.html"><a href="creating-secondary-variables.html"><i class="fa fa-check"></i><b>1.9</b> Creating secondary variables</a></li>
<li class="chapter" data-level="1.10" data-path="wrangling-factors.html"><a href="wrangling-factors.html"><i class="fa fa-check"></i><b>1.10</b> Wrangling Factors</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="wrangling-factors.html"><a href="wrangling-factors.html#collapsing-categorical-variables-into-fewer-categories"><i class="fa fa-check"></i><b>1.10.1</b> Collapsing categorical variables into fewer categories</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="binning-a-continuous-variable-into-categorical-ranges..html"><a href="binning-a-continuous-variable-into-categorical-ranges..html"><i class="fa fa-check"></i><b>1.11</b> Binning a continuous variable into categorical ranges.</a></li>
<li class="chapter" data-level="1.12" data-path="dichotomizing-a-measure-into-2-categories.html"><a href="dichotomizing-a-measure-into-2-categories.html"><i class="fa fa-check"></i><b>1.12</b> Dichotomizing a measure into 2 categories</a></li>
<li class="chapter" data-level="1.13" data-path="sum-or-average-values-across-multiple-variables.html"><a href="sum-or-average-values-across-multiple-variables.html"><i class="fa fa-check"></i><b>1.13</b> Sum or Average values across multiple variables</a></li>
<li class="chapter" data-level="1.14" data-path="transformations-for-normality.html"><a href="transformations-for-normality.html"><i class="fa fa-check"></i><b>1.14</b> Transformations for Normality</a></li>
<li class="chapter" data-level="1.15" data-path="export-and-save.html"><a href="export-and-save.html"><i class="fa fa-check"></i><b>1.15</b> Export and Save</a></li>
<li class="chapter" data-level="1.16" data-path="wide-long.html"><a href="wide-long.html"><i class="fa fa-check"></i><b>1.16</b> Wide vs. Long data</a></li>
<li class="chapter" data-level="1.17" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>1.17</b> Missing data</a>
<ul>
<li class="chapter" data-level="1.17.1" data-path="missing-data.html"><a href="missing-data.html#identifying-missing-data"><i class="fa fa-check"></i><b>1.17.1</b> Identifying missing data</a></li>
<li class="chapter" data-level="1.17.2" data-path="missing-data.html"><a href="missing-data.html#model-predictions"><i class="fa fa-check"></i><b>1.17.2</b> Model predictions</a></li>
<li class="chapter" data-level="1.17.3" data-path="missing-data.html"><a href="missing-data.html#regression"><i class="fa fa-check"></i><b>1.17.3</b> Regression</a></li>
<li class="chapter" data-level="1.17.4" data-path="missing-data.html"><a href="missing-data.html#factor-analysis-and-principle-components"><i class="fa fa-check"></i><b>1.17.4</b> Factor Analysis and Principle Components</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data_viz.html"><a href="data_viz.html"><i class="fa fa-check"></i><b>2</b> Visualizing Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-syntax-of-ggplot.html"><a href="the-syntax-of-ggplot.html"><i class="fa fa-check"></i><b>2.1</b> The syntax of <code>ggplot</code></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="the-syntax-of-ggplot.html"><a href="the-syntax-of-ggplot.html#required-arguments"><i class="fa fa-check"></i><b>2.1.1</b> Required arguments</a></li>
<li class="chapter" data-level="2.1.2" data-path="the-syntax-of-ggplot.html"><a href="the-syntax-of-ggplot.html#optional-but-helpful-arguments"><i class="fa fa-check"></i><b>2.1.2</b> Optional but helpful arguments</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="the-data.html"><a href="the-data.html"><i class="fa fa-check"></i><b>2.2</b> The Data</a></li>
<li class="chapter" data-level="2.3" data-path="univariate-visualizations.html"><a href="univariate-visualizations.html"><i class="fa fa-check"></i><b>2.3</b> Univariate Visualizations</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="univariate-visualizations.html"><a href="univariate-visualizations.html#categorical-variables"><i class="fa fa-check"></i><b>2.3.1</b> Categorical variables</a></li>
<li class="chapter" data-level="2.3.2" data-path="univariate-visualizations.html"><a href="univariate-visualizations.html#continuous-measures"><i class="fa fa-check"></i><b>2.3.2</b> Continuous Measures</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html"><i class="fa fa-check"></i><b>2.4</b> Bivariate Visualizations</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#categorical-v.-categorical"><i class="fa fa-check"></i><b>2.4.1</b> Categorical v. Categorical</a></li>
<li class="chapter" data-level="2.4.2" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#grouped-bar-charts-with-percentages"><i class="fa fa-check"></i><b>2.4.2</b> Grouped bar charts with percentages</a></li>
<li class="chapter" data-level="2.4.3" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#continuous-v.-continuous"><i class="fa fa-check"></i><b>2.4.3</b> Continuous v. Continuous</a></li>
<li class="chapter" data-level="2.4.4" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#continuous-v.-categorical"><i class="fa fa-check"></i><b>2.4.4</b> Continuous v. Categorical</a></li>
<li class="chapter" data-level="2.4.5" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#joy-plots-ridgelines"><i class="fa fa-check"></i><b>2.4.5</b> Joy plots / Ridgelines</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="faceting-paneling.html"><a href="faceting-paneling.html"><i class="fa fa-check"></i><b>2.5</b> Faceting / paneling</a></li>
<li class="chapter" data-level="2.6" data-path="multiple-plots-per-window.html"><a href="multiple-plots-per-window.html"><i class="fa fa-check"></i><b>2.6</b> Multiple plots per window</a></li>
<li class="chapter" data-level="2.7" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html"><i class="fa fa-check"></i><b>2.7</b> Multivariate (3+ variables)</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html#three-continuous"><i class="fa fa-check"></i><b>2.7.1</b> Three continuous</a></li>
<li class="chapter" data-level="2.7.2" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html#scatterplot-matrix"><i class="fa fa-check"></i><b>2.7.2</b> Scatterplot matrix</a></li>
<li class="chapter" data-level="2.7.3" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html#two-categorical-and-one-continuous"><i class="fa fa-check"></i><b>2.7.3</b> Two categorical and one continuous</a></li>
<li class="chapter" data-level="2.7.4" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html#two-continuous-and-one-categorical"><i class="fa fa-check"></i><b>2.7.4</b> Two continuous and one categorical</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="paneling-on-two-variables.html"><a href="paneling-on-two-variables.html"><i class="fa fa-check"></i><b>2.8</b> Paneling on two variables</a></li>
<li class="chapter" data-level="2.9" data-path="troubleshooting.html"><a href="troubleshooting.html"><i class="fa fa-check"></i><b>2.9</b> Troubleshooting</a></li>
<li class="chapter" data-level="2.10" data-path="but-what-about.html"><a href="but-what-about.html"><i class="fa fa-check"></i><b>2.10</b> But what about…</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="but-what-about.html"><a href="but-what-about.html#other-plots-not-mentioned"><i class="fa fa-check"></i><b>2.10.1</b> Other plots not mentioned</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>2.11</b> Additional Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="select_analysis.html"><a href="select_analysis.html"><i class="fa fa-check"></i><b>3</b> Selecting Appropriate Analyses</a></li>
<li class="part"><span><b>II Statistical Inference</b></span></li>
<li class="chapter" data-level="4" data-path="bv-intro.html"><a href="bv-intro.html"><i class="fa fa-check"></i><b>4</b> Foundations for Inference</a></li>
<li class="chapter" data-level="5" data-path="bivariate-analysis.html"><a href="bivariate-analysis.html"><i class="fa fa-check"></i><b>5</b> Bivariate Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="assumption-of-independent-observations.html"><a href="assumption-of-independent-observations.html"><i class="fa fa-check"></i><b>5.1</b> Assumption of Independent Observations</a></li>
<li class="chapter" data-level="5.2" data-path="choosing-appropriate-bivariate-analysis.html"><a href="choosing-appropriate-bivariate-analysis.html"><i class="fa fa-check"></i><b>5.2</b> Choosing appropriate bivariate analysis</a></li>
<li class="chapter" data-level="5.3" data-path="bv-ttest.html"><a href="bv-ttest.html"><i class="fa fa-check"></i><b>5.3</b> (Q~B) Two means: T-Test</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bv-ttest.html"><a href="bv-ttest.html#assumptions"><i class="fa fa-check"></i><b>5.3.1</b> Assumptions</a></li>
<li class="chapter" data-level="5.3.2" data-path="bv-ttest.html"><a href="bv-ttest.html#sampling-distribution-for-the-difference"><i class="fa fa-check"></i><b>5.3.2</b> Sampling Distribution for the difference</a></li>
<li class="chapter" data-level="5.3.3" data-path="bv-ttest.html"><a href="bv-ttest.html#example-smoking-and-bmi"><i class="fa fa-check"></i><b>5.3.3</b> Example: Smoking and BMI</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bv-anova.html"><a href="bv-anova.html"><i class="fa fa-check"></i><b>5.4</b> (Q~C) Multiple means: ANOVA</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="bv-anova.html"><a href="bv-anova.html#terminology"><i class="fa fa-check"></i><b>5.4.1</b> Terminology</a></li>
<li class="chapter" data-level="5.4.2" data-path="bv-anova.html"><a href="bv-anova.html#formulation-of-the-one-way-anova-model"><i class="fa fa-check"></i><b>5.4.2</b> Formulation of the One-way ANOVA model</a></li>
<li class="chapter" data-level="5.4.3" data-path="bv-anova.html"><a href="bv-anova.html#analysis-of-variance-table"><i class="fa fa-check"></i><b>5.4.3</b> Analysis of Variance Table*:</a></li>
<li class="chapter" data-level="5.4.4" data-path="bv-anova.html"><a href="bv-anova.html#the-f-distribution"><i class="fa fa-check"></i><b>5.4.4</b> The F-distribution</a></li>
<li class="chapter" data-level="5.4.5" data-path="bv-anova.html"><a href="bv-anova.html#assumptions-1"><i class="fa fa-check"></i><b>5.4.5</b> Assumptions</a></li>
<li class="chapter" data-level="5.4.6" data-path="bv-anova.html"><a href="bv-anova.html#example-a-comparison-of-plant-species-under-low-water-conditions"><i class="fa fa-check"></i><b>5.4.6</b> Example: A comparison of plant species under low water conditions</a></li>
<li class="chapter" data-level="5.4.7" data-path="bv-anova.html"><a href="bv-anova.html#coefficient-of-determination-r2"><i class="fa fa-check"></i><b>5.4.7</b> Coefficient of determination <span class="math inline">\(R^{2}\)</span></a></li>
<li class="chapter" data-level="5.4.8" data-path="bv-anova.html"><a href="bv-anova.html#multiple-comparisons"><i class="fa fa-check"></i><b>5.4.8</b> Multiple Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="bv-chisq.html"><a href="bv-chisq.html"><i class="fa fa-check"></i><b>5.5</b> (C~C) Multiple Proportions: <span class="math inline">\(\chi^{2}\)</span></a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="bv-chisq.html"><a href="bv-chisq.html#conditions-for-the-sampling-distribution-to-be-normal."><i class="fa fa-check"></i><b>5.5.1</b> Conditions for the sampling distribution to be normal.</a></li>
<li class="chapter" data-level="5.5.2" data-path="bv-chisq.html"><a href="bv-chisq.html#example-are-mammograms-effective"><i class="fa fa-check"></i><b>5.5.2</b> Example: Are Mammograms effective?</a></li>
<li class="chapter" data-level="5.5.3" data-path="bv-chisq.html"><a href="bv-chisq.html#example-smoking-and-general-health"><i class="fa fa-check"></i><b>5.5.3</b> Example: Smoking and General Health</a></li>
<li class="chapter" data-level="5.5.4" data-path="bv-chisq.html"><a href="bv-chisq.html#multiple-comparisons-1"><i class="fa fa-check"></i><b>5.5.4</b> Multiple Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="bv-corr.html"><a href="bv-corr.html"><i class="fa fa-check"></i><b>5.6</b> (Q~Q) Correlation</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="bv-corr.html"><a href="bv-corr.html#strength-of-the-correlation"><i class="fa fa-check"></i><b>5.6.1</b> Strength of the correlation</a></li>
<li class="chapter" data-level="5.6.2" data-path="bv-corr.html"><a href="bv-corr.html#example-federal-spending-per-capita-and-poverty-rate"><i class="fa fa-check"></i><b>5.6.2</b> Example: Federal spending per capita and poverty rate</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Regression Modeling</b></span></li>
<li class="chapter" data-level="6" data-path="reg-intro.html"><a href="reg-intro.html"><i class="fa fa-check"></i><b>6</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1" data-path="opening-remarks.html"><a href="opening-remarks.html"><i class="fa fa-check"></i><b>6.1</b> Opening Remarks</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="slr.html"><a href="slr.html"><i class="fa fa-check"></i><b>7</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="example.html"><a href="example.html"><i class="fa fa-check"></i><b>7.1</b> Example</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="example.html"><a href="example.html#caution-on-out-of-range-predictions"><i class="fa fa-check"></i><b>7.1.1</b> Caution on out of range predictions</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="mathematical-model.html"><a href="mathematical-model.html"><i class="fa fa-check"></i><b>7.2</b> Mathematical Model</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="mathematical-model.html"><a href="mathematical-model.html#unifying-model-framework"><i class="fa fa-check"></i><b>7.2.1</b> Unifying model framework</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="parameter-estimates.html"><a href="parameter-estimates.html"><i class="fa fa-check"></i><b>7.3</b> Parameter Estimates</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="parameter-estimates.html"><a href="parameter-estimates.html#sum-of-squares"><i class="fa fa-check"></i><b>7.3.1</b> Sum of Squares</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="assumptions-2.html"><a href="assumptions-2.html"><i class="fa fa-check"></i><b>7.4</b> Assumptions</a></li>
<li class="chapter" data-level="7.5" data-path="slr-fev.html"><a href="slr-fev.html"><i class="fa fa-check"></i><b>7.5</b> Example</a></li>
<li class="chapter" data-level="7.6" data-path="model-diagnostics.html"><a href="model-diagnostics.html"><i class="fa fa-check"></i><b>7.6</b> Model Diagnostics</a></li>
<li class="chapter" data-level="7.7" data-path="prediction.html"><a href="prediction.html"><i class="fa fa-check"></i><b>7.7</b> Prediction</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="prediction.html"><a href="prediction.html#predict-the-average-value-of-y-haty-based-on-the-model"><i class="fa fa-check"></i><b>7.7.1</b> Predict the <em>average</em> value of Y (<span class="math inline">\(\hat{y}\)</span>) based on the model</a></li>
<li class="chapter" data-level="7.7.2" data-path="prediction.html"><a href="prediction.html#confidence-intervals-for-the-predicted-mean"><i class="fa fa-check"></i><b>7.7.2</b> Confidence intervals for the predicted mean</a></li>
<li class="chapter" data-level="7.7.3" data-path="prediction.html"><a href="prediction.html#predict-the-average-value-of-y-haty_i-for-a-certain-value-of-x"><i class="fa fa-check"></i><b>7.7.3</b> Predict the <em>average</em> value of Y <span class="math inline">\((\hat{y_{i}})\)</span> for a certain value of <span class="math inline">\(x^{*}\)</span></a></li>
<li class="chapter" data-level="7.7.4" data-path="prediction.html"><a href="prediction.html#predict-a-new-value-of-y-haty_i-for-a-certain-value-of-x"><i class="fa fa-check"></i><b>7.7.4</b> Predict a <em>new</em> value of Y <span class="math inline">\(\hat{y_{i}}\)</span> for a certain value of <span class="math inline">\(x^{*}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="anova-for-regression.html"><a href="anova-for-regression.html"><i class="fa fa-check"></i><b>7.8</b> ANOVA for regression</a></li>
<li class="chapter" data-level="7.9" data-path="correlation-coefficient.html"><a href="correlation-coefficient.html"><i class="fa fa-check"></i><b>7.9</b> Correlation Coefficient</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mod-strat.html"><a href="mod-strat.html"><i class="fa fa-check"></i><b>8</b> Moderation and Stratification</a>
<ul>
<li class="chapter" data-level="8.1" data-path="moderation.html"><a href="moderation.html"><i class="fa fa-check"></i><b>8.1</b> Moderation</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="moderation.html"><a href="moderation.html#motivating-example---admissions-at-uc-berkeley"><i class="fa fa-check"></i><b>8.1.1</b> Motivating Example - Admissions at UC Berkeley</a></li>
<li class="chapter" data-level="8.1.2" data-path="moderation.html"><a href="moderation.html#motivating-example-association-of-flower-parts"><i class="fa fa-check"></i><b>8.1.2</b> Motivating Example: Association of flower parts</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="stratification.html"><a href="stratification.html"><i class="fa fa-check"></i><b>8.2</b> Stratification</a></li>
<li class="chapter" data-level="8.3" data-path="identifying-a-moderator.html"><a href="identifying-a-moderator.html"><i class="fa fa-check"></i><b>8.3</b> Identifying a moderator</a></li>
<li class="chapter" data-level="8.4" data-path="what-to-look-for-in-each-type-of-analysis.html"><a href="what-to-look-for-in-each-type-of-analysis.html"><i class="fa fa-check"></i><b>8.4</b> What to look for in each type of analysis</a></li>
<li class="chapter" data-level="8.5" data-path="ex-correlation.html"><a href="ex-correlation.html"><i class="fa fa-check"></i><b>8.5</b> Ex: Correlation</a></li>
<li class="chapter" data-level="8.6" data-path="ex-regression.html"><a href="ex-regression.html"><i class="fa fa-check"></i><b>8.6</b> Ex: Regression</a></li>
<li class="chapter" data-level="8.7" data-path="ex-anova.html"><a href="ex-anova.html"><i class="fa fa-check"></i><b>8.7</b> Ex: ANOVA</a></li>
<li class="chapter" data-level="8.8" data-path="ex-4-chi-squared.html"><a href="ex-4-chi-squared.html"><i class="fa fa-check"></i><b>8.8</b> Ex: 4 Chi-Squared</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mlr.html"><a href="mlr.html"><i class="fa fa-check"></i><b>9</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mathematical-model-1.html"><a href="mathematical-model-1.html"><i class="fa fa-check"></i><b>9.1</b> Mathematical Model</a></li>
<li class="chapter" data-level="9.2" data-path="parameter-estimation.html"><a href="parameter-estimation.html"><i class="fa fa-check"></i><b>9.2</b> Parameter Estimation</a></li>
<li class="chapter" data-level="9.3" data-path="fitting-the-model.html"><a href="fitting-the-model.html"><i class="fa fa-check"></i><b>9.3</b> Fitting the model</a></li>
<li class="chapter" data-level="9.4" data-path="interpreting-coefficients.html"><a href="interpreting-coefficients.html"><i class="fa fa-check"></i><b>9.4</b> Interpreting Coefficients</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="interpreting-coefficients.html"><a href="interpreting-coefficients.html#continuous-predictors"><i class="fa fa-check"></i><b>9.4.1</b> Continuous predictors</a></li>
<li class="chapter" data-level="9.4.2" data-path="interpreting-coefficients.html"><a href="interpreting-coefficients.html#binary-predictors"><i class="fa fa-check"></i><b>9.4.2</b> Binary predictors</a></li>
<li class="chapter" data-level="9.4.3" data-path="interpreting-coefficients.html"><a href="interpreting-coefficients.html#cat-predictors"><i class="fa fa-check"></i><b>9.4.3</b> Categorical Predictors</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="presenting-results.html"><a href="presenting-results.html"><i class="fa fa-check"></i><b>9.5</b> Presenting results</a></li>
<li class="chapter" data-level="9.6" data-path="confounding.html"><a href="confounding.html"><i class="fa fa-check"></i><b>9.6</b> Confounding</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="confounding.html"><a href="confounding.html#example-does-smoking-affect-pulse-rate"><i class="fa fa-check"></i><b>9.6.1</b> Example: Does smoking affect pulse rate?</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="what-to-watch-out-for.html"><a href="what-to-watch-out-for.html"><i class="fa fa-check"></i><b>9.7</b> What to watch out for</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-building.html"><a href="model-building.html"><i class="fa fa-check"></i><b>10</b> Model Building</a>
<ul>
<li class="chapter" data-level="10.1" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>10.1</b> Interactions (PMA6 8.8)</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="interactions.html"><a href="interactions.html#fitting-interaction-models-interpreting-coefficients"><i class="fa fa-check"></i><b>10.1.1</b> Fitting interaction models &amp; interpreting coefficients</a></li>
<li class="chapter" data-level="10.1.2" data-path="interactions.html"><a href="interactions.html#interactions-catvars"><i class="fa fa-check"></i><b>10.1.2</b> Categorical Interaction variables</a></li>
<li class="chapter" data-level="10.1.3" data-path="interactions.html"><a href="interactions.html#example-2"><i class="fa fa-check"></i><b>10.1.3</b> Example 2</a></li>
<li class="chapter" data-level="10.1.4" data-path="interactions.html"><a href="interactions.html#example-3"><i class="fa fa-check"></i><b>10.1.4</b> Example 3:</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="general-F.html"><a href="general-F.html"><i class="fa fa-check"></i><b>10.2</b> Simultaneous test of multiple variables (PMA6 9.5)</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="general-F.html"><a href="general-F.html#example-modeling-depression-score"><i class="fa fa-check"></i><b>10.2.1</b> Example: Modeling depression score</a></li>
<li class="chapter" data-level="10.2.2" data-path="general-F.html"><a href="general-F.html#testing-for-a-moderation-effect-in-a-multiple-regression-model."><i class="fa fa-check"></i><b>10.2.2</b> Testing for a moderation effect in a multiple regression model.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="multicollinearity-pma6-8.html"><a href="multicollinearity-pma6-8.html"><i class="fa fa-check"></i><b>10.3</b> Multicollinearity (PMA6 8.9)</a></li>
<li class="chapter" data-level="10.4" data-path="variable-selection-process.html"><a href="variable-selection-process.html"><i class="fa fa-check"></i><b>10.4</b> Variable Selection Process</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="variable-selection-process.html"><a href="variable-selection-process.html#automated-selection-procedures-pma6-9.6"><i class="fa fa-check"></i><b>10.4.1</b> Automated selection procedures (PMA6 9.6)</a></li>
<li class="chapter" data-level="10.4.2" data-path="variable-selection-process.html"><a href="variable-selection-process.html#lasso-regression-pma6-9.7"><i class="fa fa-check"></i><b>10.4.2</b> LASSO Regression (PMA6 9.7)</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html"><i class="fa fa-check"></i><b>10.5</b> Comparing between models (PMA6 9.4)</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#rss-residual-sum-of-squares"><i class="fa fa-check"></i><b>10.5.1</b> RSS: Residual Sum of Squares</a></li>
<li class="chapter" data-level="10.5.2" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#general-f-test"><i class="fa fa-check"></i><b>10.5.2</b> General F Test</a></li>
<li class="chapter" data-level="10.5.3" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#likelihood-function"><i class="fa fa-check"></i><b>10.5.3</b> Likelihood function</a></li>
<li class="chapter" data-level="10.5.4" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#multiple-r2"><i class="fa fa-check"></i><b>10.5.4</b> Multiple <span class="math inline">\(R^{2}\)</span></a></li>
<li class="chapter" data-level="10.5.5" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#adjusted-r2"><i class="fa fa-check"></i><b>10.5.5</b> Adjusted <span class="math inline">\(R^{2}\)</span></a></li>
<li class="chapter" data-level="10.5.6" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#mallows-c_p"><i class="fa fa-check"></i><b>10.5.6</b> Mallows <span class="math inline">\(C_{p}\)</span></a></li>
<li class="chapter" data-level="10.5.7" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#akaike-information-criterion-aic"><i class="fa fa-check"></i><b>10.5.7</b> Akaike Information Criterion (AIC)</a></li>
<li class="chapter" data-level="10.5.8" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#bayesian-information-criterion-bic"><i class="fa fa-check"></i><b>10.5.8</b> Bayesian Information Criterion (BIC)</a></li>
<li class="chapter" data-level="10.5.9" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#aic-vs-bic"><i class="fa fa-check"></i><b>10.5.9</b> AIC vs BIC</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html"><i class="fa fa-check"></i><b>10.6</b> Model Diagnostics</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html#linearity"><i class="fa fa-check"></i><b>10.6.1</b> Linearity</a></li>
<li class="chapter" data-level="10.6.2" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html#normality-of-residuals."><i class="fa fa-check"></i><b>10.6.2</b> Normality of residuals.</a></li>
<li class="chapter" data-level="10.6.3" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html#homogeneity-of-variance"><i class="fa fa-check"></i><b>10.6.3</b> Homogeneity of variance</a></li>
<li class="chapter" data-level="10.6.4" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html#posterior-predictions"><i class="fa fa-check"></i><b>10.6.4</b> Posterior Predictions</a></li>
<li class="chapter" data-level="10.6.5" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html#all-at-once"><i class="fa fa-check"></i><b>10.6.5</b> All at once</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="general-advice-pma6-9.html"><a href="general-advice-pma6-9.html"><i class="fa fa-check"></i><b>10.7</b> General Advice (PMA6 9.9)</a></li>
<li class="chapter" data-level="10.8" data-path="what-to-watch-out-for-pma6-9.html"><a href="what-to-watch-out-for-pma6-9.html"><i class="fa fa-check"></i><b>10.8</b> What to watch out for (PMA6 9.10)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>11</b> Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="fitting-glms.html"><a href="fitting-glms.html"><i class="fa fa-check"></i><b>11.1</b> Fitting GLMs</a></li>
<li class="chapter" data-level="11.2" data-path="log-linear.html"><a href="log-linear.html"><i class="fa fa-check"></i><b>11.2</b> Log-linear models</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="log-linear.html"><a href="log-linear.html#example-4"><i class="fa fa-check"></i><b>11.2.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="binary-outcome-data.html"><a href="binary-outcome-data.html"><i class="fa fa-check"></i><b>11.3</b> Binary outcome data</a></li>
<li class="chapter" data-level="11.4" data-path="logreg.html"><a href="logreg.html"><i class="fa fa-check"></i><b>11.4</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="logreg.html"><a href="logreg.html#interpreting-odds-ratios"><i class="fa fa-check"></i><b>11.4.1</b> Interpreting Odds Ratios</a></li>
<li class="chapter" data-level="11.4.2" data-path="logreg.html"><a href="logreg.html#or-ci"><i class="fa fa-check"></i><b>11.4.2</b> Confidence Intervals</a></li>
<li class="chapter" data-level="11.4.3" data-path="logreg.html"><a href="logreg.html#logreg-dep-ex"><i class="fa fa-check"></i><b>11.4.3</b> Example: The effect of gender on Depression</a></li>
<li class="chapter" data-level="11.4.4" data-path="logreg.html"><a href="logreg.html#mlogreg"><i class="fa fa-check"></i><b>11.4.4</b> Multiple Logistic Regression</a></li>
<li class="chapter" data-level="11.4.5" data-path="logreg.html"><a href="logreg.html#effect-of-a-k-unit-change"><i class="fa fa-check"></i><b>11.4.5</b> Effect of a k unit change</a></li>
<li class="chapter" data-level="11.4.6" data-path="logreg.html"><a href="logreg.html#example-predictors-of-smoking-status"><i class="fa fa-check"></i><b>11.4.6</b> Example: Predictors of smoking status</a></li>
<li class="chapter" data-level="11.4.7" data-path="logreg.html"><a href="logreg.html#model-fit"><i class="fa fa-check"></i><b>11.4.7</b> Model Fit</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="poisson-reg.html"><a href="poisson-reg.html"><i class="fa fa-check"></i><b>11.5</b> Count outcome data</a></li>
<li class="chapter" data-level="11.6" data-path="multinomial-reg.html"><a href="multinomial-reg.html"><i class="fa fa-check"></i><b>11.6</b> Categorical outcome data</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="binary-classification.html"><a href="binary-classification.html"><i class="fa fa-check"></i><b>12</b> Classification of Binary outcomes</a>
<ul>
<li class="chapter" data-level="12.1" data-path="predicted-probabilities.html"><a href="predicted-probabilities.html"><i class="fa fa-check"></i><b>12.1</b> Predicted Probabilities</a></li>
<li class="chapter" data-level="12.2" data-path="distribution-of-predicted-probabilities.html"><a href="distribution-of-predicted-probabilities.html"><i class="fa fa-check"></i><b>12.2</b> Distribution of Predicted probabilities</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="distribution-of-predicted-probabilities.html"><a href="distribution-of-predicted-probabilities.html#plotting-predictions-against-covariates"><i class="fa fa-check"></i><b>12.2.1</b> Plotting predictions against covariates</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="predicted-class-outcome.html"><a href="predicted-class-outcome.html"><i class="fa fa-check"></i><b>12.3</b> Predicted Class (outcome)</a></li>
<li class="chapter" data-level="12.4" data-path="confusion-matrix.html"><a href="confusion-matrix.html"><i class="fa fa-check"></i><b>12.4</b> Confusion Matrix</a></li>
<li class="chapter" data-level="12.5" data-path="vocabulary-terms.html"><a href="vocabulary-terms.html"><i class="fa fa-check"></i><b>12.5</b> Vocabulary terms</a></li>
<li class="chapter" data-level="12.6" data-path="roc-curves.html"><a href="roc-curves.html"><i class="fa fa-check"></i><b>12.6</b> ROC Curves</a></li>
<li class="chapter" data-level="12.7" data-path="model-performance.html"><a href="model-performance.html"><i class="fa fa-check"></i><b>12.7</b> Model Performance</a></li>
</ul></li>
<li class="part"><span><b>IV Multivariate Analysis</b></span></li>
<li class="chapter" data-level="13" data-path="mv-intro.html"><a href="mv-intro.html"><i class="fa fa-check"></i><b>13</b> Introduction</a></li>
<li class="chapter" data-level="14" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>14</b> Principal Component Analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="when-is-principal-components-analysis-pca-used.html"><a href="when-is-principal-components-analysis-pca-used.html"><i class="fa fa-check"></i><b>14.1</b> When is Principal Components Analysis (PCA) used?</a></li>
<li class="chapter" data-level="14.2" data-path="basic-idea.html"><a href="basic-idea.html"><i class="fa fa-check"></i><b>14.2</b> Basic Idea - change of coordinates</a></li>
<li class="chapter" data-level="14.3" data-path="more-generally.html"><a href="more-generally.html"><i class="fa fa-check"></i><b>14.3</b> More Generally</a></li>
<li class="chapter" data-level="14.4" data-path="r-commands.html"><a href="r-commands.html"><i class="fa fa-check"></i><b>14.4</b> R commands</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="r-commands.html"><a href="r-commands.html#generating-pcs"><i class="fa fa-check"></i><b>14.4.1</b> Generating PC’s</a></li>
<li class="chapter" data-level="14.4.2" data-path="r-commands.html"><a href="r-commands.html#viewing-the-amount-of-variance-contained-by-each-pc"><i class="fa fa-check"></i><b>14.4.2</b> Viewing the amount of variance contained by each PC</a></li>
<li class="chapter" data-level="14.4.3" data-path="r-commands.html"><a href="r-commands.html#vizualize-loadings"><i class="fa fa-check"></i><b>14.4.3</b> Vizualize Loadings</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="data-reduction.html"><a href="data-reduction.html"><i class="fa fa-check"></i><b>14.5</b> Data Reduction</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="data-reduction.html"><a href="data-reduction.html#choosing-m"><i class="fa fa-check"></i><b>14.5.1</b> Choosing <span class="math inline">\(m\)</span></a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="standardizing.html"><a href="standardizing.html"><i class="fa fa-check"></i><b>14.6</b> Standardizing</a></li>
<li class="chapter" data-level="14.7" data-path="example-5.html"><a href="example-5.html"><i class="fa fa-check"></i><b>14.7</b> Example</a></li>
<li class="chapter" data-level="14.8" data-path="use-in-multiple-regression.html"><a href="use-in-multiple-regression.html"><i class="fa fa-check"></i><b>14.8</b> Use in Multiple Regression</a>
<ul>
<li class="chapter" data-level="14.8.1" data-path="use-in-multiple-regression.html"><a href="use-in-multiple-regression.html#example-modeling-acute-illness"><i class="fa fa-check"></i><b>14.8.1</b> Example: Modeling acute illness</a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="things-to-watch-out-for.html"><a href="things-to-watch-out-for.html"><i class="fa fa-check"></i><b>14.9</b> Things to watch out for</a></li>
<li class="chapter" data-level="14.10" data-path="additional-references.html"><a href="additional-references.html"><i class="fa fa-check"></i><b>14.10</b> Additional References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="fa.html"><a href="fa.html"><i class="fa fa-check"></i><b>15</b> Factor Analysis</a>
<ul>
<li class="chapter" data-level="15.1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>15.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="introduction.html"><a href="introduction.html#latent-constructs"><i class="fa fa-check"></i><b>15.1.1</b> Latent Constructs</a></li>
<li class="chapter" data-level="15.1.2" data-path="introduction.html"><a href="introduction.html#comparison-with-pca"><i class="fa fa-check"></i><b>15.1.2</b> Comparison with PCA</a></li>
<li class="chapter" data-level="15.1.3" data-path="introduction.html"><a href="introduction.html#efa-vs-cfa"><i class="fa fa-check"></i><b>15.1.3</b> EFA vs CFA</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="factor-model.html"><a href="factor-model.html"><i class="fa fa-check"></i><b>15.2</b> Factor Model</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="factor-model.html"><a href="factor-model.html#components-of-variance"><i class="fa fa-check"></i><b>15.2.1</b> Components of Variance</a></li>
<li class="chapter" data-level="15.2.2" data-path="factor-model.html"><a href="factor-model.html#two-big-steps"><i class="fa fa-check"></i><b>15.2.2</b> Two big steps</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="fa-example.html"><a href="fa-example.html"><i class="fa fa-check"></i><b>15.3</b> Example data setup</a></li>
<li class="chapter" data-level="15.4" data-path="fa-extract.html"><a href="fa-extract.html"><i class="fa fa-check"></i><b>15.4</b> Factor Extraction Methods</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="fa-extract.html"><a href="fa-extract.html#principal-components-pc-factor-model"><i class="fa fa-check"></i><b>15.4.1</b> Principal components (PC Factor model)</a></li>
<li class="chapter" data-level="15.4.2" data-path="fa-extract.html"><a href="fa-extract.html#iterated-components"><i class="fa fa-check"></i><b>15.4.2</b> Iterated components</a></li>
<li class="chapter" data-level="15.4.3" data-path="fa-extract.html"><a href="fa-extract.html#maximum-likelihood"><i class="fa fa-check"></i><b>15.4.3</b> Maximum Likelihood</a></li>
<li class="chapter" data-level="15.4.4" data-path="fa-extract.html"><a href="fa-extract.html#uniqueness"><i class="fa fa-check"></i><b>15.4.4</b> Uniqueness</a></li>
<li class="chapter" data-level="15.4.5" data-path="fa-extract.html"><a href="fa-extract.html#resulting-factors"><i class="fa fa-check"></i><b>15.4.5</b> Resulting factors</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="rotating-factors.html"><a href="rotating-factors.html"><i class="fa fa-check"></i><b>15.5</b> Rotating Factors</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="rotating-factors.html"><a href="rotating-factors.html#varimax-rotation"><i class="fa fa-check"></i><b>15.5.1</b> Varimax Rotation</a></li>
<li class="chapter" data-level="15.5.2" data-path="rotating-factors.html"><a href="rotating-factors.html#oblique-rotation"><i class="fa fa-check"></i><b>15.5.2</b> Oblique rotation</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="factor-scores.html"><a href="factor-scores.html"><i class="fa fa-check"></i><b>15.6</b> Factor Scores</a></li>
<li class="chapter" data-level="15.7" data-path="what-to-watch-out-for-1.html"><a href="what-to-watch-out-for-1.html"><i class="fa fa-check"></i><b>15.7</b> What to watch out for</a></li>
<li class="chapter" data-level="15.8" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>15.8</b> Additional Resources</a></li>
</ul></li>
<li class="part"><span><b>V Multi-level Modeling</b></span></li>
<li class="chapter" data-level="16" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>16</b> Introduction</a>
<ul>
<li class="chapter" data-level="16.1" data-path="example-school-data.html"><a href="example-school-data.html"><i class="fa fa-check"></i><b>16.1</b> Example School Data</a></li>
<li class="chapter" data-level="16.2" data-path="multi-level-models.html"><a href="multi-level-models.html"><i class="fa fa-check"></i><b>16.2</b> Multi-level models</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="RI.html"><a href="RI.html"><i class="fa fa-check"></i><b>17</b> Random Intercept Models</a>
<ul>
<li class="chapter" data-level="17.1" data-path="pooling.html"><a href="pooling.html"><i class="fa fa-check"></i><b>17.1</b> Pooling</a></li>
<li class="chapter" data-level="17.2" data-path="mathri.html"><a href="mathri.html"><i class="fa fa-check"></i><b>17.2</b> Mathematical Models</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="mathri.html"><a href="mathri.html#complete-pooling"><i class="fa fa-check"></i><b>17.2.1</b> Complete Pooling</a></li>
<li class="chapter" data-level="17.2.2" data-path="mathri.html"><a href="mathri.html#no-pooling"><i class="fa fa-check"></i><b>17.2.2</b> No Pooling</a></li>
<li class="chapter" data-level="17.2.3" data-path="mathri.html"><a href="mathri.html#partial-pooling-ri"><i class="fa fa-check"></i><b>17.2.3</b> Partial Pooling (RI)</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="components-of-variance-1.html"><a href="components-of-variance-1.html"><i class="fa fa-check"></i><b>17.3</b> Components of Variance</a></li>
<li class="chapter" data-level="17.4" data-path="fitri.html"><a href="fitri.html"><i class="fa fa-check"></i><b>17.4</b> Fitting models in R</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="fitri.html"><a href="fitri.html#comparison-of-estimates"><i class="fa fa-check"></i><b>17.4.1</b> Comparison of estimates</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="estimation-methods.html"><a href="estimation-methods.html"><i class="fa fa-check"></i><b>17.5</b> Estimation Methods</a></li>
<li class="chapter" data-level="17.6" data-path="including-covariates.html"><a href="including-covariates.html"><i class="fa fa-check"></i><b>17.6</b> Including Covariates</a></li>
<li class="chapter" data-level="17.7" data-path="more-random-effects.html"><a href="more-random-effects.html"><i class="fa fa-check"></i><b>17.7</b> More Random Effects</a></li>
<li class="chapter" data-level="17.8" data-path="centering-terms.html"><a href="centering-terms.html"><i class="fa fa-check"></i><b>17.8</b> Centering terms</a>
<ul>
<li class="chapter" data-level="17.8.1" data-path="centering-terms.html"><a href="centering-terms.html#a-generic-dplyr-approach-to-centering."><i class="fa fa-check"></i><b>17.8.1</b> A generic <code>dplyr</code> approach to centering.</a></li>
</ul></li>
<li class="chapter" data-level="17.9" data-path="specifying-correlation-structures.html"><a href="specifying-correlation-structures.html"><i class="fa fa-check"></i><b>17.9</b> Specifying Correlation Structures</a>
<ul>
<li class="chapter" data-level="17.9.1" data-path="specifying-correlation-structures.html"><a href="specifying-correlation-structures.html#changing-covariance-structures-in-r"><i class="fa fa-check"></i><b>17.9.1</b> Changing covariance structures in R</a></li>
</ul></li>
<li class="chapter" data-level="17.10" data-path="additional-references-1.html"><a href="additional-references-1.html"><i class="fa fa-check"></i><b>17.10</b> Additional References</a>
<ul>
<li class="chapter" data-level="17.10.1" data-path="additional-references-1.html"><a href="additional-references-1.html#lecture-notes-from-other-classes-found-on-the-interwebs"><i class="fa fa-check"></i><b>17.10.1</b> Lecture notes from other classes found on the interwebs</a></li>
<li class="chapter" data-level="17.10.2" data-path="additional-references-1.html"><a href="additional-references-1.html#package-vignettes"><i class="fa fa-check"></i><b>17.10.2</b> Package Vignettes</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VI Other Topics</b></span></li>
<li class="chapter" data-level="18" data-path="mda.html"><a href="mda.html"><i class="fa fa-check"></i><b>18</b> Missing Data</a>
<ul>
<li class="chapter" data-level="18.1" data-path="identifying-missing-data-1.html"><a href="identifying-missing-data-1.html"><i class="fa fa-check"></i><b>18.1</b> Identifying missing data</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="identifying-missing-data-1.html"><a href="identifying-missing-data-1.html#visualize-missing-patterns"><i class="fa fa-check"></i><b>18.1.1</b> Visualize missing patterns</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="effects-of-nonresponse.html"><a href="effects-of-nonresponse.html"><i class="fa fa-check"></i><b>18.2</b> Effects of Nonresponse</a></li>
<li class="chapter" data-level="18.3" data-path="missing-data-mechanisms.html"><a href="missing-data-mechanisms.html"><i class="fa fa-check"></i><b>18.3</b> Missing Data Mechanisms</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="missing-data-mechanisms.html"><a href="missing-data-mechanisms.html#demonstration-via-simulation"><i class="fa fa-check"></i><b>18.3.1</b> Demonstration via Simulation</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="general-strategies.html"><a href="general-strategies.html"><i class="fa fa-check"></i><b>18.4</b> General strategies</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="general-strategies.html"><a href="general-strategies.html#complete-cases-analysis"><i class="fa fa-check"></i><b>18.4.1</b> Complete cases analysis</a></li>
<li class="chapter" data-level="18.4.2" data-path="general-strategies.html"><a href="general-strategies.html#available-case-analysis"><i class="fa fa-check"></i><b>18.4.2</b> Available-case analysis</a></li>
<li class="chapter" data-level="18.4.3" data-path="general-strategies.html"><a href="general-strategies.html#imputation"><i class="fa fa-check"></i><b>18.4.3</b> Imputation</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="imputation-methods.html"><a href="imputation-methods.html"><i class="fa fa-check"></i><b>18.5</b> Imputation Methods</a></li>
<li class="chapter" data-level="18.6" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html"><i class="fa fa-check"></i><b>18.6</b> Multiple Imputation (MI)</a>
<ul>
<li class="chapter" data-level="18.6.1" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#goals"><i class="fa fa-check"></i><b>18.6.1</b> Goals</a></li>
<li class="chapter" data-level="18.6.2" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#technique"><i class="fa fa-check"></i><b>18.6.2</b> Technique</a></li>
<li class="chapter" data-level="18.6.3" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#mi-as-a-paradigm"><i class="fa fa-check"></i><b>18.6.3</b> MI as a paradigm</a></li>
<li class="chapter" data-level="18.6.4" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#inference-on-mi"><i class="fa fa-check"></i><b>18.6.4</b> Inference on MI</a></li>
</ul></li>
<li class="chapter" data-level="18.7" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html"><i class="fa fa-check"></i><b>18.7</b> Multiple Imputation using Chained Equations (MICE)</a>
<ul>
<li class="chapter" data-level="18.7.1" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#overview"><i class="fa fa-check"></i><b>18.7.1</b> Overview</a></li>
<li class="chapter" data-level="18.7.2" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#process-algorithm"><i class="fa fa-check"></i><b>18.7.2</b> Process / Algorithm</a></li>
<li class="chapter" data-level="18.7.3" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#convergence"><i class="fa fa-check"></i><b>18.7.3</b> Convergence</a></li>
<li class="chapter" data-level="18.7.4" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#imputation-methods-1"><i class="fa fa-check"></i><b>18.7.4</b> Imputation Methods</a></li>
</ul></li>
<li class="chapter" data-level="18.8" data-path="diagnostics.html"><a href="diagnostics.html"><i class="fa fa-check"></i><b>18.8</b> Diagnostics</a></li>
<li class="chapter" data-level="18.9" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html"><i class="fa fa-check"></i><b>18.9</b> Example: Prescribed amount of missing.</a>
<ul>
<li class="chapter" data-level="18.9.1" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#multiply-impute-the-missing-data-using-mice"><i class="fa fa-check"></i><b>18.9.1</b> Multiply impute the missing data using <code>mice()</code></a></li>
<li class="chapter" data-level="18.9.2" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#check-the-imputation-method-used-on-each-variable."><i class="fa fa-check"></i><b>18.9.2</b> Check the imputation method used on each variable.</a></li>
<li class="chapter" data-level="18.9.3" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#check-convergence"><i class="fa fa-check"></i><b>18.9.3</b> Check Convergence</a></li>
<li class="chapter" data-level="18.9.4" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#look-at-the-values-generated-for-imputation"><i class="fa fa-check"></i><b>18.9.4</b> Look at the values generated for imputation</a></li>
<li class="chapter" data-level="18.9.5" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#create-a-complete-data-set-by-filling-in-the-missing-data-using-the-imputations"><i class="fa fa-check"></i><b>18.9.5</b> Create a complete data set by filling in the missing data using the imputations</a></li>
<li class="chapter" data-level="18.9.6" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#visualize-imputations"><i class="fa fa-check"></i><b>18.9.6</b> Visualize Imputations</a></li>
<li class="chapter" data-level="18.9.7" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#calculating-bias"><i class="fa fa-check"></i><b>18.9.7</b> Calculating bias</a></li>
</ul></li>
<li class="chapter" data-level="18.10" data-path="post-mice-data-management.html"><a href="post-mice-data-management.html"><i class="fa fa-check"></i><b>18.10</b> Post MICE data management</a></li>
<li class="chapter" data-level="18.11" data-path="final-thoughts.html"><a href="final-thoughts.html"><i class="fa fa-check"></i><b>18.11</b> Final thoughts</a></li>
<li class="chapter" data-level="18.12" data-path="additional-references-2.html"><a href="additional-references-2.html"><i class="fa fa-check"></i><b>18.12</b> Additional References</a></li>
</ul></li>
<li class="part"><span><b>VII APPENDIX</b></span></li>
<li class="chapter" data-level="19" data-path="setup_intro.html"><a href="setup_intro.html"><i class="fa fa-check"></i><b>19</b> Setup R &amp; RStudio</a>
<ul>
<li class="chapter" data-level="19.1" data-path="before-you-begin.html"><a href="before-you-begin.html"><i class="fa fa-check"></i><b>19.1</b> ⚠️ Before you begin</a></li>
<li class="chapter" data-level="19.2" data-path="download-and-install-r.html"><a href="download-and-install-r.html"><i class="fa fa-check"></i><b>19.2</b> Download and install R</a>
<ul>
<li class="chapter" data-level="" data-path="download-and-install-r.html"><a href="download-and-install-r.html#download_r"><i class="fa fa-check"></i>🔽 Download R v 4.1+</a></li>
<li class="chapter" data-level="" data-path="download-and-install-r.html"><a href="download-and-install-r.html#install_r"><i class="fa fa-check"></i>✏️ Install</a></li>
<li class="chapter" data-level="" data-path="download-and-install-r.html"><a href="download-and-install-r.html#install_vid"><i class="fa fa-check"></i>🎦 Video Tutorials for both R and R Studio.</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="download-and-install-r-studio.html"><a href="download-and-install-r-studio.html"><i class="fa fa-check"></i><b>19.3</b> Download and install R Studio</a></li>
<li class="chapter" data-level="19.4" data-path="nav-rstudio.html"><a href="nav-rstudio.html"><i class="fa fa-check"></i><b>19.4</b> Navigating RStudio</a></li>
<li class="chapter" data-level="19.5" data-path="setting-preferences.html"><a href="setting-preferences.html"><i class="fa fa-check"></i><b>19.5</b> Setting preferences</a></li>
<li class="chapter" data-level="19.6" data-path="installing-packages.html"><a href="installing-packages.html"><i class="fa fa-check"></i><b>19.6</b> Installing packages</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="installing-packages.html"><a href="installing-packages.html#common-packages-used-in-this-notebook"><i class="fa fa-check"></i><b>19.6.1</b> Common packages used in this notebook</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="organization-using-r-projects.html"><a href="organization-using-r-projects.html"><i class="fa fa-check"></i><b>19.7</b> Organization using R Projects</a></li>
<li class="chapter" data-level="19.8" data-path="literate-programming-with-quarto.html"><a href="literate-programming-with-quarto.html"><i class="fa fa-check"></i><b>19.8</b> Literate programming with Quarto</a>
<ul>
<li class="chapter" data-level="19.8.1" data-path="literate-programming-with-quarto.html"><a href="literate-programming-with-quarto.html#creating-pdfs"><i class="fa fa-check"></i><b>19.8.1</b> Creating PDF’s</a></li>
</ul></li>
<li class="chapter" data-level="19.9" data-path="seeking-help.html"><a href="seeking-help.html"><i class="fa fa-check"></i><b>19.9</b> Seeking Help</a>
<ul>
<li class="chapter" data-level="19.9.1" data-path="seeking-help.html"><a href="seeking-help.html#advice-on-asking-for-help"><i class="fa fa-check"></i><b>19.9.1</b> Advice on asking for help</a></li>
<li class="chapter" data-level="19.9.2" data-path="seeking-help.html"><a href="seeking-help.html#help-from-inside-r-studio"><i class="fa fa-check"></i><b>19.9.2</b> Help from inside R Studio</a></li>
<li class="chapter" data-level="19.9.3" data-path="seeking-help.html"><a href="seeking-help.html#other-online"><i class="fa fa-check"></i><b>19.9.3</b> Other Online</a></li>
<li class="chapter" data-level="19.9.4" data-path="seeking-help.html"><a href="seeking-help.html#written"><i class="fa fa-check"></i><b>19.9.4</b> Written</a></li>
</ul></li>
<li class="chapter" data-level="19.10" data-path="saving-and-closing-your-work..html"><a href="saving-and-closing-your-work..html"><i class="fa fa-check"></i><b>19.10</b> Saving and closing your work.</a>
<ul>
<li class="chapter" data-level="19.10.1" data-path="saving-and-closing-your-work..html"><a href="saving-and-closing-your-work..html#restart-r"><i class="fa fa-check"></i><b>19.10.1</b> Restart R</a></li>
</ul></li>
<li class="chapter" data-level="19.11" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i><b>19.11</b> Acknowledgements</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/norcalbiostat/AppliedStatistics_notes" target="blank">View source on Github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interactions" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Interactions (PMA6 8.8)<a href="interactions.html#interactions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this <em>main effects</em> model, Species only changes the intercept. The effect of species is not multiplied by Sepal length. Reviewing the scatterplot below, do you think this is a reasonable model to fit the observed relationship?</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="interactions.html#cb1-1" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Petal.Length, <span class="at">color =</span> Species)) <span class="sc">+</span> </span>
<span id="cb1-2"><a href="interactions.html#cb1-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="model_building_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>If we care about how species <em>changes</em> the relationship between petal and sepal length, we can fit a model with an <strong>interaction</strong> between sepal length (<span class="math inline">\(x_{1}\)</span>) and species. For this first example let <span class="math inline">\(x_{2}\)</span> be an indicator for when <code>species == setosa</code>. Note that both <em>main effects</em> of sepal length, and setosa species are also included in the model. Interactions are mathematically represented as a multiplication between the two variables that are interacting.</p>
<p><span class="math display">\[ Y_{i} \sim \beta_{0} + \beta_{1}x_{i} + \beta_{2}x_{2i} + \beta_{3}x_{1i}x_{2i}\]</span></p>
<p>If we evaluate this model for both levels of <span class="math inline">\(x_{2}\)</span>, the resulting models are the same as the stratified models.</p>
<p>When <span class="math inline">\(x_{2} = 0\)</span>, the record is on an iris not from the <em>setosa</em> species.</p>
<p><span class="math display">\[ Y_{i} \sim \beta_{0} + \beta_{1}x_{i} + \beta_{2}(0) + \beta_{3}x_{1i}(0)\]</span>
which simplifies to
<span class="math display">\[ Y_{i} \sim \beta_{0} + \beta_{1}x_{i}\]</span></p>
<p>When <span class="math inline">\(x_{2} = 1\)</span>, the record is on an iris of the <em>setosa</em> species.</p>
<p><span class="math display">\[ Y_{i} \sim \beta_{0} + \beta_{1}x_{i} + \beta_{2}(1) + \beta_{3}x_{1i}(1)\]</span>
which simplifies to
<span class="math display">\[ Y_{i} \sim (\beta_{0} + \beta_{2}) + (\beta_{1} + \beta_{3})x_{i}\]</span></p>
<p>Each subgroup model has a different intercept and slope, but we had to estimate 4 parameters in the interaction model, and 6 for the fully stratified model.</p>
<div id="fitting-interaction-models-interpreting-coefficients" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Fitting interaction models &amp; interpreting coefficients<a href="interactions.html#fitting-interaction-models-interpreting-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Interactions are fit in <code>R</code> by simply multiplying <code>*</code> the two variables together in the model statement.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="interactions.html#cb2-1" tabindex="-1"></a>iris<span class="sc">$</span>setosa <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;setosa&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb2-2"><a href="interactions.html#cb2-2" tabindex="-1"></a><span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Sepal.Length <span class="sc">+</span> setosa <span class="sc">+</span> Sepal.Length<span class="sc">*</span>setosa, <span class="at">data=</span>iris) <span class="sc">|&gt;</span> <span class="fu">tbl_regression</span>()</span></code></pre></div>
<div id="jontlgyavv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jontlgyavv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jontlgyavv thead, #jontlgyavv tbody, #jontlgyavv tfoot, #jontlgyavv tr, #jontlgyavv td, #jontlgyavv th {
  border-style: none;
}

#jontlgyavv p {
  margin: 0;
  padding: 0;
}

#jontlgyavv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jontlgyavv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jontlgyavv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jontlgyavv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jontlgyavv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jontlgyavv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jontlgyavv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jontlgyavv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jontlgyavv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jontlgyavv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jontlgyavv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jontlgyavv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jontlgyavv .gt_spanner_row {
  border-bottom-style: hidden;
}

#jontlgyavv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jontlgyavv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jontlgyavv .gt_from_md > :first-child {
  margin-top: 0;
}

#jontlgyavv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jontlgyavv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jontlgyavv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jontlgyavv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jontlgyavv .gt_row_group_first td {
  border-top-width: 2px;
}

#jontlgyavv .gt_row_group_first th {
  border-top-width: 2px;
}

#jontlgyavv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jontlgyavv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jontlgyavv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jontlgyavv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jontlgyavv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jontlgyavv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jontlgyavv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jontlgyavv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jontlgyavv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jontlgyavv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jontlgyavv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jontlgyavv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jontlgyavv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jontlgyavv .gt_left {
  text-align: left;
}

#jontlgyavv .gt_center {
  text-align: center;
}

#jontlgyavv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jontlgyavv .gt_font_normal {
  font-weight: normal;
}

#jontlgyavv .gt_font_bold {
  font-weight: bold;
}

#jontlgyavv .gt_font_italic {
  font-style: italic;
}

#jontlgyavv .gt_super {
  font-size: 65%;
}

#jontlgyavv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jontlgyavv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jontlgyavv .gt_indent_1 {
  text-indent: 5px;
}

#jontlgyavv .gt_indent_2 {
  text-indent: 10px;
}

#jontlgyavv .gt_indent_3 {
  text-indent: 15px;
}

#jontlgyavv .gt_indent_4 {
  text-indent: 20px;
}

#jontlgyavv .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Characteristic&lt;/strong&gt;"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Beta&lt;/strong&gt;"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;95% CI&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;p-value&lt;/strong&gt;"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">Sepal.Length</td>
<td headers="estimate" class="gt_row gt_center">1.0</td>
<td headers="ci" class="gt_row gt_center">0.91, 1.1</td>
<td headers="p.value" class="gt_row gt_center"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">setosa</td>
<td headers="estimate" class="gt_row gt_center">2.4</td>
<td headers="ci" class="gt_row gt_center">0.61, 4.1</td>
<td headers="p.value" class="gt_row gt_center">0.008</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Sepal.Length * setosa</td>
<td headers="estimate" class="gt_row gt_center">-0.90</td>
<td headers="ci" class="gt_row gt_center">-1.2, -0.56</td>
<td headers="p.value" class="gt_row gt_center"><0.001</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
<p>The coefficient <span class="math inline">\(b_{3}\)</span> for the interaction term is significant, confirming that species changes the relationship between sepal length and petal length. Thus, species is a <strong>moderator</strong> (Chapter <a href="mod-strat.html#mod-strat">8</a>).</p>
<p><strong>Interpreting Coefficients</strong></p>
<ul>
<li>If <span class="math inline">\(x_{2}=0\)</span>, then the effect of <span class="math inline">\(x_{1}\)</span> on <span class="math inline">\(Y\)</span> simplifies to: <span class="math inline">\(\beta_{1}\)</span>
<ul>
<li><span class="math inline">\(b_{1}\)</span> The effect of sepal length on petal length <strong>for non-setosa species of iris</strong> (<code>setosa=0</code>)</li>
<li>For non-setosa species, the petal length increases 1.03cm for every additional cm of sepal length.</li>
</ul></li>
<li>If <span class="math inline">\(x_{2}=1\)</span>, then the effect of <span class="math inline">\(x_{1}\)</span> on <span class="math inline">\(Y\)</span> model simplifies to: <span class="math inline">\(\beta_{1} + \beta_{3}\)</span>
<ul>
<li>For setosa species, the petal length increases by <code>1.03-0.9=0.13</code> cm for every additional cm of sepal length.</li>
</ul></li>
</ul>

<div class="rmdcaution">
The main effects (<span class="math inline">\(b_{1}\)</span>, <span class="math inline">\(b_{2}\)</span>) cannot be interpreted by themselves when there is an interaction in the model.
</div>
</div>
<div id="interactions-catvars" class="section level3 hasAnchor" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> Categorical Interaction variables<a href="interactions.html#interactions-catvars" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s up the game now and look at the full interaction model with a categorical version of species.
Recall <span class="math inline">\(x_{1}\)</span> is Sepal Length, <span class="math inline">\(x_{2}\)</span> is the indicator for <em>versicolor</em>, and <span class="math inline">\(x_{3}\)</span> the indicator for <em>virginica</em> . Refer to <a href="interpreting-coefficients.html#cat-predictors">9.4.3</a> for information on how to interpret categorical predictors as main effects.</p>
<p><span class="math display">\[ Y_{i} \sim \beta_{0} + \beta_{1}x_{i} + \beta_{2}x_{2i} + \beta_{3}x_{3i} + \beta_{4}x_{1i}x_{2i} + \beta_{5}x_{1i}x_{3i}+\epsilon_{i}\]</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="interactions.html#cb3-1" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Sepal.Length <span class="sc">+</span> Species <span class="sc">+</span> Sepal.Length<span class="sc">*</span>Species, <span class="at">data=</span>iris))</span>
<span id="cb3-2"><a href="interactions.html#cb3-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-3"><a href="interactions.html#cb3-3" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb3-4"><a href="interactions.html#cb3-4" tabindex="-1"></a><span class="do">## lm(formula = Petal.Length ~ Sepal.Length + Species + Sepal.Length * </span></span>
<span id="cb3-5"><a href="interactions.html#cb3-5" tabindex="-1"></a><span class="do">##     Species, data = iris)</span></span>
<span id="cb3-6"><a href="interactions.html#cb3-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-7"><a href="interactions.html#cb3-7" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb3-8"><a href="interactions.html#cb3-8" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb3-9"><a href="interactions.html#cb3-9" tabindex="-1"></a><span class="do">## -0.68611 -0.13442 -0.00856  0.15966  0.79607 </span></span>
<span id="cb3-10"><a href="interactions.html#cb3-10" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-11"><a href="interactions.html#cb3-11" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb3-12"><a href="interactions.html#cb3-12" tabindex="-1"></a><span class="do">##                                Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb3-13"><a href="interactions.html#cb3-13" tabindex="-1"></a><span class="do">## (Intercept)                      0.8031     0.5310   1.512    0.133    </span></span>
<span id="cb3-14"><a href="interactions.html#cb3-14" tabindex="-1"></a><span class="do">## Sepal.Length                     0.1316     0.1058   1.244    0.216    </span></span>
<span id="cb3-15"><a href="interactions.html#cb3-15" tabindex="-1"></a><span class="do">## Speciesversicolor               -0.6179     0.6837  -0.904    0.368    </span></span>
<span id="cb3-16"><a href="interactions.html#cb3-16" tabindex="-1"></a><span class="do">## Speciesvirginica                -0.1926     0.6578  -0.293    0.770    </span></span>
<span id="cb3-17"><a href="interactions.html#cb3-17" tabindex="-1"></a><span class="do">## Sepal.Length:Speciesversicolor   0.5548     0.1281   4.330 2.78e-05 ***</span></span>
<span id="cb3-18"><a href="interactions.html#cb3-18" tabindex="-1"></a><span class="do">## Sepal.Length:Speciesvirginica    0.6184     0.1210   5.111 1.00e-06 ***</span></span>
<span id="cb3-19"><a href="interactions.html#cb3-19" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb3-20"><a href="interactions.html#cb3-20" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb3-21"><a href="interactions.html#cb3-21" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-22"><a href="interactions.html#cb3-22" tabindex="-1"></a><span class="do">## Residual standard error: 0.2611 on 144 degrees of freedom</span></span>
<span id="cb3-23"><a href="interactions.html#cb3-23" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.9789, Adjusted R-squared:  0.9781 </span></span>
<span id="cb3-24"><a href="interactions.html#cb3-24" tabindex="-1"></a><span class="do">## F-statistic:  1333 on 5 and 144 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>The slope of the relationship between sepal length and petal length is calculated as follows, for each species:</p>
<ul>
<li><em>setosa</em> <span class="math inline">\((x_{2}=0, x_{3}=0): b_{1}=0.13\)</span></li>
<li><em>versicolor</em> <span class="math inline">\((x_{2}=1, x_{3}=0): b_{1} + b_{2} + b_{4} = 0.13+0.55 = 0.68\)</span></li>
<li><em>virginica</em> <span class="math inline">\((x_{2}=0, x_{3}=1): b_{1} + b_{3} + b_{5} = 0.13+0.62 = 0.75\)</span></li>
</ul>
<p>Compare this to the estimates gained from the stratified model:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="interactions.html#cb4-1" tabindex="-1"></a><span class="fu">by</span>(iris, iris<span class="sc">$</span>Species, <span class="cf">function</span>(x){</span>
<span id="cb4-2"><a href="interactions.html#cb4-2" tabindex="-1"></a>  <span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Sepal.Length, <span class="at">data=</span>x) <span class="sc">%&gt;%</span> <span class="fu">coef</span>()</span>
<span id="cb4-3"><a href="interactions.html#cb4-3" tabindex="-1"></a>})</span>
<span id="cb4-4"><a href="interactions.html#cb4-4" tabindex="-1"></a><span class="do">## iris$Species: setosa</span></span>
<span id="cb4-5"><a href="interactions.html#cb4-5" tabindex="-1"></a><span class="do">##  (Intercept) Sepal.Length </span></span>
<span id="cb4-6"><a href="interactions.html#cb4-6" tabindex="-1"></a><span class="do">##    0.8030518    0.1316317 </span></span>
<span id="cb4-7"><a href="interactions.html#cb4-7" tabindex="-1"></a><span class="do">## ------------------------------------------------------------ </span></span>
<span id="cb4-8"><a href="interactions.html#cb4-8" tabindex="-1"></a><span class="do">## iris$Species: versicolor</span></span>
<span id="cb4-9"><a href="interactions.html#cb4-9" tabindex="-1"></a><span class="do">##  (Intercept) Sepal.Length </span></span>
<span id="cb4-10"><a href="interactions.html#cb4-10" tabindex="-1"></a><span class="do">##    0.1851155    0.6864698 </span></span>
<span id="cb4-11"><a href="interactions.html#cb4-11" tabindex="-1"></a><span class="do">## ------------------------------------------------------------ </span></span>
<span id="cb4-12"><a href="interactions.html#cb4-12" tabindex="-1"></a><span class="do">## iris$Species: virginica</span></span>
<span id="cb4-13"><a href="interactions.html#cb4-13" tabindex="-1"></a><span class="do">##  (Intercept) Sepal.Length </span></span>
<span id="cb4-14"><a href="interactions.html#cb4-14" tabindex="-1"></a><span class="do">##    0.6104680    0.7500808</span></span></code></pre></div>
<p>They’re the same! Proof that an interaction is equivalent to stratification.</p>
</div>
<div id="example-2" class="section level3 hasAnchor" number="10.1.3">
<h3><span class="header-section-number">10.1.3</span> Example 2<a href="interactions.html#example-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What if we now wanted to include other predictors in the model? How does sepal length relate to petal length after controlling for petal width? We add the variable for petal width into the model</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="interactions.html#cb5-1" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Sepal.Length <span class="sc">+</span> setosa <span class="sc">+</span> Sepal.Length<span class="sc">*</span>setosa <span class="sc">+</span> Petal.Width, <span class="at">data=</span>iris))</span>
<span id="cb5-2"><a href="interactions.html#cb5-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-3"><a href="interactions.html#cb5-3" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb5-4"><a href="interactions.html#cb5-4" tabindex="-1"></a><span class="do">## lm(formula = Petal.Length ~ Sepal.Length + setosa + Sepal.Length * </span></span>
<span id="cb5-5"><a href="interactions.html#cb5-5" tabindex="-1"></a><span class="do">##     setosa + Petal.Width, data = iris)</span></span>
<span id="cb5-6"><a href="interactions.html#cb5-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-7"><a href="interactions.html#cb5-7" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb5-8"><a href="interactions.html#cb5-8" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb5-9"><a href="interactions.html#cb5-9" tabindex="-1"></a><span class="do">## -0.83519 -0.18278 -0.01812  0.17004  1.06968 </span></span>
<span id="cb5-10"><a href="interactions.html#cb5-10" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-11"><a href="interactions.html#cb5-11" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb5-12"><a href="interactions.html#cb5-12" tabindex="-1"></a><span class="do">##                     Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb5-13"><a href="interactions.html#cb5-13" tabindex="-1"></a><span class="do">## (Intercept)         -0.86850    0.27028  -3.213  0.00162 ** </span></span>
<span id="cb5-14"><a href="interactions.html#cb5-14" tabindex="-1"></a><span class="do">## Sepal.Length         0.66181    0.05179  12.779  &lt; 2e-16 ***</span></span>
<span id="cb5-15"><a href="interactions.html#cb5-15" tabindex="-1"></a><span class="do">## setosa               1.83713    0.62355   2.946  0.00375 ** </span></span>
<span id="cb5-16"><a href="interactions.html#cb5-16" tabindex="-1"></a><span class="do">## Petal.Width          0.97269    0.07970  12.204  &lt; 2e-16 ***</span></span>
<span id="cb5-17"><a href="interactions.html#cb5-17" tabindex="-1"></a><span class="do">## Sepal.Length:setosa -0.61106    0.12213  -5.003 1.61e-06 ***</span></span>
<span id="cb5-18"><a href="interactions.html#cb5-18" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb5-19"><a href="interactions.html#cb5-19" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb5-20"><a href="interactions.html#cb5-20" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-21"><a href="interactions.html#cb5-21" tabindex="-1"></a><span class="do">## Residual standard error: 0.2769 on 145 degrees of freedom</span></span>
<span id="cb5-22"><a href="interactions.html#cb5-22" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.9761, Adjusted R-squared:  0.9754 </span></span>
<span id="cb5-23"><a href="interactions.html#cb5-23" tabindex="-1"></a><span class="do">## F-statistic:  1478 on 4 and 145 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>So far, petal width, and the combination of species and sepal length are both significantly associated with petal length.</p>
<p><em>Note of caution: Stratification implies that the stratifying variable interacts with all other variables.</em>
So if we were to go back to the stratified model where we fit the model of petal length on sepal length AND petal width, stratified by species, we would be implying that species interacts with both sepal length and petal width.</p>
<p>E.g. the following stratified model</p>
<ul>
<li><span class="math inline">\(Y = A + B + C + D + C*D\)</span>, when D=1</li>
<li><span class="math inline">\(Y = A + B + C + D + C*D\)</span>, when D=0</li>
</ul>
<p>is the same as the following interaction model:</p>
<ul>
<li><span class="math inline">\(Y = A + B + C + D + A*D + B*D + C*D\)</span></li>
</ul>
</div>
<div id="example-3" class="section level3 hasAnchor" number="10.1.4">
<h3><span class="header-section-number">10.1.4</span> Example 3:<a href="interactions.html#example-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s explore the relationship between income, employment status and depression.
This example follows a logistic regression example from section <a href="logreg.html#mlogreg">11.4.4</a>.</p>
<p>Here I create the binary indicators of <code>lowincome</code> (annual income &lt;$10k/year) and underemployed (part time or unemployed).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="interactions.html#cb6-1" tabindex="-1"></a>depress<span class="sc">$</span>lowincome <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(depress<span class="sc">$</span>income <span class="sc">&lt;</span> <span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb6-2"><a href="interactions.html#cb6-2" tabindex="-1"></a><span class="fu">table</span>(depress<span class="sc">$</span>lowincome, depress<span class="sc">$</span>income, <span class="at">useNA=</span><span class="st">&quot;always&quot;</span>)</span>
<span id="cb6-3"><a href="interactions.html#cb6-3" tabindex="-1"></a><span class="do">##       </span></span>
<span id="cb6-4"><a href="interactions.html#cb6-4" tabindex="-1"></a><span class="do">##         2  4  5  6  7  8  9 11 12 13 15 16 18 19 20 23 24 25 26 27 28 31 32 35</span></span>
<span id="cb6-5"><a href="interactions.html#cb6-5" tabindex="-1"></a><span class="do">##   0     0  0  0  0  0  0  0 17  2 18 24  1  1 25  3 25  2  1  1  1 19  1  1 24</span></span>
<span id="cb6-6"><a href="interactions.html#cb6-6" tabindex="-1"></a><span class="do">##   1     7  8 10 12 18 14 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span id="cb6-7"><a href="interactions.html#cb6-7" tabindex="-1"></a><span class="do">##   &lt;NA&gt;  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span id="cb6-8"><a href="interactions.html#cb6-8" tabindex="-1"></a><span class="do">##       </span></span>
<span id="cb6-9"><a href="interactions.html#cb6-9" tabindex="-1"></a><span class="do">##        36 37 42 45 55 65 &lt;NA&gt;</span></span>
<span id="cb6-10"><a href="interactions.html#cb6-10" tabindex="-1"></a><span class="do">##   0     1  1  1 15  9 10    0</span></span>
<span id="cb6-11"><a href="interactions.html#cb6-11" tabindex="-1"></a><span class="do">##   1     0  0  0  0  0  0    0</span></span>
<span id="cb6-12"><a href="interactions.html#cb6-12" tabindex="-1"></a><span class="do">##   &lt;NA&gt;  0  0  0  0  0  0    0</span></span>
<span id="cb6-13"><a href="interactions.html#cb6-13" tabindex="-1"></a></span>
<span id="cb6-14"><a href="interactions.html#cb6-14" tabindex="-1"></a>depress<span class="sc">$</span>underemployed <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(depress<span class="sc">$</span>employ <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;PT&quot;</span>, <span class="st">&quot;Unemp&quot;</span>), <span class="dv">1</span>, <span class="dv">0</span> )</span>
<span id="cb6-15"><a href="interactions.html#cb6-15" tabindex="-1"></a><span class="fu">table</span>(depress<span class="sc">$</span>underemployed, depress<span class="sc">$</span>employ, <span class="at">useNA=</span><span class="st">&quot;always&quot;</span>)</span>
<span id="cb6-16"><a href="interactions.html#cb6-16" tabindex="-1"></a><span class="do">##       </span></span>
<span id="cb6-17"><a href="interactions.html#cb6-17" tabindex="-1"></a><span class="do">##         FT Houseperson In School Other  PT Retired Unemp &lt;NA&gt;</span></span>
<span id="cb6-18"><a href="interactions.html#cb6-18" tabindex="-1"></a><span class="do">##   0    167          27         2     4   0      38     0    0</span></span>
<span id="cb6-19"><a href="interactions.html#cb6-19" tabindex="-1"></a><span class="do">##   1      0           0         0     0  42       0    14    0</span></span>
<span id="cb6-20"><a href="interactions.html#cb6-20" tabindex="-1"></a><span class="do">##   &lt;NA&gt;   0           0         0     0   0       0     0    0</span></span></code></pre></div>
<p>The <strong>Main Effects</strong> model assumes that the effect of income on depression is independent of employment status, and the effect of employment status on depression is independent of income.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="interactions.html#cb7-1" tabindex="-1"></a>me_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> lowincome <span class="sc">+</span> underemployed, <span class="at">data=</span>depress, <span class="at">family=</span><span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb7-2"><a href="interactions.html#cb7-2" tabindex="-1"></a><span class="fu">summary</span>(me_model)</span>
<span id="cb7-3"><a href="interactions.html#cb7-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-4"><a href="interactions.html#cb7-4" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb7-5"><a href="interactions.html#cb7-5" tabindex="-1"></a><span class="do">## glm(formula = cases ~ lowincome + underemployed, family = &quot;binomial&quot;, </span></span>
<span id="cb7-6"><a href="interactions.html#cb7-6" tabindex="-1"></a><span class="do">##     data = depress)</span></span>
<span id="cb7-7"><a href="interactions.html#cb7-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-8"><a href="interactions.html#cb7-8" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb7-9"><a href="interactions.html#cb7-9" tabindex="-1"></a><span class="do">##               Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb7-10"><a href="interactions.html#cb7-10" tabindex="-1"></a><span class="do">## (Intercept)    -1.9003     0.2221  -8.556  &lt; 2e-16 ***</span></span>
<span id="cb7-11"><a href="interactions.html#cb7-11" tabindex="-1"></a><span class="do">## lowincome       0.2192     0.3353   0.654  0.51322    </span></span>
<span id="cb7-12"><a href="interactions.html#cb7-12" tabindex="-1"></a><span class="do">## underemployed   1.0094     0.3470   2.909  0.00363 ** </span></span>
<span id="cb7-13"><a href="interactions.html#cb7-13" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb7-14"><a href="interactions.html#cb7-14" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-15"><a href="interactions.html#cb7-15" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-16"><a href="interactions.html#cb7-16" tabindex="-1"></a><span class="do">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb7-17"><a href="interactions.html#cb7-17" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-18"><a href="interactions.html#cb7-18" tabindex="-1"></a><span class="do">##     Null deviance: 268.12  on 293  degrees of freedom</span></span>
<span id="cb7-19"><a href="interactions.html#cb7-19" tabindex="-1"></a><span class="do">## Residual deviance: 259.93  on 291  degrees of freedom</span></span>
<span id="cb7-20"><a href="interactions.html#cb7-20" tabindex="-1"></a><span class="do">## AIC: 265.93</span></span>
<span id="cb7-21"><a href="interactions.html#cb7-21" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-22"><a href="interactions.html#cb7-22" tabindex="-1"></a><span class="do">## Number of Fisher Scoring iterations: 4</span></span></code></pre></div>
<p>To formally test whether an interaction term is necessary, we add the interaction term into the model and assess whether the coefficient for the interaction term is significantly different from zero.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="interactions.html#cb8-1" tabindex="-1"></a>me_intx_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(cases <span class="sc">~</span> lowincome <span class="sc">+</span> underemployed <span class="sc">+</span> lowincome<span class="sc">*</span>underemployed, <span class="at">data=</span>depress, <span class="at">family=</span><span class="st">&quot;binomial&quot;</span>) </span>
<span id="cb8-2"><a href="interactions.html#cb8-2" tabindex="-1"></a><span class="fu">summary</span>(me_intx_model)</span>
<span id="cb8-3"><a href="interactions.html#cb8-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb8-4"><a href="interactions.html#cb8-4" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb8-5"><a href="interactions.html#cb8-5" tabindex="-1"></a><span class="do">## glm(formula = cases ~ lowincome + underemployed + lowincome * </span></span>
<span id="cb8-6"><a href="interactions.html#cb8-6" tabindex="-1"></a><span class="do">##     underemployed, family = &quot;binomial&quot;, data = depress)</span></span>
<span id="cb8-7"><a href="interactions.html#cb8-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb8-8"><a href="interactions.html#cb8-8" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb8-9"><a href="interactions.html#cb8-9" tabindex="-1"></a><span class="do">##                         Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb8-10"><a href="interactions.html#cb8-10" tabindex="-1"></a><span class="do">## (Intercept)              -1.7011     0.2175  -7.822 5.21e-15 ***</span></span>
<span id="cb8-11"><a href="interactions.html#cb8-11" tabindex="-1"></a><span class="do">## lowincome                -0.4390     0.4324  -1.015  0.31005    </span></span>
<span id="cb8-12"><a href="interactions.html#cb8-12" tabindex="-1"></a><span class="do">## underemployed             0.2840     0.4501   0.631  0.52802    </span></span>
<span id="cb8-13"><a href="interactions.html#cb8-13" tabindex="-1"></a><span class="do">## lowincome:underemployed   2.2615     0.7874   2.872  0.00408 ** </span></span>
<span id="cb8-14"><a href="interactions.html#cb8-14" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb8-15"><a href="interactions.html#cb8-15" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb8-16"><a href="interactions.html#cb8-16" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb8-17"><a href="interactions.html#cb8-17" tabindex="-1"></a><span class="do">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb8-18"><a href="interactions.html#cb8-18" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb8-19"><a href="interactions.html#cb8-19" tabindex="-1"></a><span class="do">##     Null deviance: 268.12  on 293  degrees of freedom</span></span>
<span id="cb8-20"><a href="interactions.html#cb8-20" tabindex="-1"></a><span class="do">## Residual deviance: 251.17  on 290  degrees of freedom</span></span>
<span id="cb8-21"><a href="interactions.html#cb8-21" tabindex="-1"></a><span class="do">## AIC: 259.17</span></span>
<span id="cb8-22"><a href="interactions.html#cb8-22" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb8-23"><a href="interactions.html#cb8-23" tabindex="-1"></a><span class="do">## Number of Fisher Scoring iterations: 4</span></span></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-building.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="general-F.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
