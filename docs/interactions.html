<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9.4 Interactions | Applied Statistics</title>
  <meta name="description" content="Course notes for Applied Statistics courses at CSU Chico" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="9.4 Interactions | Applied Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for Applied Statistics courses at CSU Chico" />
  <meta name="github-repo" content="norcalbiostat/AppliedStatistics_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9.4 Interactions | Applied Statistics" />
  
  <meta name="twitter:description" content="Course notes for Applied Statistics courses at CSU Chico" />
  

<meta name="author" content="Robin Donatello, Edward Roualdes" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="moderation.html"/>
<link rel="next" href="confounding.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Statistics course notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Preparing Data for Analysis</b></span></li>
<li class="chapter" data-level="1" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>1</b> Workflow and Data Cleaning</a><ul>
<li class="chapter" data-level="1.1" data-path="generating-a-reproducible-workflows.html"><a href="generating-a-reproducible-workflows.html"><i class="fa fa-check"></i><b>1.1</b> Generating a reproducible workflows</a><ul>
<li class="chapter" data-level="1.1.1" data-path="generating-a-reproducible-workflows.html"><a href="generating-a-reproducible-workflows.html#literate-programming"><i class="fa fa-check"></i><b>1.1.1</b> Literate programming</a></li>
<li class="chapter" data-level="1.1.2" data-path="generating-a-reproducible-workflows.html"><a href="generating-a-reproducible-workflows.html#reproducible-research-literate-programming"><i class="fa fa-check"></i><b>1.1.2</b> Reproducible Research + Literate Programming</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="import-data.html"><a href="import-data.html"><i class="fa fa-check"></i><b>1.2</b> Import data</a><ul>
<li class="chapter" data-level="1.2.1" data-path="import-data.html"><a href="import-data.html#renaming-variable-names-for-sanity-sake"><i class="fa fa-check"></i><b>1.2.1</b> Renaming variable names for sanity sake</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="data-management.html"><a href="data-management.html"><i class="fa fa-check"></i><b>1.3</b> Data Management</a><ul>
<li class="chapter" data-level="1.3.1" data-path="data-management.html"><a href="data-management.html#missing-data"><i class="fa fa-check"></i><b>1.3.1</b> Missing data</a></li>
<li class="chapter" data-level="1.3.2" data-path="data-management.html"><a href="data-management.html#identifying-variable-types"><i class="fa fa-check"></i><b>1.3.2</b> Identifying Variable Types</a></li>
<li class="chapter" data-level="1.3.3" data-path="data-management.html"><a href="data-management.html#outliers"><i class="fa fa-check"></i><b>1.3.3</b> Outliers</a></li>
<li class="chapter" data-level="1.3.4" data-path="data-management.html"><a href="data-management.html#creating-secondary-variables"><i class="fa fa-check"></i><b>1.3.4</b> Creating secondary variables</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="saving-your-changes.html"><a href="saving-your-changes.html"><i class="fa fa-check"></i><b>1.4</b> Saving your changes</a></li>
<li class="chapter" data-level="1.5" data-path="wide-vs-long-data.html"><a href="wide-vs-long-data.html"><i class="fa fa-check"></i><b>1.5</b> Wide vs. Long data</a></li>
<li class="chapter" data-level="1.6" data-path="dealing-with-missing-data-post-analysis.html"><a href="dealing-with-missing-data-post-analysis.html"><i class="fa fa-check"></i><b>1.6</b> Dealing with missing data post-analysis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-viz.html"><a href="data-viz.html"><i class="fa fa-check"></i><b>2</b> Visualizing Data</a><ul>
<li class="chapter" data-level="2.1" data-path="the-syntax-of-ggplot.html"><a href="the-syntax-of-ggplot.html"><i class="fa fa-check"></i><b>2.1</b> The syntax of <code>ggplot</code></a><ul>
<li class="chapter" data-level="2.1.1" data-path="the-syntax-of-ggplot.html"><a href="the-syntax-of-ggplot.html#required-arguments"><i class="fa fa-check"></i><b>2.1.1</b> Required arguments</a></li>
<li class="chapter" data-level="2.1.2" data-path="the-syntax-of-ggplot.html"><a href="the-syntax-of-ggplot.html#optional-but-helpful-arguments"><i class="fa fa-check"></i><b>2.1.2</b> Optional but helpful arguments</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="the-data.html"><a href="the-data.html"><i class="fa fa-check"></i><b>2.2</b> The Data</a></li>
<li class="chapter" data-level="2.3" data-path="univariate-visualizations.html"><a href="univariate-visualizations.html"><i class="fa fa-check"></i><b>2.3</b> Univariate Visualizations</a><ul>
<li class="chapter" data-level="2.3.1" data-path="univariate-visualizations.html"><a href="univariate-visualizations.html#categorical-variables"><i class="fa fa-check"></i><b>2.3.1</b> Categorical variables</a></li>
<li class="chapter" data-level="2.3.2" data-path="univariate-visualizations.html"><a href="univariate-visualizations.html#continuous-measures"><i class="fa fa-check"></i><b>2.3.2</b> Continuous Measures</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html"><i class="fa fa-check"></i><b>2.4</b> Bivariate Visualizations</a><ul>
<li class="chapter" data-level="2.4.1" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#categorical-v.-categorical"><i class="fa fa-check"></i><b>2.4.1</b> Categorical v. Categorical</a></li>
<li class="chapter" data-level="2.4.2" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#grouped-bar-charts-with-percentages"><i class="fa fa-check"></i><b>2.4.2</b> Grouped bar charts with percentages</a></li>
<li class="chapter" data-level="2.4.3" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#continuous-v.-continuous"><i class="fa fa-check"></i><b>2.4.3</b> Continuous v. Continuous</a></li>
<li class="chapter" data-level="2.4.4" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#continuous-v.-categorical"><i class="fa fa-check"></i><b>2.4.4</b> Continuous v. Categorical</a></li>
<li class="chapter" data-level="2.4.5" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#joy-plots-ridgelines"><i class="fa fa-check"></i><b>2.4.5</b> Joy plots / Ridgelines</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="faceting-paneling.html"><a href="faceting-paneling.html"><i class="fa fa-check"></i><b>2.5</b> Faceting / paneling</a></li>
<li class="chapter" data-level="2.6" data-path="multiple-plots-per-window.html"><a href="multiple-plots-per-window.html"><i class="fa fa-check"></i><b>2.6</b> Multiple plots per window</a></li>
<li class="chapter" data-level="2.7" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html"><i class="fa fa-check"></i><b>2.7</b> Multivariate (3+ variables)</a><ul>
<li class="chapter" data-level="2.7.1" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html#three-continuous"><i class="fa fa-check"></i><b>2.7.1</b> Three continuous</a></li>
<li class="chapter" data-level="2.7.2" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html#scatterplot-matrix"><i class="fa fa-check"></i><b>2.7.2</b> Scatterplot matrix</a></li>
<li class="chapter" data-level="2.7.3" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html#two-categorical-and-one-continuous"><i class="fa fa-check"></i><b>2.7.3</b> Two categorical and one continuous</a></li>
<li class="chapter" data-level="2.7.4" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html#two-continuous-and-one-categorical"><i class="fa fa-check"></i><b>2.7.4</b> Two continuous and one categorical</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="paneling-on-two-variables.html"><a href="paneling-on-two-variables.html"><i class="fa fa-check"></i><b>2.8</b> Paneling on two variables</a></li>
<li class="chapter" data-level="2.9" data-path="troubleshooting.html"><a href="troubleshooting.html"><i class="fa fa-check"></i><b>2.9</b> Troubleshooting</a></li>
<li class="chapter" data-level="2.10" data-path="but-what-about.html"><a href="but-what-about.html"><i class="fa fa-check"></i><b>2.10</b> But what about…</a><ul>
<li class="chapter" data-level="2.10.1" data-path="but-what-about.html"><a href="but-what-about.html#other-plots-not-mentioned"><i class="fa fa-check"></i><b>2.10.1</b> Other plots not mentioned</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>2.11</b> Additional Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="select-analysis.html"><a href="select-analysis.html"><i class="fa fa-check"></i><b>3</b> Selecting Appropriate Analyses</a></li>
<li class="part"><span><b>II Statistical Inference</b></span></li>
<li class="chapter" data-level="4" data-path="bv-intro.html"><a href="bv-intro.html"><i class="fa fa-check"></i><b>4</b> Foundations for Inference</a></li>
<li class="chapter" data-level="5" data-path="bivariate-analysis.html"><a href="bivariate-analysis.html"><i class="fa fa-check"></i><b>5</b> Bivariate Analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="assumption-of-independent-observations.html"><a href="assumption-of-independent-observations.html"><i class="fa fa-check"></i><b>5.1</b> Assumption of Independent Observations</a></li>
<li class="chapter" data-level="5.2" data-path="choosing-appropriate-bivariate-analysis.html"><a href="choosing-appropriate-bivariate-analysis.html"><i class="fa fa-check"></i><b>5.2</b> Choosing appropriate bivariate analysis</a></li>
<li class="chapter" data-level="5.3" data-path="bv-ttest.html"><a href="bv-ttest.html"><i class="fa fa-check"></i><b>5.3</b> (Q~B) Two means: T-Test</a><ul>
<li class="chapter" data-level="5.3.1" data-path="bv-ttest.html"><a href="bv-ttest.html#assumptions"><i class="fa fa-check"></i><b>5.3.1</b> Assumptions</a></li>
<li class="chapter" data-level="5.3.2" data-path="bv-ttest.html"><a href="bv-ttest.html#sampling-distribution-for-the-difference"><i class="fa fa-check"></i><b>5.3.2</b> Sampling Distribution for the difference</a></li>
<li class="chapter" data-level="5.3.3" data-path="bv-ttest.html"><a href="bv-ttest.html#example-smoking-and-bmi"><i class="fa fa-check"></i><b>5.3.3</b> Example: Smoking and BMI</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bv-anova.html"><a href="bv-anova.html"><i class="fa fa-check"></i><b>5.4</b> (Q~C) Multiple means: ANOVA</a><ul>
<li class="chapter" data-level="5.4.1" data-path="bv-anova.html"><a href="bv-anova.html#formulation-of-the-one-way-anova-model"><i class="fa fa-check"></i><b>5.4.1</b> Formulation of the One-way ANOVA model</a></li>
<li class="chapter" data-level="5.4.2" data-path="bv-anova.html"><a href="bv-anova.html#analysis-of-variance-tabl"><i class="fa fa-check"></i><b>5.4.2</b> Analysis of Variance Tabl*:</a></li>
<li class="chapter" data-level="5.4.3" data-path="bv-anova.html"><a href="bv-anova.html#the-f-distribution"><i class="fa fa-check"></i><b>5.4.3</b> The F-distribution</a></li>
<li class="chapter" data-level="5.4.4" data-path="bv-anova.html"><a href="bv-anova.html#assumptions-1"><i class="fa fa-check"></i><b>5.4.4</b> Assumptions</a></li>
<li class="chapter" data-level="5.4.5" data-path="bv-anova.html"><a href="bv-anova.html#example-a-comparison-of-plant-species-under-low-water-conditions"><i class="fa fa-check"></i><b>5.4.5</b> Example: A comparison of plant species under low water conditions</a></li>
<li class="chapter" data-level="5.4.6" data-path="bv-anova.html"><a href="bv-anova.html#coefficient-of-determination-r2"><i class="fa fa-check"></i><b>5.4.6</b> Coefficient of determination <span class="math inline">\(R^{2}\)</span></a></li>
<li class="chapter" data-level="5.4.7" data-path="bv-anova.html"><a href="bv-anova.html#multiple-comparisons"><i class="fa fa-check"></i><b>5.4.7</b> Multiple Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="bv-chisq.html"><a href="bv-chisq.html"><i class="fa fa-check"></i><b>5.5</b> (C~C) Multiple Proportions: <span class="math inline">\(\chi^{2}\)</span></a><ul>
<li class="chapter" data-level="5.5.1" data-path="bv-chisq.html"><a href="bv-chisq.html#conditions-for-the-sampling-distribution-to-be-normal."><i class="fa fa-check"></i><b>5.5.1</b> Conditions for the sampling distribution to be normal.</a></li>
<li class="chapter" data-level="5.5.2" data-path="bv-chisq.html"><a href="bv-chisq.html#example-are-mammograms-effective"><i class="fa fa-check"></i><b>5.5.2</b> Example: Are Mammograms effective?</a></li>
<li class="chapter" data-level="5.5.3" data-path="bv-chisq.html"><a href="bv-chisq.html#example-smoking-and-general-health"><i class="fa fa-check"></i><b>5.5.3</b> Example: Smoking and General Health</a></li>
<li class="chapter" data-level="5.5.4" data-path="bv-chisq.html"><a href="bv-chisq.html#multiple-comparisons-1"><i class="fa fa-check"></i><b>5.5.4</b> Multiple Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="bv-corr.html"><a href="bv-corr.html"><i class="fa fa-check"></i><b>5.6</b> (Q~Q) Correlation</a><ul>
<li class="chapter" data-level="5.6.1" data-path="bv-corr.html"><a href="bv-corr.html#example-federal-spending-per-capita-and-poverty-rate"><i class="fa fa-check"></i><b>5.6.1</b> Example: Federal spending per capita and poverty rate</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Regression Modeling</b></span></li>
<li class="chapter" data-level="6" data-path="reg-intro.html"><a href="reg-intro.html"><i class="fa fa-check"></i><b>6</b> Introduction</a></li>
<li class="chapter" data-level="7" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>7</b> Simple Linear Regression</a><ul>
<li class="chapter" data-level="7.1" data-path="mathmatical-model.html"><a href="mathmatical-model.html"><i class="fa fa-check"></i><b>7.1</b> Mathmatical Model</a></li>
<li class="chapter" data-level="7.2" data-path="parameter-estimates.html"><a href="parameter-estimates.html"><i class="fa fa-check"></i><b>7.2</b> Parameter Estimates</a></li>
<li class="chapter" data-level="7.3" data-path="interval-estimation.html"><a href="interval-estimation.html"><i class="fa fa-check"></i><b>7.3</b> Interval estimation</a></li>
<li class="chapter" data-level="7.4" data-path="corelation-coefficient.html"><a href="corelation-coefficient.html"><i class="fa fa-check"></i><b>7.4</b> Corelation Coefficient</a></li>
<li class="chapter" data-level="7.5" data-path="assumptions-2.html"><a href="assumptions-2.html"><i class="fa fa-check"></i><b>7.5</b> Assumptions</a></li>
<li class="chapter" data-level="7.6" data-path="example.html"><a href="example.html"><i class="fa fa-check"></i><b>7.6</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>8</b> Multiple Linear Regression</a><ul>
<li class="chapter" data-level="8.1" data-path="types-of-x-variables.html"><a href="types-of-x-variables.html"><i class="fa fa-check"></i><b>8.1</b> Types of X variables</a></li>
<li class="chapter" data-level="8.2" data-path="mathematical-model.html"><a href="mathematical-model.html"><i class="fa fa-check"></i><b>8.2</b> Mathematical Model</a></li>
<li class="chapter" data-level="8.3" data-path="parameter-estimation.html"><a href="parameter-estimation.html"><i class="fa fa-check"></i><b>8.3</b> Parameter Estimation</a></li>
<li class="chapter" data-level="8.4" data-path="example-1.html"><a href="example-1.html"><i class="fa fa-check"></i><b>8.4</b> Example</a></li>
<li class="chapter" data-level="8.5" data-path="model-diagnostics.html"><a href="model-diagnostics.html"><i class="fa fa-check"></i><b>8.5</b> Model Diagnostics</a></li>
<li class="chapter" data-level="8.6" data-path="multicollinearity.html"><a href="multicollinearity.html"><i class="fa fa-check"></i><b>8.6</b> Multicollinearity</a></li>
<li class="chapter" data-level="8.7" data-path="what-to-watch-out-for.html"><a href="what-to-watch-out-for.html"><i class="fa fa-check"></i><b>8.7</b> What to watch out for</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="model-building.html"><a href="model-building.html"><i class="fa fa-check"></i><b>9</b> Model Building</a><ul>
<li class="chapter" data-level="9.1" data-path="categorical-predictors.html"><a href="categorical-predictors.html"><i class="fa fa-check"></i><b>9.1</b> Categorical Predictors</a><ul>
<li class="chapter" data-level="9.1.1" data-path="categorical-predictors.html"><a href="categorical-predictors.html#factor-variable-coding"><i class="fa fa-check"></i><b>9.1.1</b> Factor variable coding</a></li>
<li class="chapter" data-level="9.1.2" data-path="categorical-predictors.html"><a href="categorical-predictors.html#wald-test"><i class="fa fa-check"></i><b>9.1.2</b> Wald test</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="stratification.html"><a href="stratification.html"><i class="fa fa-check"></i><b>9.2</b> Stratification</a></li>
<li class="chapter" data-level="9.3" data-path="moderation.html"><a href="moderation.html"><i class="fa fa-check"></i><b>9.3</b> Moderation</a><ul>
<li class="chapter" data-level="9.3.1" data-path="moderation.html"><a href="moderation.html#example-1-sepal-vs-petal-length"><i class="fa fa-check"></i><b>9.3.1</b> Example 1: Sepal vs Petal Length</a></li>
<li class="chapter" data-level="9.3.2" data-path="moderation.html"><a href="moderation.html#example-2-simpsons-paradox"><i class="fa fa-check"></i><b>9.3.2</b> Example 2: Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>9.4</b> Interactions</a><ul>
<li class="chapter" data-level="9.4.1" data-path="interactions.html"><a href="interactions.html#example-2"><i class="fa fa-check"></i><b>9.4.1</b> Example</a></li>
<li class="chapter" data-level="9.4.2" data-path="interactions.html"><a href="interactions.html#example-3"><i class="fa fa-check"></i><b>9.4.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="confounding.html"><a href="confounding.html"><i class="fa fa-check"></i><b>9.5</b> Confounding</a></li>
<li class="chapter" data-level="9.6" data-path="variable-selection-process.html"><a href="variable-selection-process.html"><i class="fa fa-check"></i><b>9.6</b> Variable Selection Process</a><ul>
<li class="chapter" data-level="9.6.1" data-path="variable-selection-process.html"><a href="variable-selection-process.html#automated-selection-procedures"><i class="fa fa-check"></i><b>9.6.1</b> Automated selection procedures</a></li>
<li class="chapter" data-level="9.6.2" data-path="variable-selection-process.html"><a href="variable-selection-process.html#the-lesser-of-three-evils-best-subsets-pma5-section-8.7"><i class="fa fa-check"></i><b>9.6.2</b> The lesser of three evils: Best Subsets (PMA5 Section 8.7)</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="comparing-between-models.html"><a href="comparing-between-models.html"><i class="fa fa-check"></i><b>9.7</b> Comparing between models</a></li>
<li class="chapter" data-level="9.8" data-path="what-to-watch-out-for-1.html"><a href="what-to-watch-out-for-1.html"><i class="fa fa-check"></i><b>9.8</b> What to watch out for</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>10</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="10.1" data-path="fitting-glms-in-r.html"><a href="fitting-glms-in-r.html"><i class="fa fa-check"></i><b>10.1</b> Fitting GLMs in R</a></li>
<li class="chapter" data-level="10.2" data-path="binary-data.html"><a href="binary-data.html"><i class="fa fa-check"></i><b>10.2</b> Binary Data</a><ul>
<li class="chapter" data-level="10.2.1" data-path="binary-data.html"><a href="binary-data.html#example-the-effect-of-gender-on-depression"><i class="fa fa-check"></i><b>10.2.1</b> Example: The effect of gender on Depression</a></li>
<li class="chapter" data-level="10.2.2" data-path="binary-data.html"><a href="binary-data.html#multiple-logistic-regression"><i class="fa fa-check"></i><b>10.2.2</b> Multiple Logistic Regression</a></li>
<li class="chapter" data-level="10.2.3" data-path="binary-data.html"><a href="binary-data.html#interpretation"><i class="fa fa-check"></i><b>10.2.3</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="classification-of-binary-outcomes.html"><a href="classification-of-binary-outcomes.html"><i class="fa fa-check"></i><b>10.3</b> Classification of Binary outcomes</a><ul>
<li class="chapter" data-level="10.3.1" data-path="classification-of-binary-outcomes.html"><a href="classification-of-binary-outcomes.html#calculating-predictions"><i class="fa fa-check"></i><b>10.3.1</b> Calculating predictions</a></li>
<li class="chapter" data-level="10.3.2" data-path="classification-of-binary-outcomes.html"><a href="classification-of-binary-outcomes.html#roc-curves"><i class="fa fa-check"></i><b>10.3.2</b> ROC Curves</a></li>
<li class="chapter" data-level="10.3.3" data-path="classification-of-binary-outcomes.html"><a href="classification-of-binary-outcomes.html#model-performance"><i class="fa fa-check"></i><b>10.3.3</b> Model Performance</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="categorical-data.html"><a href="categorical-data.html"><i class="fa fa-check"></i><b>10.4</b> Categorical Data</a></li>
<li class="chapter" data-level="10.5" data-path="count-data.html"><a href="count-data.html"><i class="fa fa-check"></i><b>10.5</b> Count Data</a></li>
</ul></li>
<li class="part"><span><b>IV Multivariate Analysis</b></span></li>
<li class="chapter" data-level="11" data-path="mv-intro.html"><a href="mv-intro.html"><i class="fa fa-check"></i><b>11</b> Introduction</a></li>
<li class="chapter" data-level="12" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>12</b> Principal Component Analysis</a><ul>
<li class="chapter" data-level="12.1" data-path="basic-idea.html"><a href="basic-idea.html"><i class="fa fa-check"></i><b>12.1</b> Basic Idea</a></li>
<li class="chapter" data-level="12.2" data-path="more-generally.html"><a href="more-generally.html"><i class="fa fa-check"></i><b>12.2</b> More Generally</a></li>
<li class="chapter" data-level="12.3" data-path="generating-pcs-using-r.html"><a href="generating-pcs-using-r.html"><i class="fa fa-check"></i><b>12.3</b> Generating PC’s using R</a></li>
<li class="chapter" data-level="12.4" data-path="using-the-correlation-matrix.html"><a href="using-the-correlation-matrix.html"><i class="fa fa-check"></i><b>12.4</b> Using the correlation matrix</a></li>
<li class="chapter" data-level="12.5" data-path="data-reduction.html"><a href="data-reduction.html"><i class="fa fa-check"></i><b>12.5</b> Data Reduction</a></li>
<li class="chapter" data-level="12.6" data-path="example-analysis-of-depression.html"><a href="example-analysis-of-depression.html"><i class="fa fa-check"></i><b>12.6</b> Example Analysis of depression</a></li>
<li class="chapter" data-level="12.7" data-path="use-in-multiple-regression.html"><a href="use-in-multiple-regression.html"><i class="fa fa-check"></i><b>12.7</b> Use in Multiple Regression</a></li>
<li class="chapter" data-level="12.8" data-path="things-to-watch-out-for.html"><a href="things-to-watch-out-for.html"><i class="fa fa-check"></i><b>12.8</b> Things to watch out for</a></li>
<li class="chapter" data-level="12.9" data-path="additional-references.html"><a href="additional-references.html"><i class="fa fa-check"></i><b>12.9</b> Additional References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="fa.html"><a href="fa.html"><i class="fa fa-check"></i><b>13</b> Factor Analysis</a><ul>
<li class="chapter" data-level="13.1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>13.1</b> Introduction</a><ul>
<li class="chapter" data-level="13.1.1" data-path="introduction.html"><a href="introduction.html#latent-constructs"><i class="fa fa-check"></i><b>13.1.1</b> Latent Constructs</a></li>
<li class="chapter" data-level="13.1.2" data-path="introduction.html"><a href="introduction.html#efa-vs-cfa"><i class="fa fa-check"></i><b>13.1.2</b> EFA vs CFA</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="factor-model.html"><a href="factor-model.html"><i class="fa fa-check"></i><b>13.2</b> Factor Model</a><ul>
<li class="chapter" data-level="13.2.1" data-path="factor-model.html"><a href="factor-model.html#comparison-with-pca"><i class="fa fa-check"></i><b>13.2.1</b> Comparison with PCA</a></li>
<li class="chapter" data-level="13.2.2" data-path="factor-model.html"><a href="factor-model.html#implications"><i class="fa fa-check"></i><b>13.2.2</b> Implications</a></li>
<li class="chapter" data-level="13.2.3" data-path="factor-model.html"><a href="factor-model.html#two-big-steps"><i class="fa fa-check"></i><b>13.2.3</b> Two big steps</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="fa-example.html"><a href="fa-example.html"><i class="fa fa-check"></i><b>13.3</b> Example setup</a></li>
<li class="chapter" data-level="13.4" data-path="fa-extract.html"><a href="fa-extract.html"><i class="fa fa-check"></i><b>13.4</b> Factor Extraction</a><ul>
<li class="chapter" data-level="13.4.1" data-path="fa-extract.html"><a href="fa-extract.html#pc-factor-model"><i class="fa fa-check"></i><b>13.4.1</b> PC Factor Model</a></li>
<li class="chapter" data-level="13.4.2" data-path="fa-extract.html"><a href="fa-extract.html#iterated-pc-factor-model"><i class="fa fa-check"></i><b>13.4.2</b> Iterated PC Factor Model</a></li>
<li class="chapter" data-level="13.4.3" data-path="fa-extract.html"><a href="fa-extract.html#maximum-likelihood"><i class="fa fa-check"></i><b>13.4.3</b> Maximum Likelihood</a></li>
<li class="chapter" data-level="13.4.4" data-path="fa-extract.html"><a href="fa-extract.html#example-4"><i class="fa fa-check"></i><b>13.4.4</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="rotating-factors.html"><a href="rotating-factors.html"><i class="fa fa-check"></i><b>13.5</b> Rotating Factors</a><ul>
<li class="chapter" data-level="13.5.1" data-path="rotating-factors.html"><a href="rotating-factors.html#varimax-rotation"><i class="fa fa-check"></i><b>13.5.1</b> Varimax Rotation</a></li>
<li class="chapter" data-level="13.5.2" data-path="rotating-factors.html"><a href="rotating-factors.html#oblique-rotation"><i class="fa fa-check"></i><b>13.5.2</b> Oblique rotation</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="factor-scores.html"><a href="factor-scores.html"><i class="fa fa-check"></i><b>13.6</b> Factor Scores</a></li>
<li class="chapter" data-level="13.7" data-path="what-to-watch-out-for-2.html"><a href="what-to-watch-out-for-2.html"><i class="fa fa-check"></i><b>13.7</b> What to watch out for</a></li>
<li class="chapter" data-level="13.8" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>13.8</b> Additional Resources</a></li>
</ul></li>
<li class="part"><span><b>V Other Topics</b></span></li>
<li class="chapter" data-level="14" data-path="mda.html"><a href="mda.html"><i class="fa fa-check"></i><b>14</b> Missing Data</a><ul>
<li class="chapter" data-level="14.1" data-path="identifying-missing-data.html"><a href="identifying-missing-data.html"><i class="fa fa-check"></i><b>14.1</b> Identifying missing data</a><ul>
<li class="chapter" data-level="14.1.1" data-path="identifying-missing-data.html"><a href="identifying-missing-data.html#visualize-missing-patterns"><i class="fa fa-check"></i><b>14.1.1</b> Visualize missing patterns</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="effects-of-nonresponse.html"><a href="effects-of-nonresponse.html"><i class="fa fa-check"></i><b>14.2</b> Effects of Nonresponse</a></li>
<li class="chapter" data-level="14.3" data-path="missing-data-mechanisms.html"><a href="missing-data-mechanisms.html"><i class="fa fa-check"></i><b>14.3</b> Missing Data Mechanisms</a><ul>
<li class="chapter" data-level="14.3.1" data-path="missing-data-mechanisms.html"><a href="missing-data-mechanisms.html#demonstration-via-simulation"><i class="fa fa-check"></i><b>14.3.1</b> Demonstration via Simulation</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="general-strategies.html"><a href="general-strategies.html"><i class="fa fa-check"></i><b>14.4</b> General strategies</a><ul>
<li class="chapter" data-level="14.4.1" data-path="general-strategies.html"><a href="general-strategies.html#complete-cases-analysis"><i class="fa fa-check"></i><b>14.4.1</b> Complete cases analysis</a></li>
<li class="chapter" data-level="14.4.2" data-path="general-strategies.html"><a href="general-strategies.html#available-case-analysis"><i class="fa fa-check"></i><b>14.4.2</b> Available-case analysis</a></li>
<li class="chapter" data-level="14.4.3" data-path="general-strategies.html"><a href="general-strategies.html#imputation"><i class="fa fa-check"></i><b>14.4.3</b> Imputation</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="imputation-methods.html"><a href="imputation-methods.html"><i class="fa fa-check"></i><b>14.5</b> Imputation Methods</a></li>
<li class="chapter" data-level="14.6" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html"><i class="fa fa-check"></i><b>14.6</b> Multiple Imputation (MI)</a><ul>
<li class="chapter" data-level="14.6.1" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#goals"><i class="fa fa-check"></i><b>14.6.1</b> Goals</a></li>
<li class="chapter" data-level="14.6.2" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#technique"><i class="fa fa-check"></i><b>14.6.2</b> Technique</a></li>
<li class="chapter" data-level="14.6.3" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#mi-as-a-paradigm"><i class="fa fa-check"></i><b>14.6.3</b> MI as a paradigm</a></li>
<li class="chapter" data-level="14.6.4" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#inference-on-mi"><i class="fa fa-check"></i><b>14.6.4</b> Inference on MI</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html"><i class="fa fa-check"></i><b>14.7</b> Multiple Imputation using Chained Equations (MICE)</a><ul>
<li class="chapter" data-level="14.7.1" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#overview"><i class="fa fa-check"></i><b>14.7.1</b> Overview</a></li>
<li class="chapter" data-level="14.7.2" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#process-algorithm"><i class="fa fa-check"></i><b>14.7.2</b> Process / Algorithm</a></li>
<li class="chapter" data-level="14.7.3" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#convergence"><i class="fa fa-check"></i><b>14.7.3</b> Convergence</a></li>
<li class="chapter" data-level="14.7.4" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#imputation-methods-1"><i class="fa fa-check"></i><b>14.7.4</b> Imputation Methods</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="example-prescribed-amount-of-missing-.html"><a href="example-prescribed-amount-of-missing-.html"><i class="fa fa-check"></i><b>14.8</b> Example: Prescribed amount of missing.</a><ul>
<li class="chapter" data-level="14.8.1" data-path="example-prescribed-amount-of-missing-.html"><a href="example-prescribed-amount-of-missing-.html#multiply-impute-the-missing-data-using-mice"><i class="fa fa-check"></i><b>14.8.1</b> Multiply impute the missing data using <code>mice()</code></a></li>
<li class="chapter" data-level="14.8.2" data-path="example-prescribed-amount-of-missing-.html"><a href="example-prescribed-amount-of-missing-.html#check-the-imputation-method-used-on-each-variable."><i class="fa fa-check"></i><b>14.8.2</b> Check the imputation method used on each variable.</a></li>
<li class="chapter" data-level="14.8.3" data-path="example-prescribed-amount-of-missing-.html"><a href="example-prescribed-amount-of-missing-.html#check-convergence"><i class="fa fa-check"></i><b>14.8.3</b> Check Convergence</a></li>
<li class="chapter" data-level="14.8.4" data-path="example-prescribed-amount-of-missing-.html"><a href="example-prescribed-amount-of-missing-.html#look-at-the-values-generated-for-imputation"><i class="fa fa-check"></i><b>14.8.4</b> Look at the values generated for imputation</a></li>
<li class="chapter" data-level="14.8.5" data-path="example-prescribed-amount-of-missing-.html"><a href="example-prescribed-amount-of-missing-.html#create-a-complete-data-set-by-filling-in-the-missing-data-using-the-imputations"><i class="fa fa-check"></i><b>14.8.5</b> Create a complete data set by filling in the missing data using the imputations</a></li>
<li class="chapter" data-level="14.8.6" data-path="example-prescribed-amount-of-missing-.html"><a href="example-prescribed-amount-of-missing-.html#visualize-imputations"><i class="fa fa-check"></i><b>14.8.6</b> Visualize Imputations</a></li>
<li class="chapter" data-level="14.8.7" data-path="example-prescribed-amount-of-missing-.html"><a href="example-prescribed-amount-of-missing-.html#calculating-bias"><i class="fa fa-check"></i><b>14.8.7</b> Calculating bias</a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="final-thoughts.html"><a href="final-thoughts.html"><i class="fa fa-check"></i><b>14.9</b> Final thoughts</a></li>
<li class="chapter" data-level="14.10" data-path="additional-references-1.html"><a href="additional-references-1.html"><i class="fa fa-check"></i><b>14.10</b> Additional References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/norcalbiostat/AppliedStatistics_notes" target="blank">View source on Github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interactions" class="section level2">
<h2><span class="header-section-number">9.4</span> Interactions</h2>
<p>If we care about how species <em>changes</em> the relationship between petal and sepal length, we can fit a model with an <strong>interaction</strong> between sepal length (<span class="math inline">\(x_{1}\)</span>) and species. For this first example let <span class="math inline">\(x_{2}\)</span> be an indicator for when <code>species == setosa</code> . Note that both <em>main effects</em> of sepal length, and setosa species are also included in the model. Interactions are mathematically represented as a multiplication between the two variables that are interacting.</p>
<p><span class="math display">\[ Y_{i} \sim \beta_{0} + \beta_{1}x_{i} + \beta_{2}x_{2i} + \beta_{3}x_{1i}x_{2i}\]</span></p>
<p>Ifwe evaluate this model for both levels of <span class="math inline">\(x_{2}\)</span>, the resulting models are the same as the stratified models.</p>
<p>When <span class="math inline">\(x_{2} = 0\)</span>, the record is on an iris not from the <em>setosa</em> species.</p>
<p><span class="math display">\[ Y_{i} \sim \beta_{0} + \beta_{1}x_{i} + \beta_{2}(0) + \beta_{3}x_{1i}(0)\]</span>
which simplifies to
<span class="math display">\[ Y_{i} \sim \beta_{0} + \beta_{1}x_{i}\]</span></p>
<p>When <span class="math inline">\(x_{2} = 1\)</span>, the record is on an iris of the <em>setosa</em> species.</p>
<p><span class="math display">\[ Y_{i} \sim \beta_{0} + \beta_{1}x_{i} + \beta_{2}(1) + \beta_{3}x_{1i}(1)\]</span>
which simplifies to
<span class="math display">\[ Y_{i} \sim (\beta_{0} + \beta_{2}) + (\beta_{1} + \beta_{3})x_{i}\]</span></p>
<p>Each subgroup model has a different intercept and slope, but we had to estimate 4 parameters in the interaction model, and 6 for the fully stratified model.</p>
<p>Interactions are fit in <code>R</code> by simply multiplying <code>*</code> the two variables together in the model statement.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" title="1"><span class="kw">summary</span>(<span class="kw">lm</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Sepal.Length <span class="op">+</span><span class="st"> </span>setosa <span class="op">+</span><span class="st"> </span>Sepal.Length<span class="op">*</span>setosa, <span class="dt">data=</span>iris))</a>
<a class="sourceLine" id="cb171-2" title="2"><span class="co">## </span></a>
<a class="sourceLine" id="cb171-3" title="3"><span class="co">## Call:</span></a>
<a class="sourceLine" id="cb171-4" title="4"><span class="co">## lm(formula = Petal.Length ~ Sepal.Length + setosa + Sepal.Length * </span></a>
<a class="sourceLine" id="cb171-5" title="5"><span class="co">##     setosa, data = iris)</span></a>
<a class="sourceLine" id="cb171-6" title="6"><span class="co">## </span></a>
<a class="sourceLine" id="cb171-7" title="7"><span class="co">## Residuals:</span></a>
<a class="sourceLine" id="cb171-8" title="8"><span class="co">##      Min       1Q   Median       3Q      Max </span></a>
<a class="sourceLine" id="cb171-9" title="9"><span class="co">## -0.96754 -0.19948 -0.01386  0.22597  1.05479 </span></a>
<a class="sourceLine" id="cb171-10" title="10"><span class="co">## </span></a>
<a class="sourceLine" id="cb171-11" title="11"><span class="co">## Coefficients:</span></a>
<a class="sourceLine" id="cb171-12" title="12"><span class="co">##                     Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb171-13" title="13"><span class="co">## (Intercept)         -1.55571    0.37509  -4.148 5.68e-05 ***</span></a>
<a class="sourceLine" id="cb171-14" title="14"><span class="co">## Sepal.Length         1.03189    0.05957  17.322  &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb171-15" title="15"><span class="co">## setosa               2.35877    0.88266   2.672  0.00839 ** </span></a>
<a class="sourceLine" id="cb171-16" title="16"><span class="co">## Sepal.Length:setosa -0.90026    0.17000  -5.296 4.28e-07 ***</span></a>
<a class="sourceLine" id="cb171-17" title="17"><span class="co">## ---</span></a>
<a class="sourceLine" id="cb171-18" title="18"><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb171-19" title="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb171-20" title="20"><span class="co">## Residual standard error: 0.3929 on 146 degrees of freedom</span></a>
<a class="sourceLine" id="cb171-21" title="21"><span class="co">## Multiple R-squared:  0.9515, Adjusted R-squared:  0.9505 </span></a>
<a class="sourceLine" id="cb171-22" title="22"><span class="co">## F-statistic: 954.1 on 3 and 146 DF,  p-value: &lt; 2.2e-16</span></a></code></pre></div>
<p>The coefficient <span class="math inline">\(b_{3}\)</span> for the interaction term is significant, confirming that species changes the relationship between sepal length and petal length.</p>
<div id="example-2" class="section level3">
<h3><span class="header-section-number">9.4.1</span> Example</h3>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" title="1"><span class="kw">summary</span>(<span class="kw">lm</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Sepal.Length <span class="op">+</span><span class="st"> </span>setosa <span class="op">+</span><span class="st"> </span>Sepal.Length<span class="op">*</span>setosa, <span class="dt">data=</span>iris))</a>
<a class="sourceLine" id="cb172-2" title="2"><span class="co">## </span></a>
<a class="sourceLine" id="cb172-3" title="3"><span class="co">## Call:</span></a>
<a class="sourceLine" id="cb172-4" title="4"><span class="co">## lm(formula = Petal.Length ~ Sepal.Length + setosa + Sepal.Length * </span></a>
<a class="sourceLine" id="cb172-5" title="5"><span class="co">##     setosa, data = iris)</span></a>
<a class="sourceLine" id="cb172-6" title="6"><span class="co">## </span></a>
<a class="sourceLine" id="cb172-7" title="7"><span class="co">## Residuals:</span></a>
<a class="sourceLine" id="cb172-8" title="8"><span class="co">##      Min       1Q   Median       3Q      Max </span></a>
<a class="sourceLine" id="cb172-9" title="9"><span class="co">## -0.96754 -0.19948 -0.01386  0.22597  1.05479 </span></a>
<a class="sourceLine" id="cb172-10" title="10"><span class="co">## </span></a>
<a class="sourceLine" id="cb172-11" title="11"><span class="co">## Coefficients:</span></a>
<a class="sourceLine" id="cb172-12" title="12"><span class="co">##                     Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb172-13" title="13"><span class="co">## (Intercept)         -1.55571    0.37509  -4.148 5.68e-05 ***</span></a>
<a class="sourceLine" id="cb172-14" title="14"><span class="co">## Sepal.Length         1.03189    0.05957  17.322  &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb172-15" title="15"><span class="co">## setosa               2.35877    0.88266   2.672  0.00839 ** </span></a>
<a class="sourceLine" id="cb172-16" title="16"><span class="co">## Sepal.Length:setosa -0.90026    0.17000  -5.296 4.28e-07 ***</span></a>
<a class="sourceLine" id="cb172-17" title="17"><span class="co">## ---</span></a>
<a class="sourceLine" id="cb172-18" title="18"><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb172-19" title="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb172-20" title="20"><span class="co">## Residual standard error: 0.3929 on 146 degrees of freedom</span></a>
<a class="sourceLine" id="cb172-21" title="21"><span class="co">## Multiple R-squared:  0.9515, Adjusted R-squared:  0.9505 </span></a>
<a class="sourceLine" id="cb172-22" title="22"><span class="co">## F-statistic: 954.1 on 3 and 146 DF,  p-value: &lt; 2.2e-16</span></a></code></pre></div>
<ul>
<li>If <span class="math inline">\(x_{2}=0\)</span>, then the effect of <span class="math inline">\(x_{1}\)</span> on <span class="math inline">\(Y\)</span> simplifies to: <span class="math inline">\(\beta_{1}\)</span>
<ul>
<li><span class="math inline">\(b_{1}\)</span> The effect of sepal length on petal length <strong>for non-setosa species of iris</strong> (<code>setosa=0</code>)</li>
<li>For non-setosa species, the petal length increases 1.03cm for every additional cm of sepal length.</li>
</ul></li>
<li>If <span class="math inline">\(x_{2}=1\)</span>, then the effect of <span class="math inline">\(x_{1}\)</span> on <span class="math inline">\(Y\)</span> model simplifies to: <span class="math inline">\(\beta_{1} + \beta_{3}\)</span>
<ul>
<li>For setosa species, the petal length increases by <code>1.03-0.9=0.13</code> cm for every additional cm of sepal length.</li>
</ul></li>
</ul>

<div class="rmdcaution">
The main effects (<span class="math inline">\(b_{1}\)</span>, <span class="math inline">\(b_{2}\)</span>) cannot be interpreted by themselves when there is an interaction in the model.
</div>

<p>Let’s up the game now and look at the full interaction model with a categorical version of species. Recall <span class="math inline">\(x_{1}\)</span> is Sepal Length, <span class="math inline">\(x_{2}\)</span> is the indicator for <em>versicolor</em>, and <span class="math inline">\(x_{3}\)</span> the indicator for <em>virginica</em> .</p>
<p><span class="math display">\[ Y_{i} \sim \beta_{0} + \beta_{1}x_{i} + \beta_{2}x_{2i} + \beta_{3}x_{3i} + \beta_{4}x_{1i}x_{2i} + \beta_{5}x_{1i}x_{3i}+\epsilon_{i}\]</span></p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" title="1"><span class="kw">summary</span>(<span class="kw">lm</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Sepal.Length <span class="op">+</span><span class="st"> </span>Species <span class="op">+</span><span class="st"> </span>Sepal.Length<span class="op">*</span>Species, <span class="dt">data=</span>iris))</a>
<a class="sourceLine" id="cb173-2" title="2"><span class="co">## </span></a>
<a class="sourceLine" id="cb173-3" title="3"><span class="co">## Call:</span></a>
<a class="sourceLine" id="cb173-4" title="4"><span class="co">## lm(formula = Petal.Length ~ Sepal.Length + Species + Sepal.Length * </span></a>
<a class="sourceLine" id="cb173-5" title="5"><span class="co">##     Species, data = iris)</span></a>
<a class="sourceLine" id="cb173-6" title="6"><span class="co">## </span></a>
<a class="sourceLine" id="cb173-7" title="7"><span class="co">## Residuals:</span></a>
<a class="sourceLine" id="cb173-8" title="8"><span class="co">##      Min       1Q   Median       3Q      Max </span></a>
<a class="sourceLine" id="cb173-9" title="9"><span class="co">## -0.68611 -0.13442 -0.00856  0.15966  0.79607 </span></a>
<a class="sourceLine" id="cb173-10" title="10"><span class="co">## </span></a>
<a class="sourceLine" id="cb173-11" title="11"><span class="co">## Coefficients:</span></a>
<a class="sourceLine" id="cb173-12" title="12"><span class="co">##                                Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb173-13" title="13"><span class="co">## (Intercept)                      0.8031     0.5310   1.512    0.133    </span></a>
<a class="sourceLine" id="cb173-14" title="14"><span class="co">## Sepal.Length                     0.1316     0.1058   1.244    0.216    </span></a>
<a class="sourceLine" id="cb173-15" title="15"><span class="co">## Speciesversicolor               -0.6179     0.6837  -0.904    0.368    </span></a>
<a class="sourceLine" id="cb173-16" title="16"><span class="co">## Speciesvirginica                -0.1926     0.6578  -0.293    0.770    </span></a>
<a class="sourceLine" id="cb173-17" title="17"><span class="co">## Sepal.Length:Speciesversicolor   0.5548     0.1281   4.330 2.78e-05 ***</span></a>
<a class="sourceLine" id="cb173-18" title="18"><span class="co">## Sepal.Length:Speciesvirginica    0.6184     0.1210   5.111 1.00e-06 ***</span></a>
<a class="sourceLine" id="cb173-19" title="19"><span class="co">## ---</span></a>
<a class="sourceLine" id="cb173-20" title="20"><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb173-21" title="21"><span class="co">## </span></a>
<a class="sourceLine" id="cb173-22" title="22"><span class="co">## Residual standard error: 0.2611 on 144 degrees of freedom</span></a>
<a class="sourceLine" id="cb173-23" title="23"><span class="co">## Multiple R-squared:  0.9789, Adjusted R-squared:  0.9781 </span></a>
<a class="sourceLine" id="cb173-24" title="24"><span class="co">## F-statistic:  1333 on 5 and 144 DF,  p-value: &lt; 2.2e-16</span></a></code></pre></div>
<p>The slope of the relationship between sepal length and petal length is calculated as follows, for each species:</p>
<ul>
<li><em>setosa</em> <span class="math inline">\((x_{2}=0, x_{3}=0): b_{1}=0.13\)</span></li>
<li><em>versicolor</em> <span class="math inline">\((x_{2}=1, x_{3}=0): b_{1} + b_{2} + b_{4} = 0.13+0.55 = 0.68\)</span></li>
<li><em>virginica</em> <span class="math inline">\((x_{2}=0, x_{3}=1): b_{1} + b_{3} + b_{5} = 0.13+0.62 = 0.75\)</span></li>
</ul>
<p>Compare this to the estimates gained from the stratified model:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" title="1"><span class="kw">coef</span>(<span class="kw">lm</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Sepal.Length, <span class="dt">data=</span><span class="kw">subset</span>(iris, Species<span class="op">==</span><span class="st">&quot;setosa&quot;</span>)))</a>
<a class="sourceLine" id="cb174-2" title="2"><span class="co">##  (Intercept) Sepal.Length </span></a>
<a class="sourceLine" id="cb174-3" title="3"><span class="co">##    0.8030518    0.1316317</span></a>
<a class="sourceLine" id="cb174-4" title="4"><span class="kw">coef</span>(<span class="kw">lm</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Sepal.Length, <span class="dt">data=</span><span class="kw">subset</span>(iris, Species<span class="op">==</span><span class="st">&quot;versicolor&quot;</span>)))</a>
<a class="sourceLine" id="cb174-5" title="5"><span class="co">##  (Intercept) Sepal.Length </span></a>
<a class="sourceLine" id="cb174-6" title="6"><span class="co">##    0.1851155    0.6864698</span></a>
<a class="sourceLine" id="cb174-7" title="7"><span class="kw">coef</span>(<span class="kw">lm</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Sepal.Length, <span class="dt">data=</span><span class="kw">subset</span>(iris, Species<span class="op">==</span><span class="st">&quot;virginica&quot;</span>)))</a>
<a class="sourceLine" id="cb174-8" title="8"><span class="co">##  (Intercept) Sepal.Length </span></a>
<a class="sourceLine" id="cb174-9" title="9"><span class="co">##    0.6104680    0.7500808</span></a></code></pre></div>
<p>They’re the same! Proof that an interaction is equivalent to stratification.</p>
</div>
<div id="example-3" class="section level3">
<h3><span class="header-section-number">9.4.2</span> Example</h3>
<p>What if we now wanted to include other predictors in the model? How does sepal length relate to petal length after controlling for petal width? We add the variable for petal width into the model</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" title="1"><span class="kw">summary</span>(<span class="kw">lm</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Sepal.Length <span class="op">+</span><span class="st"> </span>setosa <span class="op">+</span><span class="st"> </span>Sepal.Length<span class="op">*</span>setosa <span class="op">+</span><span class="st"> </span>Petal.Width, <span class="dt">data=</span>iris))</a>
<a class="sourceLine" id="cb175-2" title="2"><span class="co">## </span></a>
<a class="sourceLine" id="cb175-3" title="3"><span class="co">## Call:</span></a>
<a class="sourceLine" id="cb175-4" title="4"><span class="co">## lm(formula = Petal.Length ~ Sepal.Length + setosa + Sepal.Length * </span></a>
<a class="sourceLine" id="cb175-5" title="5"><span class="co">##     setosa + Petal.Width, data = iris)</span></a>
<a class="sourceLine" id="cb175-6" title="6"><span class="co">## </span></a>
<a class="sourceLine" id="cb175-7" title="7"><span class="co">## Residuals:</span></a>
<a class="sourceLine" id="cb175-8" title="8"><span class="co">##      Min       1Q   Median       3Q      Max </span></a>
<a class="sourceLine" id="cb175-9" title="9"><span class="co">## -0.83519 -0.18278 -0.01812  0.17004  1.06968 </span></a>
<a class="sourceLine" id="cb175-10" title="10"><span class="co">## </span></a>
<a class="sourceLine" id="cb175-11" title="11"><span class="co">## Coefficients:</span></a>
<a class="sourceLine" id="cb175-12" title="12"><span class="co">##                     Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb175-13" title="13"><span class="co">## (Intercept)         -0.86850    0.27028  -3.213  0.00162 ** </span></a>
<a class="sourceLine" id="cb175-14" title="14"><span class="co">## Sepal.Length         0.66181    0.05179  12.779  &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb175-15" title="15"><span class="co">## setosa               1.83713    0.62355   2.946  0.00375 ** </span></a>
<a class="sourceLine" id="cb175-16" title="16"><span class="co">## Petal.Width          0.97269    0.07970  12.204  &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb175-17" title="17"><span class="co">## Sepal.Length:setosa -0.61106    0.12213  -5.003 1.61e-06 ***</span></a>
<a class="sourceLine" id="cb175-18" title="18"><span class="co">## ---</span></a>
<a class="sourceLine" id="cb175-19" title="19"><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb175-20" title="20"><span class="co">## </span></a>
<a class="sourceLine" id="cb175-21" title="21"><span class="co">## Residual standard error: 0.2769 on 145 degrees of freedom</span></a>
<a class="sourceLine" id="cb175-22" title="22"><span class="co">## Multiple R-squared:  0.9761, Adjusted R-squared:  0.9754 </span></a>
<a class="sourceLine" id="cb175-23" title="23"><span class="co">## F-statistic:  1478 on 4 and 145 DF,  p-value: &lt; 2.2e-16</span></a></code></pre></div>
<p>So far, petal width, and the combination of species and sepal length are both significantly associated with petal length.</p>
<p><em>Note of caution: Stratification implies that the stratifying variable interacts with all other variables.</em>
So if we were to go back to the stratified model where we fit the model of petal length on sepal length AND petal width, stratified by species, we would be implying that species interacts with both sepal length and petal width.</p>
<p>E.g. the following stratified model</p>
<ul>
<li><span class="math inline">\(Y = A + B + C + D + C*D\)</span>, when D=1</li>
<li><span class="math inline">\(Y = A + B + C + D + C*D\)</span>, when D=0</li>
</ul>
<p>is the same as the following interaction model:</p>
<ul>
<li><span class="math inline">\(Y = A + B + C + D + A*D + B*D + C*D\)</span></li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="moderation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="confounding.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
