<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Applied Statistics II</title>
  <meta name="description" content="Course notes for MATH 456 at CSU Chico">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Applied Statistics II" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for MATH 456 at CSU Chico" />
  <meta name="github-repo" content="norcalbiostat/MATH456_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Applied Statistics II" />
  
  <meta name="twitter:description" content="Course notes for MATH 456 at CSU Chico" />
  

<meta name="author" content="Robin A. Donatello and Edward A. Roualdes">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="terminology.html">
<link rel="next" href="spatial-influence.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Statistics II course notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>1</b> Preparing Data for Analysis</a><ul>
<li class="chapter" data-level="1.1" data-path="reproducible-workflows.html"><a href="reproducible-workflows.html"><i class="fa fa-check"></i><b>1.1</b> Reproducible Workflows</a></li>
<li class="chapter" data-level="1.2" data-path="identifying-variable-types.html"><a href="identifying-variable-types.html"><i class="fa fa-check"></i><b>1.2</b> Identifying Variable Types</a></li>
<li class="chapter" data-level="1.3" data-path="data-editing-and-recoding.html"><a href="data-editing-and-recoding.html"><i class="fa fa-check"></i><b>1.3</b> Data Editing and Recoding</a></li>
<li class="chapter" data-level="1.4" data-path="outliers.html"><a href="outliers.html"><i class="fa fa-check"></i><b>1.4</b> Outliers</a></li>
<li class="chapter" data-level="1.5" data-path="data-transformations.html"><a href="data-transformations.html"><i class="fa fa-check"></i><b>1.5</b> Data Transformations</a></li>
<li class="chapter" data-level="1.6" data-path="selecting-appropriate-analysis.html"><a href="selecting-appropriate-analysis.html"><i class="fa fa-check"></i><b>1.6</b> Selecting Appropriate Analysis</a></li>
<li class="chapter" data-level="1.7" data-path="wide-vs-long-data.html"><a href="wide-vs-long-data.html"><i class="fa fa-check"></i><b>1.7</b> Wide vs. Long data</a></li>
<li class="chapter" data-level="1.8" data-path="dealing-with-missing-data-post-analysis.html"><a href="dealing-with-missing-data-post-analysis.html"><i class="fa fa-check"></i><b>1.8</b> Dealing with missing data post-analysis</a></li>
</ul></li>
<li class="part"><span><b>I Regression Modeling</b></span></li>
<li class="chapter" data-level="2" data-path="reg-intro.html"><a href="reg-intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>3</b> Simple Linear Regression</a><ul>
<li class="chapter" data-level="3.1" data-path="mathmatical-model.html"><a href="mathmatical-model.html"><i class="fa fa-check"></i><b>3.1</b> Mathmatical Model</a></li>
<li class="chapter" data-level="3.2" data-path="parameter-estimates.html"><a href="parameter-estimates.html"><i class="fa fa-check"></i><b>3.2</b> Parameter Estimates</a></li>
<li class="chapter" data-level="3.3" data-path="interval-estimation.html"><a href="interval-estimation.html"><i class="fa fa-check"></i><b>3.3</b> Interval estimation</a></li>
<li class="chapter" data-level="3.4" data-path="corelation-coefficient.html"><a href="corelation-coefficient.html"><i class="fa fa-check"></i><b>3.4</b> Corelation Coefficient</a></li>
<li class="chapter" data-level="3.5" data-path="assumptions.html"><a href="assumptions.html"><i class="fa fa-check"></i><b>3.5</b> Assumptions</a></li>
<li class="chapter" data-level="3.6" data-path="example.html"><a href="example.html"><i class="fa fa-check"></i><b>3.6</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>4</b> Multiple Linear Regression</a><ul>
<li class="chapter" data-level="4.1" data-path="types-of-x-variables.html"><a href="types-of-x-variables.html"><i class="fa fa-check"></i><b>4.1</b> Types of X variables</a></li>
<li class="chapter" data-level="4.2" data-path="mathematical-model.html"><a href="mathematical-model.html"><i class="fa fa-check"></i><b>4.2</b> Mathematical Model</a></li>
<li class="chapter" data-level="4.3" data-path="parameter-estimation.html"><a href="parameter-estimation.html"><i class="fa fa-check"></i><b>4.3</b> Parameter Estimation</a></li>
<li class="chapter" data-level="4.4" data-path="example-1.html"><a href="example-1.html"><i class="fa fa-check"></i><b>4.4</b> Example</a></li>
<li class="chapter" data-level="4.5" data-path="model-diagnostics.html"><a href="model-diagnostics.html"><i class="fa fa-check"></i><b>4.5</b> Model Diagnostics</a></li>
<li class="chapter" data-level="4.6" data-path="multicollinearity.html"><a href="multicollinearity.html"><i class="fa fa-check"></i><b>4.6</b> Multicollinearity</a></li>
<li class="chapter" data-level="4.7" data-path="what-to-watch-out-for.html"><a href="what-to-watch-out-for.html"><i class="fa fa-check"></i><b>4.7</b> What to watch out for</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="model-building.html"><a href="model-building.html"><i class="fa fa-check"></i><b>5</b> Model Building</a><ul>
<li class="chapter" data-level="5.1" data-path="categorical-predictors.html"><a href="categorical-predictors.html"><i class="fa fa-check"></i><b>5.1</b> Categorical Predictors</a><ul>
<li class="chapter" data-level="5.1.1" data-path="categorical-predictors.html"><a href="categorical-predictors.html#factor-variable-coding"><i class="fa fa-check"></i><b>5.1.1</b> Factor variable coding</a></li>
<li class="chapter" data-level="5.1.2" data-path="categorical-predictors.html"><a href="categorical-predictors.html#wald-test"><i class="fa fa-check"></i><b>5.1.2</b> Wald test</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="stratification.html"><a href="stratification.html"><i class="fa fa-check"></i><b>5.2</b> Stratification</a></li>
<li class="chapter" data-level="5.3" data-path="moderation.html"><a href="moderation.html"><i class="fa fa-check"></i><b>5.3</b> Moderation</a><ul>
<li class="chapter" data-level="5.3.1" data-path="moderation.html"><a href="moderation.html#example-1-sepal-vs-petal-length"><i class="fa fa-check"></i><b>5.3.1</b> Example 1: Sepal vs Petal Length</a></li>
<li class="chapter" data-level="5.3.2" data-path="moderation.html"><a href="moderation.html#example-2-simpsons-paradox"><i class="fa fa-check"></i><b>5.3.2</b> Example 2: Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>5.4</b> Interactions</a><ul>
<li class="chapter" data-level="5.4.1" data-path="interactions.html"><a href="interactions.html#example-2"><i class="fa fa-check"></i><b>5.4.1</b> Example</a></li>
<li class="chapter" data-level="5.4.2" data-path="interactions.html"><a href="interactions.html#example-3"><i class="fa fa-check"></i><b>5.4.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="confounding.html"><a href="confounding.html"><i class="fa fa-check"></i><b>5.5</b> Confounding</a></li>
<li class="chapter" data-level="5.6" data-path="variable-selection-process.html"><a href="variable-selection-process.html"><i class="fa fa-check"></i><b>5.6</b> Variable Selection Process</a><ul>
<li class="chapter" data-level="5.6.1" data-path="variable-selection-process.html"><a href="variable-selection-process.html#automated-selection-procedures"><i class="fa fa-check"></i><b>5.6.1</b> Automated selection procedures</a></li>
<li class="chapter" data-level="5.6.2" data-path="variable-selection-process.html"><a href="variable-selection-process.html#the-lesser-of-three-evils-best-subsets-pma5-section-8.7"><i class="fa fa-check"></i><b>5.6.2</b> The lesser of three evils: Best Subsets (PMA5 Section 8.7)</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="comparing-between-models.html"><a href="comparing-between-models.html"><i class="fa fa-check"></i><b>5.7</b> Comparing between models</a></li>
<li class="chapter" data-level="5.8" data-path="what-to-watch-out-for-1.html"><a href="what-to-watch-out-for-1.html"><i class="fa fa-check"></i><b>5.8</b> What to watch out for</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>6</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="6.1" data-path="fitting-glms-in-r.html"><a href="fitting-glms-in-r.html"><i class="fa fa-check"></i><b>6.1</b> Fitting GLMs in R</a></li>
<li class="chapter" data-level="6.2" data-path="binary-data.html"><a href="binary-data.html"><i class="fa fa-check"></i><b>6.2</b> Binary Data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="binary-data.html"><a href="binary-data.html#example-the-effect-of-gender-on-depression"><i class="fa fa-check"></i><b>6.2.1</b> Example: The effect of gender on Depression</a></li>
<li class="chapter" data-level="6.2.2" data-path="binary-data.html"><a href="binary-data.html#multiple-logistic-regression"><i class="fa fa-check"></i><b>6.2.2</b> Multiple Logistic Regression</a></li>
<li class="chapter" data-level="6.2.3" data-path="binary-data.html"><a href="binary-data.html#interpretation"><i class="fa fa-check"></i><b>6.2.3</b> Interpretation</a></li>
<li class="chapter" data-level="6.2.4" data-path="binary-data.html"><a href="binary-data.html#goodness-of-fit"><i class="fa fa-check"></i><b>6.2.4</b> Goodness of Fit</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="classification-of-binary-outcomes.html"><a href="classification-of-binary-outcomes.html"><i class="fa fa-check"></i><b>6.3</b> Classification of Binary outcomes</a><ul>
<li class="chapter" data-level="6.3.1" data-path="classification-of-binary-outcomes.html"><a href="classification-of-binary-outcomes.html#calculating-predictions"><i class="fa fa-check"></i><b>6.3.1</b> Calculating predictions</a></li>
<li class="chapter" data-level="6.3.2" data-path="classification-of-binary-outcomes.html"><a href="classification-of-binary-outcomes.html#roc-curves"><i class="fa fa-check"></i><b>6.3.2</b> ROC Curves</a></li>
<li class="chapter" data-level="6.3.3" data-path="classification-of-binary-outcomes.html"><a href="classification-of-binary-outcomes.html#model-performance"><i class="fa fa-check"></i><b>6.3.3</b> Model Performance</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="categorical-data.html"><a href="categorical-data.html"><i class="fa fa-check"></i><b>6.4</b> Categorical Data</a></li>
<li class="chapter" data-level="6.5" data-path="count-data.html"><a href="count-data.html"><i class="fa fa-check"></i><b>6.5</b> Count Data</a></li>
</ul></li>
<li class="part"><span><b>II Multivariate Analysis</b></span></li>
<li class="chapter" data-level="7" data-path="mv-intro.html"><a href="mv-intro.html"><i class="fa fa-check"></i><b>7</b> Introduction</a></li>
<li class="chapter" data-level="8" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>8</b> Principal Component Analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="basic-idea.html"><a href="basic-idea.html"><i class="fa fa-check"></i><b>8.1</b> Basic Idea</a></li>
<li class="chapter" data-level="8.2" data-path="more-generally.html"><a href="more-generally.html"><i class="fa fa-check"></i><b>8.2</b> More Generally</a></li>
<li class="chapter" data-level="8.3" data-path="generating-pcs-using-r.html"><a href="generating-pcs-using-r.html"><i class="fa fa-check"></i><b>8.3</b> Generating PC’s using R</a></li>
<li class="chapter" data-level="8.4" data-path="using-the-correlation-matrix.html"><a href="using-the-correlation-matrix.html"><i class="fa fa-check"></i><b>8.4</b> Using the correlation matrix</a></li>
<li class="chapter" data-level="8.5" data-path="data-reduction.html"><a href="data-reduction.html"><i class="fa fa-check"></i><b>8.5</b> Data Reduction</a></li>
<li class="chapter" data-level="8.6" data-path="example-analysis-of-depression.html"><a href="example-analysis-of-depression.html"><i class="fa fa-check"></i><b>8.6</b> Example Analysis of depression</a></li>
<li class="chapter" data-level="8.7" data-path="use-in-multiple-regression.html"><a href="use-in-multiple-regression.html"><i class="fa fa-check"></i><b>8.7</b> Use in Multiple Regression</a></li>
<li class="chapter" data-level="8.8" data-path="things-to-watch-out-for.html"><a href="things-to-watch-out-for.html"><i class="fa fa-check"></i><b>8.8</b> Things to watch out for</a></li>
<li class="chapter" data-level="8.9" data-path="additional-references.html"><a href="additional-references.html"><i class="fa fa-check"></i><b>8.9</b> Additional References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="fa.html"><a href="fa.html"><i class="fa fa-check"></i><b>9</b> Factor Analysis</a><ul>
<li class="chapter" data-level="9.1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>9.1</b> Introduction</a><ul>
<li class="chapter" data-level="9.1.1" data-path="introduction.html"><a href="introduction.html#latent-constructs"><i class="fa fa-check"></i><b>9.1.1</b> Latent Constructs</a></li>
<li class="chapter" data-level="9.1.2" data-path="introduction.html"><a href="introduction.html#efa-vs-cfa"><i class="fa fa-check"></i><b>9.1.2</b> EFA vs CFA</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="factor-model.html"><a href="factor-model.html"><i class="fa fa-check"></i><b>9.2</b> Factor Model</a><ul>
<li class="chapter" data-level="9.2.1" data-path="factor-model.html"><a href="factor-model.html#comparison-with-pca"><i class="fa fa-check"></i><b>9.2.1</b> Comparison with PCA</a></li>
<li class="chapter" data-level="9.2.2" data-path="factor-model.html"><a href="factor-model.html#implications"><i class="fa fa-check"></i><b>9.2.2</b> Implications</a></li>
<li class="chapter" data-level="9.2.3" data-path="factor-model.html"><a href="factor-model.html#two-big-steps"><i class="fa fa-check"></i><b>9.2.3</b> Two big steps</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="fa-example.html"><a href="fa-example.html"><i class="fa fa-check"></i><b>9.3</b> Example setup</a></li>
<li class="chapter" data-level="9.4" data-path="fa-extract.html"><a href="fa-extract.html"><i class="fa fa-check"></i><b>9.4</b> Factor Extraction</a><ul>
<li class="chapter" data-level="9.4.1" data-path="fa-extract.html"><a href="fa-extract.html#pc-factor-model"><i class="fa fa-check"></i><b>9.4.1</b> PC Factor Model</a></li>
<li class="chapter" data-level="9.4.2" data-path="fa-extract.html"><a href="fa-extract.html#iterated-pc-factor-model"><i class="fa fa-check"></i><b>9.4.2</b> Iterated PC Factor Model</a></li>
<li class="chapter" data-level="9.4.3" data-path="fa-extract.html"><a href="fa-extract.html#maximum-likelihood"><i class="fa fa-check"></i><b>9.4.3</b> Maximum Likelihood</a></li>
<li class="chapter" data-level="9.4.4" data-path="fa-extract.html"><a href="fa-extract.html#example-4"><i class="fa fa-check"></i><b>9.4.4</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="rotating-factors.html"><a href="rotating-factors.html"><i class="fa fa-check"></i><b>9.5</b> Rotating Factors</a><ul>
<li class="chapter" data-level="9.5.1" data-path="rotating-factors.html"><a href="rotating-factors.html#varimax-rotation"><i class="fa fa-check"></i><b>9.5.1</b> Varimax Rotation</a></li>
<li class="chapter" data-level="9.5.2" data-path="rotating-factors.html"><a href="rotating-factors.html#oblique-rotation"><i class="fa fa-check"></i><b>9.5.2</b> Oblique rotation</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="factor-scores.html"><a href="factor-scores.html"><i class="fa fa-check"></i><b>9.6</b> Factor Scores</a></li>
<li class="chapter" data-level="9.7" data-path="what-to-watch-out-for-2.html"><a href="what-to-watch-out-for-2.html"><i class="fa fa-check"></i><b>9.7</b> What to watch out for</a></li>
<li class="chapter" data-level="9.8" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>9.8</b> Additional Resources</a></li>
</ul></li>
<li class="part"><span><b>III Multi-level Modeling</b></span></li>
<li class="chapter" data-level="10" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>10</b> Introduction</a><ul>
<li class="chapter" data-level="10.1" data-path="example-school-data.html"><a href="example-school-data.html"><i class="fa fa-check"></i><b>10.1</b> Example School Data</a></li>
<li class="chapter" data-level="10.2" data-path="multi-level-models.html"><a href="multi-level-models.html"><i class="fa fa-check"></i><b>10.2</b> Multi-level models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="RI.html"><a href="RI.html"><i class="fa fa-check"></i><b>11</b> Random Intercept Models</a><ul>
<li class="chapter" data-level="11.1" data-path="pooling.html"><a href="pooling.html"><i class="fa fa-check"></i><b>11.1</b> Pooling</a></li>
<li class="chapter" data-level="11.2" data-path="mathematical-models.html"><a href="mathematical-models.html"><i class="fa fa-check"></i><b>11.2</b> Mathematical Models</a><ul>
<li class="chapter" data-level="11.2.1" data-path="mathematical-models.html"><a href="mathematical-models.html#complete-pooling"><i class="fa fa-check"></i><b>11.2.1</b> Complete Pooling</a></li>
<li class="chapter" data-level="11.2.2" data-path="mathematical-models.html"><a href="mathematical-models.html#no-pooling"><i class="fa fa-check"></i><b>11.2.2</b> No Pooling</a></li>
<li class="chapter" data-level="11.2.3" data-path="mathematical-models.html"><a href="mathematical-models.html#partial-pooling-ri"><i class="fa fa-check"></i><b>11.2.3</b> Partial Pooling (RI)</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="components-of-variance.html"><a href="components-of-variance.html"><i class="fa fa-check"></i><b>11.3</b> Components of Variance</a></li>
<li class="chapter" data-level="11.4" data-path="fitri.html"><a href="fitri.html"><i class="fa fa-check"></i><b>11.4</b> Fitting models in R</a><ul>
<li class="chapter" data-level="11.4.1" data-path="fitri.html"><a href="fitri.html#comparison-of-estimates"><i class="fa fa-check"></i><b>11.4.1</b> Comparison of estimates</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="estimation-methods.html"><a href="estimation-methods.html"><i class="fa fa-check"></i><b>11.5</b> Estimation Methods</a></li>
<li class="chapter" data-level="11.6" data-path="including-covariates.html"><a href="including-covariates.html"><i class="fa fa-check"></i><b>11.6</b> Including Covariates</a></li>
<li class="chapter" data-level="11.7" data-path="centering-terms.html"><a href="centering-terms.html"><i class="fa fa-check"></i><b>11.7</b> Centering terms</a><ul>
<li class="chapter" data-level="11.7.1" data-path="centering-terms.html"><a href="centering-terms.html#a-generic-dplyr-approach-to-centering."><i class="fa fa-check"></i><b>11.7.1</b> A generic <code>dplyr</code> approach to centering.</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="specifying-correlation-structures.html"><a href="specifying-correlation-structures.html"><i class="fa fa-check"></i><b>11.8</b> Specifying Correlation Structures</a><ul>
<li class="chapter" data-level="11.8.1" data-path="specifying-correlation-structures.html"><a href="specifying-correlation-structures.html#specifying-different-covariance-structures-in-r"><i class="fa fa-check"></i><b>11.8.1</b> Specifying different covariance structures in R</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="additional-references-1.html"><a href="additional-references-1.html"><i class="fa fa-check"></i><b>11.9</b> Additional References</a><ul>
<li class="chapter" data-level="11.9.1" data-path="additional-references-1.html"><a href="additional-references-1.html#package-vignettes"><i class="fa fa-check"></i><b>11.9.1</b> Package Vignettes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="longitudinal.html"><a href="longitudinal.html"><i class="fa fa-check"></i><b>12</b> Longitudinal Data</a><ul>
<li class="chapter" data-level="12.1" data-path="pediatric-pain-data.html"><a href="pediatric-pain-data.html"><i class="fa fa-check"></i><b>12.1</b> Pediatric pain data</a><ul>
<li class="chapter" data-level="12.1.1" data-path="pediatric-pain-data.html"><a href="pediatric-pain-data.html#data-sample"><i class="fa fa-check"></i><b>12.1.1</b> Data sample</a></li>
<li class="chapter" data-level="12.1.2" data-path="pediatric-pain-data.html"><a href="pediatric-pain-data.html#univariate-visualizations"><i class="fa fa-check"></i><b>12.1.2</b> Univariate Visualizations</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="visualizing-longitudinal-data.html"><a href="visualizing-longitudinal-data.html"><i class="fa fa-check"></i><b>12.2</b> Visualizing longitudinal data</a><ul>
<li class="chapter" data-level="12.2.1" data-path="visualizing-longitudinal-data.html"><a href="visualizing-longitudinal-data.html#profile-or-spaghetti-plots"><i class="fa fa-check"></i><b>12.2.1</b> Profile or spaghetti plots</a></li>
<li class="chapter" data-level="12.2.2" data-path="visualizing-longitudinal-data.html"><a href="visualizing-longitudinal-data.html#corrmat"><i class="fa fa-check"></i><b>12.2.2</b> Correlation of pain tolerance within person across time</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="analyze-pain-tolerance-across-coping-style.html"><a href="analyze-pain-tolerance-across-coping-style.html"><i class="fa fa-check"></i><b>12.3</b> Analyze pain tolerance across coping style</a><ul>
<li class="chapter" data-level="12.3.1" data-path="analyze-pain-tolerance-across-coping-style.html"><a href="analyze-pain-tolerance-across-coping-style.html#two-sample-t-test"><i class="fa fa-check"></i><b>12.3.1</b> Two Sample T-test</a></li>
<li class="chapter" data-level="12.3.2" data-path="analyze-pain-tolerance-across-coping-style.html"><a href="analyze-pain-tolerance-across-coping-style.html#averaged-over-the-observed-baseline-values."><i class="fa fa-check"></i><b>12.3.2</b> Averaged over the observed baseline values.</a></li>
<li class="chapter" data-level="12.3.3" data-path="analyze-pain-tolerance-across-coping-style.html"><a href="analyze-pain-tolerance-across-coping-style.html#missing-data"><i class="fa fa-check"></i><b>12.3.3</b> Missing Data</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="paired-t-tests.html"><a href="paired-t-tests.html"><i class="fa fa-check"></i><b>12.4</b> Paired t-tests</a><ul>
<li class="chapter" data-level="12.4.1" data-path="paired-t-tests.html"><a href="paired-t-tests.html#but-what-about-treatment-groups"><i class="fa fa-check"></i><b>12.4.1</b> But what about treatment groups?</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="random-intercept-model.html"><a href="random-intercept-model.html"><i class="fa fa-check"></i><b>12.5</b> Random Intercept Model</a></li>
<li class="chapter" data-level="12.6" data-path="writing-contrasts.html"><a href="writing-contrasts.html"><i class="fa fa-check"></i><b>12.6</b> Writing Contrasts</a><ul>
<li class="chapter" data-level="12.6.1" data-path="writing-contrasts.html"><a href="writing-contrasts.html#comparing-groups-contrasts-subtracting-l_1-from-l_2"><i class="fa fa-check"></i><b>12.6.1</b> Comparing groups (contrasts) Subtracting <span class="math inline">\(L_{1}\)</span> from <span class="math inline">\(L_{2}\)</span></a></li>
<li class="chapter" data-level="12.6.2" data-path="writing-contrasts.html"><a href="writing-contrasts.html#confidence-intervals-of-those-estimates"><i class="fa fa-check"></i><b>12.6.2</b> Confidence intervals of those estimates</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="what-to-watch-out-for-3.html"><a href="what-to-watch-out-for-3.html"><i class="fa fa-check"></i><b>12.7</b> What to watch out for</a></li>
<li class="chapter" data-level="12.8" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>12.8</b> Additional Resources</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="spatial.html"><a href="spatial.html"><i class="fa fa-check"></i><b>13</b> Spatial Data</a><ul>
<li class="chapter" data-level="13.1" data-path="terminology.html"><a href="terminology.html"><i class="fa fa-check"></i><b>13.1</b> Terminology</a></li>
<li class="chapter" data-level="13.2" data-path="mapping-in-r.html"><a href="mapping-in-r.html"><i class="fa fa-check"></i><b>13.2</b> Mapping in R</a><ul>
<li class="chapter" data-level="13.2.1" data-path="mapping-in-r.html"><a href="mapping-in-r.html#plotting-region-polygons"><i class="fa fa-check"></i><b>13.2.1</b> Plotting Region polygons</a></li>
<li class="chapter" data-level="13.2.2" data-path="mapping-in-r.html"><a href="mapping-in-r.html#plotting-points"><i class="fa fa-check"></i><b>13.2.2</b> Plotting points</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="spatial-influence.html"><a href="spatial-influence.html"><i class="fa fa-check"></i><b>13.3</b> Spatial Influence</a><ul>
<li class="chapter" data-level="13.3.1" data-path="spatial-influence.html"><a href="spatial-influence.html#distance-between-points"><i class="fa fa-check"></i><b>13.3.1</b> Distance between points</a></li>
<li class="chapter" data-level="13.3.2" data-path="spatial-influence.html"><a href="spatial-influence.html#spatial-weights-matrix"><i class="fa fa-check"></i><b>13.3.2</b> Spatial Weights Matrix</a></li>
<li class="chapter" data-level="13.3.3" data-path="spatial-influence.html"><a href="spatial-influence.html#identifying-neighbors"><i class="fa fa-check"></i><b>13.3.3</b> Identifying Neighbors</a></li>
<li class="chapter" data-level="13.3.4" data-path="spatial-influence.html"><a href="spatial-influence.html#neighborhood-matrix"><i class="fa fa-check"></i><b>13.3.4</b> Neighborhood matrix</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="modeling-geographically-correlated-data.html"><a href="modeling-geographically-correlated-data.html"><i class="fa fa-check"></i><b>13.4</b> Modeling geographically correlated data</a><ul>
<li class="chapter" data-level="13.4.1" data-path="modeling-geographically-correlated-data.html"><a href="modeling-geographically-correlated-data.html#geographically-weighted-regression"><i class="fa fa-check"></i><b>13.4.1</b> Geographically weighted regression</a></li>
<li class="chapter" data-level="13.4.2" data-path="modeling-geographically-correlated-data.html"><a href="modeling-geographically-correlated-data.html#bayesian-models"><i class="fa fa-check"></i><b>13.4.2</b> Bayesian Models</a></li>
<li class="chapter" data-level="13.4.3" data-path="modeling-geographically-correlated-data.html"><a href="modeling-geographically-correlated-data.html#random-intercept-model-1"><i class="fa fa-check"></i><b>13.4.3</b> Random Intercept Model</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="additional-info.html"><a href="additional-info.html"><i class="fa fa-check"></i><b>13.5</b> Additional Info</a></li>
</ul></li>
<li class="part"><span><b>IV Other Topics</b></span></li>
<li class="chapter" data-level="14" data-path="mda.html"><a href="mda.html"><i class="fa fa-check"></i><b>14</b> Missing Data</a><ul>
<li class="chapter" data-level="14.1" data-path="identifying-missing-data.html"><a href="identifying-missing-data.html"><i class="fa fa-check"></i><b>14.1</b> Identifying missing data</a><ul>
<li class="chapter" data-level="14.1.1" data-path="identifying-missing-data.html"><a href="identifying-missing-data.html#visualize-missing-patterns"><i class="fa fa-check"></i><b>14.1.1</b> Visualize missing patterns</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="effects-of-nonresponse.html"><a href="effects-of-nonresponse.html"><i class="fa fa-check"></i><b>14.2</b> Effects of Nonresponse</a></li>
<li class="chapter" data-level="14.3" data-path="missing-data-mechanisms.html"><a href="missing-data-mechanisms.html"><i class="fa fa-check"></i><b>14.3</b> Missing Data Mechanisms</a><ul>
<li class="chapter" data-level="14.3.1" data-path="missing-data-mechanisms.html"><a href="missing-data-mechanisms.html#demonstration-via-simulation"><i class="fa fa-check"></i><b>14.3.1</b> Demonstration via Simulation</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="general-strategies.html"><a href="general-strategies.html"><i class="fa fa-check"></i><b>14.4</b> General strategies</a><ul>
<li class="chapter" data-level="14.4.1" data-path="general-strategies.html"><a href="general-strategies.html#complete-cases-analysis"><i class="fa fa-check"></i><b>14.4.1</b> Complete cases analysis</a></li>
<li class="chapter" data-level="14.4.2" data-path="general-strategies.html"><a href="general-strategies.html#available-case-analysis"><i class="fa fa-check"></i><b>14.4.2</b> Available-case analysis</a></li>
<li class="chapter" data-level="14.4.3" data-path="general-strategies.html"><a href="general-strategies.html#imputation"><i class="fa fa-check"></i><b>14.4.3</b> Imputation</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="imputation-methods.html"><a href="imputation-methods.html"><i class="fa fa-check"></i><b>14.5</b> Imputation Methods</a></li>
<li class="chapter" data-level="14.6" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html"><i class="fa fa-check"></i><b>14.6</b> Multiple Imputation (MI)</a><ul>
<li class="chapter" data-level="14.6.1" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#goals"><i class="fa fa-check"></i><b>14.6.1</b> Goals</a></li>
<li class="chapter" data-level="14.6.2" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#technique"><i class="fa fa-check"></i><b>14.6.2</b> Technique</a></li>
<li class="chapter" data-level="14.6.3" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#mi-as-a-paradigm"><i class="fa fa-check"></i><b>14.6.3</b> MI as a paradigm</a></li>
<li class="chapter" data-level="14.6.4" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#inference-on-mi"><i class="fa fa-check"></i><b>14.6.4</b> Inference on MI</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html"><i class="fa fa-check"></i><b>14.7</b> Multiple Imputation using Chained Equations (MICE)</a><ul>
<li class="chapter" data-level="14.7.1" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#visualize-imputations"><i class="fa fa-check"></i><b>14.7.1</b> Visualize Imputations</a></li>
<li class="chapter" data-level="14.7.2" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#calculating-bias"><i class="fa fa-check"></i><b>14.7.2</b> Calculating bias</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="final-thoughts.html"><a href="final-thoughts.html"><i class="fa fa-check"></i><b>14.8</b> Final thoughts</a></li>
<li class="chapter" data-level="14.9" data-path="additional-references-2.html"><a href="additional-references-2.html"><i class="fa fa-check"></i><b>14.9</b> Additional References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/norcalbiostat/MATH456_notes" target="blank">View source on Github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mapping-in-r" class="section level2">
<h2><span class="header-section-number">13.2</span> Mapping in R</h2>
<ul>
<li>Use existing packages (easier)</li>
<li>Import your own shape files (harder).
<ul>
<li>A series of lat/long points and an order in which to to draw the lines between points can also be used but will need to be converted to a spatial polygon object at a later point.</li>
</ul></li>
</ul>
<div id="plotting-region-polygons" class="section level3">
<h3><span class="header-section-number">13.2.1</span> Plotting Region polygons</h3>
<p>Use the <code>maps</code> library get county border data. Take note of the variable names, we’ll want to merge other data onto this data frame later.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">counties &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;county&quot;</span>) 
<span class="kw">head</span>(counties)
##        long      lat group order  region subregion
## 1 -86.50517 32.34920     1     1 alabama   autauga
## 2 -86.53382 32.35493     1     2 alabama   autauga
## 3 -86.54527 32.36639     1     3 alabama   autauga
## 4 -86.55673 32.37785     1     4 alabama   autauga
## 5 -86.57966 32.38357     1     5 alabama   autauga
## 6 -86.59111 32.37785     1     6 alabama   autauga</code></pre></div>
<p>We can use <code>ggplot</code> to draw <code>polygons</code> for each region/subregion.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> counties, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), 
                 <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;NA&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">coord_map</span>(<span class="st">&quot;albers&quot;</span>, <span class="dt">lat0 =</span> <span class="dv">39</span>, <span class="dt">lat1 =</span> <span class="dv">45</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="ot">NULL</span>, <span class="dt">y=</span><span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), 
          <span class="dt">axis.ticks=</span><span class="kw">element_blank</span>(), <span class="dt">axis.text =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="spatial_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>

<div class="rmdnote">
Play around with the plotting code to understand what each layer controls.
</div>

<p>Let’s get county level data that we can plot and analyze. The <code>countyComplete</code> data can be obtained by either the <code>OpenIntro</code> package or from Dr. Donatello’s website.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cc &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;C:/GitHub/website/static/data/countyComplete.csv&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)
cc[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,(<span class="kw">ncol</span>(cc)<span class="op">-</span><span class="dv">5</span>)<span class="op">:</span><span class="kw">ncol</span>(cc))]
##             name FIPS pop2010 age_under_5 fed_spending fed_spend00
## 1 Autauga County 1001   54571         6.6       331142    7.582652
## 2 Baldwin County 1003  182265         6.1      1119082    7.969818
## 3 Barbour County 1005   27457         6.2       240308    8.275639
## 4    Bibb County 1007   22915         6.0       163201    7.836406
## 5  Blount County 1009   57322         6.3       294114    5.764229
##   fed_spend10    area density smoking_ban
## 1    6.068095  594.44    91.8        none
## 2    6.139862 1589.78   114.6        none
## 3    8.752158  884.88    31.0     partial
## 4    7.122016  622.58    36.8        none
## 5    5.130910  644.78    88.9        none</code></pre></div>
<p>Looking at a few of the columns we see that this data contains county names, FIPS, county level data such as population, amount of federal spending, population density and what level of smoking ban that is in place. The only information that helps identify each county (other than the name) is FIPS. To add any points to a map, we need lat/long for points and region/subregion name.</p>
<p>The <a href="https://cran.r-project.org/web/packages/housingData/housingData.pdf">housingData package</a> has a <code>geoCounty</code> data set that connects FIPS to the county centroid. A little data cleaning needs to be done first to match the region names with the names found in the <code>counties</code> data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(housingData) 
<span class="kw">head</span>(geoCounty) 
##    fips         county state       lon      lat rMapState rMapCounty
## 1 01001 Autauga County    AL -86.64565 32.54009   alabama    autauga
## 2 01003 Baldwin County    AL -87.72627 30.73831   alabama    baldwin
## 3 01005 Barbour County    AL -85.39733 31.87403   alabama    barbour
## 4 01007    Bibb County    AL -87.12526 32.99902   alabama       bibb
## 5 01009  Blount County    AL -86.56271 33.99044   alabama     blount
## 6 01011 Bullock County    AL -85.71680 32.10634   alabama    bullock

<span class="co"># align names</span>
county.info &lt;-<span class="st"> </span>geoCounty <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">FIPS =</span> <span class="kw">as.numeric</span>(<span class="kw">as.character</span>(fips)), 
                             <span class="dt">long.c =</span> lon, <span class="dt">lat.c=</span>lat, 
                             <span class="dt">region=</span>rMapState, <span class="dt">subregion=</span>rMapCounty) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                     </span><span class="kw">select</span>(FIPS, long.c, lat.c, region, subregion)
<span class="kw">head</span>(county.info)
##   FIPS    long.c    lat.c  region subregion
## 1 1001 -86.64565 32.54009 alabama   autauga
## 2 1003 -87.72627 30.73831 alabama   baldwin
## 3 1005 -85.39733 31.87403 alabama   barbour
## 4 1007 -87.12526 32.99902 alabama      bibb
## 5 1009 -86.56271 33.99044 alabama    blount
## 6 1011 -85.71680 32.10634 alabama   bullock</code></pre></div>
<p>Then we merge lat/long centroids and region names to county complete data frame so that data and all geographic information are all on one data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cc &lt;-<span class="st"> </span>cc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(county.info)
cc[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,(<span class="kw">ncol</span>(cc)<span class="op">-</span><span class="dv">5</span>)<span class="op">:</span><span class="kw">ncol</span>(cc))]
##             name FIPS pop2010 age_under_5 density smoking_ban    long.c
## 1 Autauga County 1001   54571         6.6    91.8        none -86.64565
## 2 Baldwin County 1003  182265         6.1   114.6        none -87.72627
## 3 Barbour County 1005   27457         6.2    31.0     partial -85.39733
## 4    Bibb County 1007   22915         6.0    36.8        none -87.12526
## 5  Blount County 1009   57322         6.3    88.9        none -86.56271
##      lat.c  region subregion
## 1 32.54009 alabama   autauga
## 2 30.73831 alabama   baldwin
## 3 31.87403 alabama   barbour
## 4 32.99902 alabama      bibb
## 5 33.99044 alabama    blount</code></pre></div>
<p>Now we see that lat/long data as well as region/subregion names have been added.</p>
<p>Last we’ll merge all this county level data to the map data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cc.map &lt;-<span class="st"> </span>counties <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(cc)
cc.map[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">6</span>, (<span class="kw">ncol</span>(cc.map)<span class="op">-</span><span class="dv">5</span>)<span class="op">:</span><span class="kw">ncol</span>(cc.map))]
##        long      lat group order subregion fed_spend10   area density
## 1 -86.50517 32.34920     1     1   autauga    6.068095 594.44    91.8
## 2 -86.53382 32.35493     1     2   autauga    6.068095 594.44    91.8
## 3 -86.54527 32.36639     1     3   autauga    6.068095 594.44    91.8
## 4 -86.55673 32.37785     1     4   autauga    6.068095 594.44    91.8
## 5 -86.57966 32.38357     1     5   autauga    6.068095 594.44    91.8
##   smoking_ban    long.c    lat.c
## 1        none -86.64565 32.54009
## 2        none -86.64565 32.54009
## 3        none -86.64565 32.54009
## 4        none -86.64565 32.54009
## 5        none -86.64565 32.54009</code></pre></div>
<p>Notice now that values such as area and density are repeated across rows per <code>subregion</code>, which directly corresponds to the <code>group</code> variable that allowed us to identify counties on the map. Now we can re-plot the county level map, and add a shading layer to this plot that is % poverty.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> cc.map, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group,
        <span class="dt">fill =</span> poverty), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">coord_map</span>(<span class="st">&quot;albers&quot;</span>, <span class="dt">lat0 =</span> <span class="dv">39</span>, <span class="dt">lat1 =</span> <span class="dv">45</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="ot">NULL</span>, <span class="dt">y=</span><span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">axis.ticks=</span><span class="kw">element_blank</span>(), <span class="dt">axis.text =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">low=</span><span class="st">&#39;white&#39;</span>, <span class="dt">high=</span><span class="st">&#39;darkorchid4&#39;</span>)</code></pre></div>
<p><img src="spatial_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>

<div class="rmdcaution">
We couldn’t set <code>group=subregion</code> because county names are not unique. Change this value and replot the map above to see the impact. This demonstrates why having uniquely numbered shapes are critical for plotting.
</div>

</div>
<div id="plotting-points" class="section level3">
<h3><span class="header-section-number">13.2.2</span> Plotting points</h3>
<p>Here is a different approach using a different package: <code>ggmap</code>. We use county centers for selected counties in Northern California instead of polygon regions to demonstrate how to plot points onto a map instead of regions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggmap)
norcal &lt;-<span class="st"> </span>cc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(region<span class="op">==</span><span class="st">&quot;california&quot;</span>, subregion <span class="op">%in%</span><span class="st"> </span>
<span class="st">          </span><span class="kw">c</span>(<span class="st">&#39;butte&#39;</span>, <span class="st">&#39;shasta&#39;</span>, <span class="st">&#39;tehama&#39;</span>, <span class="st">&#39;lassen&#39;</span>, <span class="st">&#39;modoc&#39;</span>, <span class="st">&#39;siskiyou&#39;</span>, <span class="st">&#39;humboldt&#39;</span>, 
            <span class="st">&#39;trinity&#39;</span>, <span class="st">&#39;glenn&#39;</span>, <span class="st">&#39;mendocino&#39;</span>, <span class="st">&#39;sutter&#39;</span>, <span class="st">&#39;sierra&#39;</span>, <span class="st">&#39;nevada&#39;</span>, 
            <span class="st">&#39;del norte&#39;</span>, <span class="st">&#39;lake&#39;</span>, <span class="st">&#39;colusa&#39;</span>)) 
norcal.center &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(norcal<span class="op">$</span>long.c), <span class="kw">mean</span>(norcal<span class="op">$</span>lat.c))
norcal.center
## [1] -122.15392   40.18119</code></pre></div>
<p>The <code>get_map</code> function downloads google map data centered around <code>location</code>. See the <a href="https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/ggmap/ggmapCheatsheet.pdf">ggmap quick start</a> to see all the options you can use.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">norcal.map &lt;-<span class="st"> </span><span class="kw">get_map</span>(<span class="dt">location=</span> norcal.center, <span class="dt">zoom=</span><span class="dv">7</span>, <span class="dt">color=</span><span class="st">&quot;bw&quot;</span>)</code></pre></div>
<p>This approach uses <code>ggmap()</code> instead of <code>ggplot()</code>, but layers (such as points) are still added on in a similar fashion.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggmap</span>(norcal.map) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span>norcal, <span class="kw">aes</span>(<span class="dt">x=</span>long.c, <span class="dt">y=</span>lat.c, 
                              <span class="dt">color=</span>per_capita_income, <span class="dt">size=</span>pop2010)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_color_gradient</span>(<span class="dt">low=</span><span class="st">&quot;darkgreen&quot;</span>, <span class="dt">high=</span><span class="st">&quot;chartreuse&quot;</span>)</code></pre></div>
<p><img src="spatial_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="terminology.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spatial-influence.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
